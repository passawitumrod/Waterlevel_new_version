{"ast":null,"code":"import ArcType from \"../Core/ArcType.js\";\nimport BoundingRectangle from \"../Core/BoundingRectangle.js\";\nimport Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartographic from \"../Core/Cartographic.js\";\nimport ClockRange from \"../Core/ClockRange.js\";\nimport ClockStep from \"../Core/ClockStep.js\";\nimport Color from \"../Core/Color.js\";\nimport CornerType from \"../Core/CornerType.js\";\nimport Credit from \"../Core/Credit.js\";\nimport createGuid from \"../Core/createGuid.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport DistanceDisplayCondition from \"../Core/DistanceDisplayCondition.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\nimport Event from \"../Core/Event.js\";\nimport ExtrapolationType from \"../Core/ExtrapolationType.js\";\nimport getFilenameFromUri from \"../Core/getFilenameFromUri.js\";\nimport HermitePolynomialApproximation from \"../Core/HermitePolynomialApproximation.js\";\nimport Iso8601 from \"../Core/Iso8601.js\";\nimport JulianDate from \"../Core/JulianDate.js\";\nimport LagrangePolynomialApproximation from \"../Core/LagrangePolynomialApproximation.js\";\nimport LinearApproximation from \"../Core/LinearApproximation.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport NearFarScalar from \"../Core/NearFarScalar.js\";\nimport PolygonHierarchy from \"../Core/PolygonHierarchy.js\";\nimport Quaternion from \"../Core/Quaternion.js\";\nimport Rectangle from \"../Core/Rectangle.js\";\nimport ReferenceFrame from \"../Core/ReferenceFrame.js\";\nimport Resource from \"../Core/Resource.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport Spherical from \"../Core/Spherical.js\";\nimport TimeInterval from \"../Core/TimeInterval.js\";\nimport TimeIntervalCollection from \"../Core/TimeIntervalCollection.js\";\nimport ClassificationType from \"../Scene/ClassificationType.js\";\nimport ColorBlendMode from \"../Scene/ColorBlendMode.js\";\nimport HeightReference from \"../Scene/HeightReference.js\";\nimport HorizontalOrigin from \"../Scene/HorizontalOrigin.js\";\nimport LabelStyle from \"../Scene/LabelStyle.js\";\nimport ShadowMode from \"../Scene/ShadowMode.js\";\nimport VerticalOrigin from \"../Scene/VerticalOrigin.js\";\nimport Uri from \"../ThirdParty/Uri.js\";\nimport when from \"../ThirdParty/when.js\";\nimport BillboardGraphics from \"./BillboardGraphics.js\";\nimport BoxGraphics from \"./BoxGraphics.js\";\nimport CallbackProperty from \"./CallbackProperty.js\";\nimport CheckerboardMaterialProperty from \"./CheckerboardMaterialProperty.js\";\nimport ColorMaterialProperty from \"./ColorMaterialProperty.js\";\nimport CompositeMaterialProperty from \"./CompositeMaterialProperty.js\";\nimport CompositePositionProperty from \"./CompositePositionProperty.js\";\nimport CompositeProperty from \"./CompositeProperty.js\";\nimport ConstantPositionProperty from \"./ConstantPositionProperty.js\";\nimport ConstantProperty from \"./ConstantProperty.js\";\nimport CorridorGraphics from \"./CorridorGraphics.js\";\nimport CylinderGraphics from \"./CylinderGraphics.js\";\nimport DataSource from \"./DataSource.js\";\nimport DataSourceClock from \"./DataSourceClock.js\";\nimport EllipseGraphics from \"./EllipseGraphics.js\";\nimport EllipsoidGraphics from \"./EllipsoidGraphics.js\";\nimport EntityCluster from \"./EntityCluster.js\";\nimport EntityCollection from \"./EntityCollection.js\";\nimport GridMaterialProperty from \"./GridMaterialProperty.js\";\nimport ImageMaterialProperty from \"./ImageMaterialProperty.js\";\nimport LabelGraphics from \"./LabelGraphics.js\";\nimport ModelGraphics from \"./ModelGraphics.js\";\nimport NodeTransformationProperty from \"./NodeTransformationProperty.js\";\nimport PathGraphics from \"./PathGraphics.js\";\nimport PointGraphics from \"./PointGraphics.js\";\nimport PolygonGraphics from \"./PolygonGraphics.js\";\nimport PolylineArrowMaterialProperty from \"./PolylineArrowMaterialProperty.js\";\nimport PolylineDashMaterialProperty from \"./PolylineDashMaterialProperty.js\";\nimport PolylineGlowMaterialProperty from \"./PolylineGlowMaterialProperty.js\";\nimport PolylineGraphics from \"./PolylineGraphics.js\";\nimport PolylineOutlineMaterialProperty from \"./PolylineOutlineMaterialProperty.js\";\nimport PositionPropertyArray from \"./PositionPropertyArray.js\";\nimport Property from \"./Property.js\";\nimport PropertyArray from \"./PropertyArray.js\";\nimport PropertyBag from \"./PropertyBag.js\";\nimport RectangleGraphics from \"./RectangleGraphics.js\";\nimport ReferenceProperty from \"./ReferenceProperty.js\";\nimport Rotation from \"./Rotation.js\";\nimport SampledPositionProperty from \"./SampledPositionProperty.js\";\nimport SampledProperty from \"./SampledProperty.js\";\nimport StripeMaterialProperty from \"./StripeMaterialProperty.js\";\nimport StripeOrientation from \"./StripeOrientation.js\";\nimport TimeIntervalCollectionPositionProperty from \"./TimeIntervalCollectionPositionProperty.js\";\nimport TimeIntervalCollectionProperty from \"./TimeIntervalCollectionProperty.js\";\nimport VelocityOrientationProperty from \"./VelocityOrientationProperty.js\";\nimport VelocityVectorProperty from \"./VelocityVectorProperty.js\";\nimport WallGraphics from \"./WallGraphics.js\";\nimport Cesium3DTilesetGraphics from \"./Cesium3DTilesetGraphics.js\"; // A marker type to distinguish CZML properties where we need to end up with a unit vector.\n// The data is still loaded into Cartesian3 objects but they are normalized.\n\nfunction UnitCartesian3() {}\n\nUnitCartesian3.packedLength = Cartesian3.packedLength;\nUnitCartesian3.unpack = Cartesian3.unpack;\nUnitCartesian3.pack = Cartesian3.pack; // As a side note, for the purposes of CZML, Quaternion always indicates a unit quaternion.\n\nvar currentId;\n\nfunction createReferenceProperty(entityCollection, referenceString) {\n  if (referenceString[0] === \"#\") {\n    referenceString = currentId + referenceString;\n  }\n\n  return ReferenceProperty.fromString(entityCollection, referenceString);\n}\n\nfunction createSpecializedProperty(type, entityCollection, packetData) {\n  if (defined(packetData.reference)) {\n    return createReferenceProperty(entityCollection, packetData.reference);\n  }\n\n  if (defined(packetData.velocityReference)) {\n    var referenceProperty = createReferenceProperty(entityCollection, packetData.velocityReference);\n\n    switch (type) {\n      case Cartesian3:\n      case UnitCartesian3:\n        return new VelocityVectorProperty(referenceProperty, type === UnitCartesian3);\n\n      case Quaternion:\n        return new VelocityOrientationProperty(referenceProperty);\n    }\n  }\n\n  throw new RuntimeError(JSON.stringify(packetData) + \" is not valid CZML.\");\n}\n\nfunction createAdapterProperty(property, adapterFunction) {\n  return new CallbackProperty(function (time, result) {\n    return adapterFunction(property.getValue(time, result));\n  }, property.isConstant);\n}\n\nvar scratchCartesian = new Cartesian3();\nvar scratchSpherical = new Spherical();\nvar scratchCartographic = new Cartographic();\nvar scratchTimeInterval = new TimeInterval();\nvar scratchQuaternion = new Quaternion();\n\nfunction unwrapColorInterval(czmlInterval) {\n  var rgbaf = czmlInterval.rgbaf;\n\n  if (defined(rgbaf)) {\n    return rgbaf;\n  }\n\n  var rgba = czmlInterval.rgba;\n\n  if (!defined(rgba)) {\n    return undefined;\n  }\n\n  var length = rgba.length;\n\n  if (length === Color.packedLength) {\n    return [Color.byteToFloat(rgba[0]), Color.byteToFloat(rgba[1]), Color.byteToFloat(rgba[2]), Color.byteToFloat(rgba[3])];\n  }\n\n  rgbaf = new Array(length);\n\n  for (var i = 0; i < length; i += 5) {\n    rgbaf[i] = rgba[i];\n    rgbaf[i + 1] = Color.byteToFloat(rgba[i + 1]);\n    rgbaf[i + 2] = Color.byteToFloat(rgba[i + 2]);\n    rgbaf[i + 3] = Color.byteToFloat(rgba[i + 3]);\n    rgbaf[i + 4] = Color.byteToFloat(rgba[i + 4]);\n  }\n\n  return rgbaf;\n}\n\nfunction unwrapUriInterval(czmlInterval, sourceUri) {\n  var uri = defaultValue(czmlInterval.uri, czmlInterval);\n\n  if (defined(sourceUri)) {\n    return sourceUri.getDerivedResource({\n      url: uri\n    });\n  }\n\n  return Resource.createIfNeeded(uri);\n}\n\nfunction unwrapRectangleInterval(czmlInterval) {\n  var wsen = czmlInterval.wsen;\n\n  if (defined(wsen)) {\n    return wsen;\n  }\n\n  var wsenDegrees = czmlInterval.wsenDegrees;\n\n  if (!defined(wsenDegrees)) {\n    return undefined;\n  }\n\n  var length = wsenDegrees.length;\n\n  if (length === Rectangle.packedLength) {\n    return [CesiumMath.toRadians(wsenDegrees[0]), CesiumMath.toRadians(wsenDegrees[1]), CesiumMath.toRadians(wsenDegrees[2]), CesiumMath.toRadians(wsenDegrees[3])];\n  }\n\n  wsen = new Array(length);\n\n  for (var i = 0; i < length; i += 5) {\n    wsen[i] = wsenDegrees[i];\n    wsen[i + 1] = CesiumMath.toRadians(wsenDegrees[i + 1]);\n    wsen[i + 2] = CesiumMath.toRadians(wsenDegrees[i + 2]);\n    wsen[i + 3] = CesiumMath.toRadians(wsenDegrees[i + 3]);\n    wsen[i + 4] = CesiumMath.toRadians(wsenDegrees[i + 4]);\n  }\n\n  return wsen;\n}\n\nfunction convertUnitSphericalToCartesian(unitSpherical) {\n  var length = unitSpherical.length;\n  scratchSpherical.magnitude = 1.0;\n\n  if (length === 2) {\n    scratchSpherical.clock = unitSpherical[0];\n    scratchSpherical.cone = unitSpherical[1];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length / 3 * 4);\n\n  for (var i = 0, j = 0; i < length; i += 3, j += 4) {\n    result[j] = unitSpherical[i];\n    scratchSpherical.clock = unitSpherical[i + 1];\n    scratchSpherical.cone = unitSpherical[i + 2];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n    result[j + 1] = scratchCartesian.x;\n    result[j + 2] = scratchCartesian.y;\n    result[j + 3] = scratchCartesian.z;\n  }\n\n  return result;\n}\n\nfunction convertSphericalToCartesian(spherical) {\n  var length = spherical.length;\n\n  if (length === 3) {\n    scratchSpherical.clock = spherical[0];\n    scratchSpherical.cone = spherical[1];\n    scratchSpherical.magnitude = spherical[2];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n\n  for (var i = 0; i < length; i += 4) {\n    result[i] = spherical[i];\n    scratchSpherical.clock = spherical[i + 1];\n    scratchSpherical.cone = spherical[i + 2];\n    scratchSpherical.magnitude = spherical[i + 3];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n\n  return result;\n}\n\nfunction convertCartographicRadiansToCartesian(cartographicRadians) {\n  var length = cartographicRadians.length;\n\n  if (length === 3) {\n    scratchCartographic.longitude = cartographicRadians[0];\n    scratchCartographic.latitude = cartographicRadians[1];\n    scratchCartographic.height = cartographicRadians[2];\n    Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n\n  for (var i = 0; i < length; i += 4) {\n    result[i] = cartographicRadians[i];\n    scratchCartographic.longitude = cartographicRadians[i + 1];\n    scratchCartographic.latitude = cartographicRadians[i + 2];\n    scratchCartographic.height = cartographicRadians[i + 3];\n    Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n\n  return result;\n}\n\nfunction convertCartographicDegreesToCartesian(cartographicDegrees) {\n  var length = cartographicDegrees.length;\n\n  if (length === 3) {\n    scratchCartographic.longitude = CesiumMath.toRadians(cartographicDegrees[0]);\n    scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[1]);\n    scratchCartographic.height = cartographicDegrees[2];\n    Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n\n  for (var i = 0; i < length; i += 4) {\n    result[i] = cartographicDegrees[i];\n    scratchCartographic.longitude = CesiumMath.toRadians(cartographicDegrees[i + 1]);\n    scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[i + 2]);\n    scratchCartographic.height = cartographicDegrees[i + 3];\n    Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n\n  return result;\n}\n\nfunction unwrapCartesianInterval(czmlInterval) {\n  var cartesian = czmlInterval.cartesian;\n\n  if (defined(cartesian)) {\n    return cartesian;\n  }\n\n  var cartesianVelocity = czmlInterval.cartesianVelocity;\n\n  if (defined(cartesianVelocity)) {\n    return cartesianVelocity;\n  }\n\n  var unitCartesian = czmlInterval.unitCartesian;\n\n  if (defined(unitCartesian)) {\n    return unitCartesian;\n  }\n\n  var unitSpherical = czmlInterval.unitSpherical;\n\n  if (defined(unitSpherical)) {\n    return convertUnitSphericalToCartesian(unitSpherical);\n  }\n\n  var spherical = czmlInterval.spherical;\n\n  if (defined(spherical)) {\n    return convertSphericalToCartesian(spherical);\n  }\n\n  var cartographicRadians = czmlInterval.cartographicRadians;\n\n  if (defined(cartographicRadians)) {\n    return convertCartographicRadiansToCartesian(cartographicRadians);\n  }\n\n  var cartographicDegrees = czmlInterval.cartographicDegrees;\n\n  if (defined(cartographicDegrees)) {\n    return convertCartographicDegreesToCartesian(cartographicDegrees);\n  }\n\n  throw new RuntimeError(JSON.stringify(czmlInterval) + \" is not a valid CZML interval.\");\n}\n\nfunction normalizePackedCartesianArray(array, startingIndex) {\n  Cartesian3.unpack(array, startingIndex, scratchCartesian);\n  Cartesian3.normalize(scratchCartesian, scratchCartesian);\n  Cartesian3.pack(scratchCartesian, array, startingIndex);\n}\n\nfunction unwrapUnitCartesianInterval(czmlInterval) {\n  var cartesian = unwrapCartesianInterval(czmlInterval);\n\n  if (cartesian.length === 3) {\n    normalizePackedCartesianArray(cartesian, 0);\n    return cartesian;\n  }\n\n  for (var i = 1; i < cartesian.length; i += 4) {\n    normalizePackedCartesianArray(cartesian, i);\n  }\n\n  return cartesian;\n}\n\nfunction normalizePackedQuaternionArray(array, startingIndex) {\n  Quaternion.unpack(array, startingIndex, scratchQuaternion);\n  Quaternion.normalize(scratchQuaternion, scratchQuaternion);\n  Quaternion.pack(scratchQuaternion, array, startingIndex);\n}\n\nfunction unwrapQuaternionInterval(czmlInterval) {\n  var unitQuaternion = czmlInterval.unitQuaternion;\n\n  if (defined(unitQuaternion)) {\n    if (unitQuaternion.length === 4) {\n      normalizePackedQuaternionArray(unitQuaternion, 0);\n      return unitQuaternion;\n    }\n\n    for (var i = 1; i < unitQuaternion.length; i += 5) {\n      normalizePackedQuaternionArray(unitQuaternion, i);\n    }\n  }\n\n  return unitQuaternion;\n}\n\nfunction getPropertyType(czmlInterval) {\n  // The associations in this function need to be kept in sync with the\n  // associations in unwrapInterval.\n  // Intentionally omitted due to conficts in CZML property names:\n  // * Image (conflicts with Uri)\n  // * Rotation (conflicts with Number)\n  //\n  // cartesianVelocity is also omitted due to incomplete support for\n  // derivative information in CZML properties.\n  // (Currently cartesianVelocity is hacked directly into the position processing code)\n  if (typeof czmlInterval === \"boolean\") {\n    return Boolean;\n  } else if (typeof czmlInterval === \"number\") {\n    return Number;\n  } else if (typeof czmlInterval === \"string\") {\n    return String;\n  } else if (czmlInterval.hasOwnProperty(\"array\")) {\n    return Array;\n  } else if (czmlInterval.hasOwnProperty(\"boolean\")) {\n    return Boolean;\n  } else if (czmlInterval.hasOwnProperty(\"boundingRectangle\")) {\n    return BoundingRectangle;\n  } else if (czmlInterval.hasOwnProperty(\"cartesian2\")) {\n    return Cartesian2;\n  } else if (czmlInterval.hasOwnProperty(\"cartesian\") || czmlInterval.hasOwnProperty(\"spherical\") || czmlInterval.hasOwnProperty(\"cartographicRadians\") || czmlInterval.hasOwnProperty(\"cartographicDegrees\")) {\n    return Cartesian3;\n  } else if (czmlInterval.hasOwnProperty(\"unitCartesian\") || czmlInterval.hasOwnProperty(\"unitSpherical\")) {\n    return UnitCartesian3;\n  } else if (czmlInterval.hasOwnProperty(\"rgba\") || czmlInterval.hasOwnProperty(\"rgbaf\")) {\n    return Color;\n  } else if (czmlInterval.hasOwnProperty(\"arcType\")) {\n    return ArcType;\n  } else if (czmlInterval.hasOwnProperty(\"classificationType\")) {\n    return ClassificationType;\n  } else if (czmlInterval.hasOwnProperty(\"colorBlendMode\")) {\n    return ColorBlendMode;\n  } else if (czmlInterval.hasOwnProperty(\"cornerType\")) {\n    return CornerType;\n  } else if (czmlInterval.hasOwnProperty(\"heightReference\")) {\n    return HeightReference;\n  } else if (czmlInterval.hasOwnProperty(\"horizontalOrigin\")) {\n    return HorizontalOrigin;\n  } else if (czmlInterval.hasOwnProperty(\"date\")) {\n    return JulianDate;\n  } else if (czmlInterval.hasOwnProperty(\"labelStyle\")) {\n    return LabelStyle;\n  } else if (czmlInterval.hasOwnProperty(\"number\")) {\n    return Number;\n  } else if (czmlInterval.hasOwnProperty(\"nearFarScalar\")) {\n    return NearFarScalar;\n  } else if (czmlInterval.hasOwnProperty(\"distanceDisplayCondition\")) {\n    return DistanceDisplayCondition;\n  } else if (czmlInterval.hasOwnProperty(\"object\") || czmlInterval.hasOwnProperty(\"value\")) {\n    return Object;\n  } else if (czmlInterval.hasOwnProperty(\"unitQuaternion\")) {\n    return Quaternion;\n  } else if (czmlInterval.hasOwnProperty(\"shadowMode\")) {\n    return ShadowMode;\n  } else if (czmlInterval.hasOwnProperty(\"string\")) {\n    return String;\n  } else if (czmlInterval.hasOwnProperty(\"stripeOrientation\")) {\n    return StripeOrientation;\n  } else if (czmlInterval.hasOwnProperty(\"wsen\") || czmlInterval.hasOwnProperty(\"wsenDegrees\")) {\n    return Rectangle;\n  } else if (czmlInterval.hasOwnProperty(\"uri\")) {\n    return Uri;\n  } else if (czmlInterval.hasOwnProperty(\"verticalOrigin\")) {\n    return VerticalOrigin;\n  } // fallback case\n\n\n  return Object;\n}\n\nfunction unwrapInterval(type, czmlInterval, sourceUri) {\n  // The associations in this function need to be kept in sync with the\n  // associations in getPropertyType\n  switch (type) {\n    case ArcType:\n      return ArcType[defaultValue(czmlInterval.arcType, czmlInterval)];\n\n    case Array:\n      return czmlInterval.array;\n\n    case Boolean:\n      return defaultValue(czmlInterval[\"boolean\"], czmlInterval);\n\n    case BoundingRectangle:\n      return czmlInterval.boundingRectangle;\n\n    case Cartesian2:\n      return czmlInterval.cartesian2;\n\n    case Cartesian3:\n      return unwrapCartesianInterval(czmlInterval);\n\n    case UnitCartesian3:\n      return unwrapUnitCartesianInterval(czmlInterval);\n\n    case Color:\n      return unwrapColorInterval(czmlInterval);\n\n    case ClassificationType:\n      return ClassificationType[defaultValue(czmlInterval.classificationType, czmlInterval)];\n\n    case ColorBlendMode:\n      return ColorBlendMode[defaultValue(czmlInterval.colorBlendMode, czmlInterval)];\n\n    case CornerType:\n      return CornerType[defaultValue(czmlInterval.cornerType, czmlInterval)];\n\n    case HeightReference:\n      return HeightReference[defaultValue(czmlInterval.heightReference, czmlInterval)];\n\n    case HorizontalOrigin:\n      return HorizontalOrigin[defaultValue(czmlInterval.horizontalOrigin, czmlInterval)];\n\n    case Image:\n      return unwrapUriInterval(czmlInterval, sourceUri);\n\n    case JulianDate:\n      return JulianDate.fromIso8601(defaultValue(czmlInterval.date, czmlInterval));\n\n    case LabelStyle:\n      return LabelStyle[defaultValue(czmlInterval.labelStyle, czmlInterval)];\n\n    case Number:\n      return defaultValue(czmlInterval.number, czmlInterval);\n\n    case NearFarScalar:\n      return czmlInterval.nearFarScalar;\n\n    case DistanceDisplayCondition:\n      return czmlInterval.distanceDisplayCondition;\n\n    case Object:\n      return defaultValue(defaultValue(czmlInterval.object, czmlInterval.value), czmlInterval);\n\n    case Quaternion:\n      return unwrapQuaternionInterval(czmlInterval);\n\n    case Rotation:\n      return defaultValue(czmlInterval.number, czmlInterval);\n\n    case ShadowMode:\n      return ShadowMode[defaultValue(defaultValue(czmlInterval.shadowMode, czmlInterval.shadows), czmlInterval)];\n\n    case String:\n      return defaultValue(czmlInterval.string, czmlInterval);\n\n    case StripeOrientation:\n      return StripeOrientation[defaultValue(czmlInterval.stripeOrientation, czmlInterval)];\n\n    case Rectangle:\n      return unwrapRectangleInterval(czmlInterval);\n\n    case Uri:\n      return unwrapUriInterval(czmlInterval, sourceUri);\n\n    case VerticalOrigin:\n      return VerticalOrigin[defaultValue(czmlInterval.verticalOrigin, czmlInterval)];\n\n    default:\n      throw new RuntimeError(type);\n  }\n}\n\nvar interpolators = {\n  HERMITE: HermitePolynomialApproximation,\n  LAGRANGE: LagrangePolynomialApproximation,\n  LINEAR: LinearApproximation\n};\n\nfunction updateInterpolationSettings(packetData, property) {\n  var interpolationAlgorithm = packetData.interpolationAlgorithm;\n  var interpolationDegree = packetData.interpolationDegree;\n\n  if (defined(interpolationAlgorithm) || defined(interpolationDegree)) {\n    property.setInterpolationOptions({\n      interpolationAlgorithm: interpolators[interpolationAlgorithm],\n      interpolationDegree: interpolationDegree\n    });\n  }\n\n  var forwardExtrapolationType = packetData.forwardExtrapolationType;\n\n  if (defined(forwardExtrapolationType)) {\n    property.forwardExtrapolationType = ExtrapolationType[forwardExtrapolationType];\n  }\n\n  var forwardExtrapolationDuration = packetData.forwardExtrapolationDuration;\n\n  if (defined(forwardExtrapolationDuration)) {\n    property.forwardExtrapolationDuration = forwardExtrapolationDuration;\n  }\n\n  var backwardExtrapolationType = packetData.backwardExtrapolationType;\n\n  if (defined(backwardExtrapolationType)) {\n    property.backwardExtrapolationType = ExtrapolationType[backwardExtrapolationType];\n  }\n\n  var backwardExtrapolationDuration = packetData.backwardExtrapolationDuration;\n\n  if (defined(backwardExtrapolationDuration)) {\n    property.backwardExtrapolationDuration = backwardExtrapolationDuration;\n  }\n}\n\nvar iso8601Scratch = {\n  iso8601: undefined\n};\n\nfunction intervalFromString(intervalString) {\n  if (!defined(intervalString)) {\n    return undefined;\n  }\n\n  iso8601Scratch.iso8601 = intervalString;\n  return TimeInterval.fromIso8601(iso8601Scratch);\n}\n\nfunction wrapPropertyInInfiniteInterval(property) {\n  var interval = Iso8601.MAXIMUM_INTERVAL.clone();\n  interval.data = property;\n  return interval;\n}\n\nfunction convertPropertyToComposite(property) {\n  // Create the composite and add the old property, wrapped in an infinite interval.\n  var composite = new CompositeProperty();\n  composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n  return composite;\n}\n\nfunction convertPositionPropertyToComposite(property) {\n  // Create the composite and add the old property, wrapped in an infinite interval.\n  var composite = new CompositePositionProperty(property.referenceFrame);\n  composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n  return composite;\n}\n\nfunction processProperty(type, object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n  var combinedInterval = intervalFromString(packetData.interval);\n\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var packedLength;\n  var unwrappedInterval;\n  var unwrappedIntervalLength; // CZML properties can be defined in many ways.  Most ways represent a structure for\n  // encoding a single value (number, string, cartesian, etc.)  Regardless of the value type,\n  // if it encodes a single value it will get loaded into a ConstantProperty eventually.\n  // Alternatively, there are ways of defining a property that require specialized\n  // client-side representation. Currently, these are ReferenceProperty,\n  // and client-side velocity computation properties such as VelocityVectorProperty.\n\n  var isValue = !defined(packetData.reference) && !defined(packetData.velocityReference);\n  var hasInterval = defined(combinedInterval) && !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n  if (packetData.delete === true) {\n    // If deleting this property for all time, we can simply set to undefined and return.\n    if (!hasInterval) {\n      object[propertyName] = undefined;\n      return;\n    } // Deleting depends on the type of property we have.\n\n\n    return removePropertyData(object[propertyName], combinedInterval);\n  }\n\n  var isSampled = false;\n\n  if (isValue) {\n    unwrappedInterval = unwrapInterval(type, packetData, sourceUri);\n\n    if (!defined(unwrappedInterval)) {\n      // not a known value type, bail\n      return;\n    }\n\n    packedLength = defaultValue(type.packedLength, 1);\n    unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n    isSampled = !defined(packetData.array) && typeof unwrappedInterval !== \"string\" && unwrappedIntervalLength > packedLength && type !== Object;\n  } // Rotation is a special case because it represents a native type (Number)\n  // and therefore does not need to be unpacked when loaded as a constant value.\n\n\n  var needsUnpacking = typeof type.unpack === \"function\" && type !== Rotation; // Any time a constant value is assigned, it completely blows away anything else.\n\n  if (!isSampled && !hasInterval) {\n    if (isValue) {\n      object[propertyName] = new ConstantProperty(needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval);\n    } else {\n      object[propertyName] = createSpecializedProperty(type, entityCollection, packetData);\n    }\n\n    return;\n  }\n\n  var property = object[propertyName];\n  var epoch;\n  var packetEpoch = packetData.epoch;\n\n  if (defined(packetEpoch)) {\n    epoch = JulianDate.fromIso8601(packetEpoch);\n  } // Without an interval, any sampled value is infinite, meaning it completely\n  // replaces any non-sampled property that may exist.\n\n\n  if (isSampled && !hasInterval) {\n    if (!(property instanceof SampledProperty)) {\n      object[propertyName] = property = new SampledProperty(type);\n    }\n\n    property.addSamplesPackedArray(unwrappedInterval, epoch);\n    updateInterpolationSettings(packetData, property);\n    return;\n  }\n\n  var interval; // A constant value with an interval is normally part of a TimeIntervalCollection,\n  // However, if the current property is not a time-interval collection, we need\n  // to turn it into a Composite, preserving the old data with the new interval.\n\n  if (!isSampled && hasInterval) {\n    // Create a new interval for the constant value.\n    combinedInterval = combinedInterval.clone();\n\n    if (isValue) {\n      combinedInterval.data = needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval;\n    } else {\n      combinedInterval.data = createSpecializedProperty(type, entityCollection, packetData);\n    } // If no property exists, simply use a new interval collection\n\n\n    if (!defined(property)) {\n      object[propertyName] = property = isValue ? new TimeIntervalCollectionProperty() : new CompositeProperty();\n    }\n\n    if (isValue && property instanceof TimeIntervalCollectionProperty) {\n      // If we created a collection, or it already was one, use it.\n      property.intervals.addInterval(combinedInterval);\n    } else if (property instanceof CompositeProperty) {\n      // If the collection was already a CompositeProperty, use it.\n      if (isValue) {\n        combinedInterval.data = new ConstantProperty(combinedInterval.data);\n      }\n\n      property.intervals.addInterval(combinedInterval);\n    } else {\n      // Otherwise, create a CompositeProperty but preserve the existing data.\n      object[propertyName] = property = convertPropertyToComposite(property); // Change the new data to a ConstantProperty and add it.\n\n      if (isValue) {\n        combinedInterval.data = new ConstantProperty(combinedInterval.data);\n      }\n\n      property.intervals.addInterval(combinedInterval);\n    }\n\n    return;\n  } // isSampled && hasInterval\n\n\n  if (!defined(property)) {\n    object[propertyName] = property = new CompositeProperty();\n  } // Create a CompositeProperty but preserve the existing data.\n\n\n  if (!(property instanceof CompositeProperty)) {\n    object[propertyName] = property = convertPropertyToComposite(property);\n  } // Check if the interval already exists in the composite.\n\n\n  var intervals = property.intervals;\n  interval = intervals.findInterval(combinedInterval);\n\n  if (!defined(interval) || !(interval.data instanceof SampledProperty)) {\n    // If not, create a SampledProperty for it.\n    interval = combinedInterval.clone();\n    interval.data = new SampledProperty(type);\n    intervals.addInterval(interval);\n  }\n\n  interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n  updateInterpolationSettings(packetData, interval.data);\n}\n\nfunction removePropertyData(property, interval) {\n  if (property instanceof SampledProperty) {\n    property.removeSamples(interval);\n    return;\n  } else if (property instanceof TimeIntervalCollectionProperty) {\n    property.intervals.removeInterval(interval);\n    return;\n  } else if (property instanceof CompositeProperty) {\n    var intervals = property.intervals;\n\n    for (var i = 0; i < intervals.length; ++i) {\n      var intersection = TimeInterval.intersect(intervals.get(i), interval, scratchTimeInterval);\n\n      if (!intersection.isEmpty) {\n        // remove data from the contained properties\n        removePropertyData(intersection.data, interval);\n      }\n    } // remove the intervals from the composite\n\n\n    intervals.removeInterval(interval);\n    return;\n  }\n}\n\nfunction processPacketData(type, object, propertyName, packetData, interval, sourceUri, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processProperty(type, object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n    }\n  } else {\n    processProperty(type, object, propertyName, packetData, interval, sourceUri, entityCollection);\n  }\n}\n\nfunction processPositionProperty(object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n  var combinedInterval = intervalFromString(packetData.interval);\n\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var numberOfDerivatives = defined(packetData.cartesianVelocity) ? 1 : 0;\n  var packedLength = Cartesian3.packedLength * (numberOfDerivatives + 1);\n  var unwrappedInterval;\n  var unwrappedIntervalLength;\n  var isValue = !defined(packetData.reference);\n  var hasInterval = defined(combinedInterval) && !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n  if (packetData.delete === true) {\n    // If deleting this property for all time, we can simply set to undefined and return.\n    if (!hasInterval) {\n      object[propertyName] = undefined;\n      return;\n    } // Deleting depends on the type of property we have.\n\n\n    return removePositionPropertyData(object[propertyName], combinedInterval);\n  }\n\n  var referenceFrame;\n  var isSampled = false;\n\n  if (isValue) {\n    if (defined(packetData.referenceFrame)) {\n      referenceFrame = ReferenceFrame[packetData.referenceFrame];\n    }\n\n    referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n    unwrappedInterval = unwrapCartesianInterval(packetData);\n    unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n    isSampled = unwrappedIntervalLength > packedLength;\n  } // Any time a constant value is assigned, it completely blows away anything else.\n\n\n  if (!isSampled && !hasInterval) {\n    if (isValue) {\n      object[propertyName] = new ConstantPositionProperty(Cartesian3.unpack(unwrappedInterval), referenceFrame);\n    } else {\n      object[propertyName] = createReferenceProperty(entityCollection, packetData.reference);\n    }\n\n    return;\n  }\n\n  var property = object[propertyName];\n  var epoch;\n  var packetEpoch = packetData.epoch;\n\n  if (defined(packetEpoch)) {\n    epoch = JulianDate.fromIso8601(packetEpoch);\n  } // Without an interval, any sampled value is infinite, meaning it completely\n  // replaces any non-sampled property that may exist.\n\n\n  if (isSampled && !hasInterval) {\n    if (!(property instanceof SampledPositionProperty) || defined(referenceFrame) && property.referenceFrame !== referenceFrame) {\n      object[propertyName] = property = new SampledPositionProperty(referenceFrame, numberOfDerivatives);\n    }\n\n    property.addSamplesPackedArray(unwrappedInterval, epoch);\n    updateInterpolationSettings(packetData, property);\n    return;\n  }\n\n  var interval; // A constant value with an interval is normally part of a TimeIntervalCollection,\n  // However, if the current property is not a time-interval collection, we need\n  // to turn it into a Composite, preserving the old data with the new interval.\n\n  if (!isSampled && hasInterval) {\n    // Create a new interval for the constant value.\n    combinedInterval = combinedInterval.clone();\n\n    if (isValue) {\n      combinedInterval.data = Cartesian3.unpack(unwrappedInterval);\n    } else {\n      combinedInterval.data = createReferenceProperty(entityCollection, packetData.reference);\n    } // If no property exists, simply use a new interval collection\n\n\n    if (!defined(property)) {\n      if (isValue) {\n        property = new TimeIntervalCollectionPositionProperty(referenceFrame);\n      } else {\n        property = new CompositePositionProperty(referenceFrame);\n      }\n\n      object[propertyName] = property;\n    }\n\n    if (isValue && property instanceof TimeIntervalCollectionPositionProperty && defined(referenceFrame) && property.referenceFrame === referenceFrame) {\n      // If we create a collection, or it already existed, use it.\n      property.intervals.addInterval(combinedInterval);\n    } else if (property instanceof CompositePositionProperty) {\n      // If the collection was already a CompositePositionProperty, use it.\n      if (isValue) {\n        combinedInterval.data = new ConstantPositionProperty(combinedInterval.data, referenceFrame);\n      }\n\n      property.intervals.addInterval(combinedInterval);\n    } else {\n      // Otherwise, create a CompositePositionProperty but preserve the existing data.\n      object[propertyName] = property = convertPositionPropertyToComposite(property); // Change the new data to a ConstantPositionProperty and add it.\n\n      if (isValue) {\n        combinedInterval.data = new ConstantPositionProperty(combinedInterval.data, referenceFrame);\n      }\n\n      property.intervals.addInterval(combinedInterval);\n    }\n\n    return;\n  } // isSampled && hasInterval\n\n\n  if (!defined(property)) {\n    object[propertyName] = property = new CompositePositionProperty(referenceFrame);\n  } else if (!(property instanceof CompositePositionProperty)) {\n    // Create a CompositeProperty but preserve the existing data.\n    object[propertyName] = property = convertPositionPropertyToComposite(property);\n  } // Check if the interval already exists in the composite.\n\n\n  var intervals = property.intervals;\n  interval = intervals.findInterval(combinedInterval);\n\n  if (!defined(interval) || !(interval.data instanceof SampledPositionProperty) || defined(referenceFrame) && interval.data.referenceFrame !== referenceFrame) {\n    // If not, create a SampledPositionProperty for it.\n    interval = combinedInterval.clone();\n    interval.data = new SampledPositionProperty(referenceFrame, numberOfDerivatives);\n    intervals.addInterval(interval);\n  }\n\n  interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n  updateInterpolationSettings(packetData, interval.data);\n}\n\nfunction removePositionPropertyData(property, interval) {\n  if (property instanceof SampledPositionProperty) {\n    property.removeSamples(interval);\n    return;\n  } else if (property instanceof TimeIntervalCollectionPositionProperty) {\n    property.intervals.removeInterval(interval);\n    return;\n  } else if (property instanceof CompositePositionProperty) {\n    var intervals = property.intervals;\n\n    for (var i = 0; i < intervals.length; ++i) {\n      var intersection = TimeInterval.intersect(intervals.get(i), interval, scratchTimeInterval);\n\n      if (!intersection.isEmpty) {\n        // remove data from the contained properties\n        removePositionPropertyData(intersection.data, interval);\n      }\n    } // remove the intervals from the composite\n\n\n    intervals.removeInterval(interval);\n    return;\n  }\n}\n\nfunction processPositionPacketData(object, propertyName, packetData, interval, sourceUri, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processPositionProperty(object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n    }\n  } else {\n    processPositionProperty(object, propertyName, packetData, interval, sourceUri, entityCollection);\n  }\n}\n\nfunction processMaterialProperty(object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n  var combinedInterval = intervalFromString(packetData.interval);\n\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var property = object[propertyName];\n  var existingMaterial;\n  var existingInterval;\n\n  if (defined(combinedInterval)) {\n    if (!(property instanceof CompositeMaterialProperty)) {\n      property = new CompositeMaterialProperty();\n      object[propertyName] = property;\n    } //See if we already have data at that interval.\n\n\n    var thisIntervals = property.intervals;\n    existingInterval = thisIntervals.findInterval({\n      start: combinedInterval.start,\n      stop: combinedInterval.stop\n    });\n\n    if (defined(existingInterval)) {\n      //We have an interval, but we need to make sure the\n      //new data is the same type of material as the old data.\n      existingMaterial = existingInterval.data;\n    } else {\n      //If not, create it.\n      existingInterval = combinedInterval.clone();\n      thisIntervals.addInterval(existingInterval);\n    }\n  } else {\n    existingMaterial = property;\n  }\n\n  var materialData;\n\n  if (defined(packetData.solidColor)) {\n    if (!(existingMaterial instanceof ColorMaterialProperty)) {\n      existingMaterial = new ColorMaterialProperty();\n    }\n\n    materialData = packetData.solidColor;\n    processPacketData(Color, existingMaterial, \"color\", materialData.color, undefined, undefined, entityCollection);\n  } else if (defined(packetData.grid)) {\n    if (!(existingMaterial instanceof GridMaterialProperty)) {\n      existingMaterial = new GridMaterialProperty();\n    }\n\n    materialData = packetData.grid;\n    processPacketData(Color, existingMaterial, \"color\", materialData.color, undefined, sourceUri, entityCollection);\n    processPacketData(Number, existingMaterial, \"cellAlpha\", materialData.cellAlpha, undefined, sourceUri, entityCollection);\n    processPacketData(Cartesian2, existingMaterial, \"lineCount\", materialData.lineCount, undefined, sourceUri, entityCollection);\n    processPacketData(Cartesian2, existingMaterial, \"lineThickness\", materialData.lineThickness, undefined, sourceUri, entityCollection);\n    processPacketData(Cartesian2, existingMaterial, \"lineOffset\", materialData.lineOffset, undefined, sourceUri, entityCollection);\n  } else if (defined(packetData.image)) {\n    if (!(existingMaterial instanceof ImageMaterialProperty)) {\n      existingMaterial = new ImageMaterialProperty();\n    }\n\n    materialData = packetData.image;\n    processPacketData(Image, existingMaterial, \"image\", materialData.image, undefined, sourceUri, entityCollection);\n    processPacketData(Cartesian2, existingMaterial, \"repeat\", materialData.repeat, undefined, sourceUri, entityCollection);\n    processPacketData(Color, existingMaterial, \"color\", materialData.color, undefined, sourceUri, entityCollection);\n    processPacketData(Boolean, existingMaterial, \"transparent\", materialData.transparent, undefined, sourceUri, entityCollection);\n  } else if (defined(packetData.stripe)) {\n    if (!(existingMaterial instanceof StripeMaterialProperty)) {\n      existingMaterial = new StripeMaterialProperty();\n    }\n\n    materialData = packetData.stripe;\n    processPacketData(StripeOrientation, existingMaterial, \"orientation\", materialData.orientation, undefined, sourceUri, entityCollection);\n    processPacketData(Color, existingMaterial, \"evenColor\", materialData.evenColor, undefined, sourceUri, entityCollection);\n    processPacketData(Color, existingMaterial, \"oddColor\", materialData.oddColor, undefined, sourceUri, entityCollection);\n    processPacketData(Number, existingMaterial, \"offset\", materialData.offset, undefined, sourceUri, entityCollection);\n    processPacketData(Number, existingMaterial, \"repeat\", materialData.repeat, undefined, sourceUri, entityCollection);\n  } else if (defined(packetData.polylineOutline)) {\n    if (!(existingMaterial instanceof PolylineOutlineMaterialProperty)) {\n      existingMaterial = new PolylineOutlineMaterialProperty();\n    }\n\n    materialData = packetData.polylineOutline;\n    processPacketData(Color, existingMaterial, \"color\", materialData.color, undefined, sourceUri, entityCollection);\n    processPacketData(Color, existingMaterial, \"outlineColor\", materialData.outlineColor, undefined, sourceUri, entityCollection);\n    processPacketData(Number, existingMaterial, \"outlineWidth\", materialData.outlineWidth, undefined, sourceUri, entityCollection);\n  } else if (defined(packetData.polylineGlow)) {\n    if (!(existingMaterial instanceof PolylineGlowMaterialProperty)) {\n      existingMaterial = new PolylineGlowMaterialProperty();\n    }\n\n    materialData = packetData.polylineGlow;\n    processPacketData(Color, existingMaterial, \"color\", materialData.color, undefined, sourceUri, entityCollection);\n    processPacketData(Number, existingMaterial, \"glowPower\", materialData.glowPower, undefined, sourceUri, entityCollection);\n    processPacketData(Number, existingMaterial, \"taperPower\", materialData.taperPower, undefined, sourceUri, entityCollection);\n  } else if (defined(packetData.polylineArrow)) {\n    if (!(existingMaterial instanceof PolylineArrowMaterialProperty)) {\n      existingMaterial = new PolylineArrowMaterialProperty();\n    }\n\n    materialData = packetData.polylineArrow;\n    processPacketData(Color, existingMaterial, \"color\", materialData.color, undefined, undefined, entityCollection);\n  } else if (defined(packetData.polylineDash)) {\n    if (!(existingMaterial instanceof PolylineDashMaterialProperty)) {\n      existingMaterial = new PolylineDashMaterialProperty();\n    }\n\n    materialData = packetData.polylineDash;\n    processPacketData(Color, existingMaterial, \"color\", materialData.color, undefined, undefined, entityCollection);\n    processPacketData(Color, existingMaterial, \"gapColor\", materialData.gapColor, undefined, undefined, entityCollection);\n    processPacketData(Number, existingMaterial, \"dashLength\", materialData.dashLength, undefined, sourceUri, entityCollection);\n    processPacketData(Number, existingMaterial, \"dashPattern\", materialData.dashPattern, undefined, sourceUri, entityCollection);\n  } else if (defined(packetData.checkerboard)) {\n    if (!(existingMaterial instanceof CheckerboardMaterialProperty)) {\n      existingMaterial = new CheckerboardMaterialProperty();\n    }\n\n    materialData = packetData.checkerboard;\n    processPacketData(Color, existingMaterial, \"evenColor\", materialData.evenColor, undefined, sourceUri, entityCollection);\n    processPacketData(Color, existingMaterial, \"oddColor\", materialData.oddColor, undefined, sourceUri, entityCollection);\n    processPacketData(Cartesian2, existingMaterial, \"repeat\", materialData.repeat, undefined, sourceUri, entityCollection);\n  }\n\n  if (defined(existingInterval)) {\n    existingInterval.data = existingMaterial;\n  } else {\n    object[propertyName] = existingMaterial;\n  }\n}\n\nfunction processMaterialPacketData(object, propertyName, packetData, interval, sourceUri, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processMaterialProperty(object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n    }\n  } else {\n    processMaterialProperty(object, propertyName, packetData, interval, sourceUri, entityCollection);\n  }\n}\n\nfunction processName(entity, packet, entityCollection, sourceUri) {\n  var nameData = packet.name;\n\n  if (defined(nameData)) {\n    entity.name = packet.name;\n  }\n}\n\nfunction processDescription(entity, packet, entityCollection, sourceUri) {\n  var descriptionData = packet.description;\n\n  if (defined(descriptionData)) {\n    processPacketData(String, entity, \"description\", descriptionData, undefined, sourceUri, entityCollection);\n  }\n}\n\nfunction processPosition(entity, packet, entityCollection, sourceUri) {\n  var positionData = packet.position;\n\n  if (defined(positionData)) {\n    processPositionPacketData(entity, \"position\", positionData, undefined, sourceUri, entityCollection);\n  }\n}\n\nfunction processViewFrom(entity, packet, entityCollection, sourceUri) {\n  var viewFromData = packet.viewFrom;\n\n  if (defined(viewFromData)) {\n    processPacketData(Cartesian3, entity, \"viewFrom\", viewFromData, undefined, sourceUri, entityCollection);\n  }\n}\n\nfunction processOrientation(entity, packet, entityCollection, sourceUri) {\n  var orientationData = packet.orientation;\n\n  if (defined(orientationData)) {\n    processPacketData(Quaternion, entity, \"orientation\", orientationData, undefined, sourceUri, entityCollection);\n  }\n}\n\nfunction processProperties(entity, packet, entityCollection, sourceUri) {\n  var propertiesData = packet.properties;\n\n  if (defined(propertiesData)) {\n    if (!defined(entity.properties)) {\n      entity.properties = new PropertyBag();\n    } // We cannot simply call processPacketData(entity, 'properties', propertyData, undefined, sourceUri, entityCollection)\n    // because each property of \"properties\" may vary separately.\n    // The properties will be accessible as entity.properties.myprop.getValue(time).\n\n\n    for (var key in propertiesData) {\n      if (propertiesData.hasOwnProperty(key)) {\n        if (!entity.properties.hasProperty(key)) {\n          entity.properties.addProperty(key);\n        }\n\n        var propertyData = propertiesData[key];\n\n        if (Array.isArray(propertyData)) {\n          for (var i = 0, len = propertyData.length; i < len; ++i) {\n            processProperty(getPropertyType(propertyData[i]), entity.properties, key, propertyData[i], undefined, sourceUri, entityCollection);\n          }\n        } else {\n          processProperty(getPropertyType(propertyData), entity.properties, key, propertyData, undefined, sourceUri, entityCollection);\n        }\n      }\n    }\n  }\n}\n\nfunction processReferencesArrayPacketData(object, propertyName, references, interval, entityCollection, PropertyArrayType, CompositePropertyArrayType) {\n  var properties = references.map(function (reference) {\n    return createReferenceProperty(entityCollection, reference);\n  });\n\n  if (defined(interval)) {\n    interval = intervalFromString(interval);\n    var property = object[propertyName];\n\n    if (!(property instanceof CompositePropertyArrayType)) {\n      // If the property was not already a CompositeProperty,\n      // create a CompositeProperty but preserve the existing data.\n      // Create the composite and add the old property, wrapped in an infinite interval.\n      var composite = new CompositePropertyArrayType();\n      composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n      object[propertyName] = property = composite;\n    }\n\n    interval.data = new PropertyArrayType(properties);\n    property.intervals.addInterval(interval);\n  } else {\n    object[propertyName] = new PropertyArrayType(properties);\n  }\n}\n\nfunction processArrayPacketData(object, propertyName, packetData, entityCollection) {\n  var references = packetData.references;\n\n  if (defined(references)) {\n    processReferencesArrayPacketData(object, propertyName, references, packetData.interval, entityCollection, PropertyArray, CompositeProperty);\n  } else {\n    processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n  }\n}\n\nfunction processArray(object, propertyName, packetData, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processArrayPacketData(object, propertyName, packetData[i], entityCollection);\n    }\n  } else {\n    processArrayPacketData(object, propertyName, packetData, entityCollection);\n  }\n}\n\nfunction processPositionArrayPacketData(object, propertyName, packetData, entityCollection) {\n  var references = packetData.references;\n\n  if (defined(references)) {\n    processReferencesArrayPacketData(object, propertyName, references, packetData.interval, entityCollection, PositionPropertyArray, CompositePositionProperty);\n  } else {\n    if (defined(packetData.cartesian)) {\n      packetData.array = Cartesian3.unpackArray(packetData.cartesian);\n    } else if (defined(packetData.cartographicRadians)) {\n      packetData.array = Cartesian3.fromRadiansArrayHeights(packetData.cartographicRadians);\n    } else if (defined(packetData.cartographicDegrees)) {\n      packetData.array = Cartesian3.fromDegreesArrayHeights(packetData.cartographicDegrees);\n    }\n\n    if (defined(packetData.array)) {\n      processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n    }\n  }\n}\n\nfunction processPositionArray(object, propertyName, packetData, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processPositionArrayPacketData(object, propertyName, packetData[i], entityCollection);\n    }\n  } else {\n    processPositionArrayPacketData(object, propertyName, packetData, entityCollection);\n  }\n}\n\nfunction unpackCartesianArray(array) {\n  return Cartesian3.unpackArray(array);\n}\n\nfunction unpackCartographicRadiansArray(array) {\n  return Cartesian3.fromRadiansArrayHeights(array);\n}\n\nfunction unpackCartographicDegreesArray(array) {\n  return Cartesian3.fromDegreesArrayHeights(array);\n}\n\nfunction processPositionArrayOfArraysPacketData(object, propertyName, packetData, entityCollection) {\n  var references = packetData.references;\n\n  if (defined(references)) {\n    var properties = references.map(function (referenceArray) {\n      var tempObj = {};\n      processReferencesArrayPacketData(tempObj, \"positions\", referenceArray, packetData.interval, entityCollection, PositionPropertyArray, CompositePositionProperty);\n      return tempObj.positions;\n    });\n    object[propertyName] = new PositionPropertyArray(properties);\n  } else {\n    if (defined(packetData.cartesian)) {\n      packetData.array = packetData.cartesian.map(unpackCartesianArray);\n    } else if (defined(packetData.cartographicRadians)) {\n      packetData.array = packetData.cartographicRadians.map(unpackCartographicRadiansArray);\n    } else if (defined(packetData.cartographicDegrees)) {\n      packetData.array = packetData.cartographicDegrees.map(unpackCartographicDegreesArray);\n    }\n\n    if (defined(packetData.array)) {\n      processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n    }\n  }\n}\n\nfunction processPositionArrayOfArrays(object, propertyName, packetData, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processPositionArrayOfArraysPacketData(object, propertyName, packetData[i], entityCollection);\n    }\n  } else {\n    processPositionArrayOfArraysPacketData(object, propertyName, packetData, entityCollection);\n  }\n}\n\nfunction processAvailability(entity, packet, entityCollection, sourceUri) {\n  var packetData = packet.availability;\n\n  if (!defined(packetData)) {\n    return;\n  }\n\n  var intervals;\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      if (!defined(intervals)) {\n        intervals = new TimeIntervalCollection();\n      }\n\n      intervals.addInterval(intervalFromString(packetData[i]));\n    }\n  } else {\n    intervals = new TimeIntervalCollection();\n    intervals.addInterval(intervalFromString(packetData));\n  }\n\n  entity.availability = intervals;\n}\n\nfunction processAlignedAxis(billboard, packetData, interval, sourceUri, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  processPacketData(UnitCartesian3, billboard, \"alignedAxis\", packetData, interval, sourceUri, entityCollection);\n}\n\nfunction processBillboard(entity, packet, entityCollection, sourceUri) {\n  var billboardData = packet.billboard;\n\n  if (!defined(billboardData)) {\n    return;\n  }\n\n  var interval = intervalFromString(billboardData.interval);\n  var billboard = entity.billboard;\n\n  if (!defined(billboard)) {\n    entity.billboard = billboard = new BillboardGraphics();\n  }\n\n  processPacketData(Boolean, billboard, \"show\", billboardData.show, interval, sourceUri, entityCollection);\n  processPacketData(Image, billboard, \"image\", billboardData.image, interval, sourceUri, entityCollection);\n  processPacketData(Number, billboard, \"scale\", billboardData.scale, interval, sourceUri, entityCollection);\n  processPacketData(Cartesian2, billboard, \"pixelOffset\", billboardData.pixelOffset, interval, sourceUri, entityCollection);\n  processPacketData(Cartesian3, billboard, \"eyeOffset\", billboardData.eyeOffset, interval, sourceUri, entityCollection);\n  processPacketData(HorizontalOrigin, billboard, \"horizontalOrigin\", billboardData.horizontalOrigin, interval, sourceUri, entityCollection);\n  processPacketData(VerticalOrigin, billboard, \"verticalOrigin\", billboardData.verticalOrigin, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, billboard, \"heightReference\", billboardData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Color, billboard, \"color\", billboardData.color, interval, sourceUri, entityCollection);\n  processPacketData(Rotation, billboard, \"rotation\", billboardData.rotation, interval, sourceUri, entityCollection);\n  processAlignedAxis(billboard, billboardData.alignedAxis, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, billboard, \"sizeInMeters\", billboardData.sizeInMeters, interval, sourceUri, entityCollection);\n  processPacketData(Number, billboard, \"width\", billboardData.width, interval, sourceUri, entityCollection);\n  processPacketData(Number, billboard, \"height\", billboardData.height, interval, sourceUri, entityCollection);\n  processPacketData(NearFarScalar, billboard, \"scaleByDistance\", billboardData.scaleByDistance, interval, sourceUri, entityCollection);\n  processPacketData(NearFarScalar, billboard, \"translucencyByDistance\", billboardData.translucencyByDistance, interval, sourceUri, entityCollection);\n  processPacketData(NearFarScalar, billboard, \"pixelOffsetScaleByDistance\", billboardData.pixelOffsetScaleByDistance, interval, sourceUri, entityCollection);\n  processPacketData(BoundingRectangle, billboard, \"imageSubRegion\", billboardData.imageSubRegion, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, billboard, \"distanceDisplayCondition\", billboardData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  processPacketData(Number, billboard, \"disableDepthTestDistance\", billboardData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n}\n\nfunction processBox(entity, packet, entityCollection, sourceUri) {\n  var boxData = packet.box;\n\n  if (!defined(boxData)) {\n    return;\n  }\n\n  var interval = intervalFromString(boxData.interval);\n  var box = entity.box;\n\n  if (!defined(box)) {\n    entity.box = box = new BoxGraphics();\n  }\n\n  processPacketData(Boolean, box, \"show\", boxData.show, interval, sourceUri, entityCollection);\n  processPacketData(Cartesian3, box, \"dimensions\", boxData.dimensions, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, box, \"heightReference\", boxData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, box, \"fill\", boxData.fill, interval, sourceUri, entityCollection);\n  processMaterialPacketData(box, \"material\", boxData.material, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, box, \"outline\", boxData.outline, interval, sourceUri, entityCollection);\n  processPacketData(Color, box, \"outlineColor\", boxData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, box, \"outlineWidth\", boxData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, box, \"shadows\", boxData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, box, \"distanceDisplayCondition\", boxData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n}\n\nfunction processCorridor(entity, packet, entityCollection, sourceUri) {\n  var corridorData = packet.corridor;\n\n  if (!defined(corridorData)) {\n    return;\n  }\n\n  var interval = intervalFromString(corridorData.interval);\n  var corridor = entity.corridor;\n\n  if (!defined(corridor)) {\n    entity.corridor = corridor = new CorridorGraphics();\n  }\n\n  processPacketData(Boolean, corridor, \"show\", corridorData.show, interval, sourceUri, entityCollection);\n  processPositionArray(corridor, \"positions\", corridorData.positions, entityCollection);\n  processPacketData(Number, corridor, \"width\", corridorData.width, interval, sourceUri, entityCollection);\n  processPacketData(Number, corridor, \"height\", corridorData.height, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, corridor, \"heightReference\", corridorData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Number, corridor, \"extrudedHeight\", corridorData.extrudedHeight, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, corridor, \"extrudedHeightReference\", corridorData.extrudedHeightReference, interval, sourceUri, entityCollection);\n  processPacketData(CornerType, corridor, \"cornerType\", corridorData.cornerType, interval, sourceUri, entityCollection);\n  processPacketData(Number, corridor, \"granularity\", corridorData.granularity, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, corridor, \"fill\", corridorData.fill, interval, sourceUri, entityCollection);\n  processMaterialPacketData(corridor, \"material\", corridorData.material, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, corridor, \"outline\", corridorData.outline, interval, sourceUri, entityCollection);\n  processPacketData(Color, corridor, \"outlineColor\", corridorData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, corridor, \"outlineWidth\", corridorData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, corridor, \"shadows\", corridorData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, corridor, \"distanceDisplayCondition\", corridorData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  processPacketData(ClassificationType, corridor, \"classificationType\", corridorData.classificationType, interval, sourceUri, entityCollection);\n  processPacketData(Number, corridor, \"zIndex\", corridorData.zIndex, interval, sourceUri, entityCollection);\n}\n\nfunction processCylinder(entity, packet, entityCollection, sourceUri) {\n  var cylinderData = packet.cylinder;\n\n  if (!defined(cylinderData)) {\n    return;\n  }\n\n  var interval = intervalFromString(cylinderData.interval);\n  var cylinder = entity.cylinder;\n\n  if (!defined(cylinder)) {\n    entity.cylinder = cylinder = new CylinderGraphics();\n  }\n\n  processPacketData(Boolean, cylinder, \"show\", cylinderData.show, interval, sourceUri, entityCollection);\n  processPacketData(Number, cylinder, \"length\", cylinderData.length, interval, sourceUri, entityCollection);\n  processPacketData(Number, cylinder, \"topRadius\", cylinderData.topRadius, interval, sourceUri, entityCollection);\n  processPacketData(Number, cylinder, \"bottomRadius\", cylinderData.bottomRadius, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, cylinder, \"heightReference\", cylinderData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, cylinder, \"fill\", cylinderData.fill, interval, sourceUri, entityCollection);\n  processMaterialPacketData(cylinder, \"material\", cylinderData.material, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, cylinder, \"outline\", cylinderData.outline, interval, sourceUri, entityCollection);\n  processPacketData(Color, cylinder, \"outlineColor\", cylinderData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, cylinder, \"outlineWidth\", cylinderData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(Number, cylinder, \"numberOfVerticalLines\", cylinderData.numberOfVerticalLines, interval, sourceUri, entityCollection);\n  processPacketData(Number, cylinder, \"slices\", cylinderData.slices, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, cylinder, \"shadows\", cylinderData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, cylinder, \"distanceDisplayCondition\", cylinderData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n}\n\nfunction processDocument(packet, dataSource) {\n  var version = packet.version;\n\n  if (defined(version)) {\n    if (typeof version === \"string\") {\n      var tokens = version.split(\".\");\n\n      if (tokens.length === 2) {\n        if (tokens[0] !== \"1\") {\n          throw new RuntimeError(\"Cesium only supports CZML version 1.\");\n        }\n\n        dataSource._version = version;\n      }\n    }\n  }\n\n  if (!defined(dataSource._version)) {\n    throw new RuntimeError(\"CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.\");\n  }\n\n  var documentPacket = dataSource._documentPacket;\n\n  if (defined(packet.name)) {\n    documentPacket.name = packet.name;\n  }\n\n  var clockPacket = packet.clock;\n\n  if (defined(clockPacket)) {\n    var clock = documentPacket.clock;\n\n    if (!defined(clock)) {\n      documentPacket.clock = {\n        interval: clockPacket.interval,\n        currentTime: clockPacket.currentTime,\n        range: clockPacket.range,\n        step: clockPacket.step,\n        multiplier: clockPacket.multiplier\n      };\n    } else {\n      clock.interval = defaultValue(clockPacket.interval, clock.interval);\n      clock.currentTime = defaultValue(clockPacket.currentTime, clock.currentTime);\n      clock.range = defaultValue(clockPacket.range, clock.range);\n      clock.step = defaultValue(clockPacket.step, clock.step);\n      clock.multiplier = defaultValue(clockPacket.multiplier, clock.multiplier);\n    }\n  }\n}\n\nfunction processEllipse(entity, packet, entityCollection, sourceUri) {\n  var ellipseData = packet.ellipse;\n\n  if (!defined(ellipseData)) {\n    return;\n  }\n\n  var interval = intervalFromString(ellipseData.interval);\n  var ellipse = entity.ellipse;\n\n  if (!defined(ellipse)) {\n    entity.ellipse = ellipse = new EllipseGraphics();\n  }\n\n  processPacketData(Boolean, ellipse, \"show\", ellipseData.show, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipse, \"semiMajorAxis\", ellipseData.semiMajorAxis, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipse, \"semiMinorAxis\", ellipseData.semiMinorAxis, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipse, \"height\", ellipseData.height, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, ellipse, \"heightReference\", ellipseData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipse, \"extrudedHeight\", ellipseData.extrudedHeight, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, ellipse, \"extrudedHeightReference\", ellipseData.extrudedHeightReference, interval, sourceUri, entityCollection);\n  processPacketData(Rotation, ellipse, \"rotation\", ellipseData.rotation, interval, sourceUri, entityCollection);\n  processPacketData(Rotation, ellipse, \"stRotation\", ellipseData.stRotation, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipse, \"granularity\", ellipseData.granularity, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, ellipse, \"fill\", ellipseData.fill, interval, sourceUri, entityCollection);\n  processMaterialPacketData(ellipse, \"material\", ellipseData.material, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, ellipse, \"outline\", ellipseData.outline, interval, sourceUri, entityCollection);\n  processPacketData(Color, ellipse, \"outlineColor\", ellipseData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipse, \"outlineWidth\", ellipseData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipse, \"numberOfVerticalLines\", ellipseData.numberOfVerticalLines, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, ellipse, \"shadows\", ellipseData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, ellipse, \"distanceDisplayCondition\", ellipseData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  processPacketData(ClassificationType, ellipse, \"classificationType\", ellipseData.classificationType, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipse, \"zIndex\", ellipseData.zIndex, interval, sourceUri, entityCollection);\n}\n\nfunction processEllipsoid(entity, packet, entityCollection, sourceUri) {\n  var ellipsoidData = packet.ellipsoid;\n\n  if (!defined(ellipsoidData)) {\n    return;\n  }\n\n  var interval = intervalFromString(ellipsoidData.interval);\n  var ellipsoid = entity.ellipsoid;\n\n  if (!defined(ellipsoid)) {\n    entity.ellipsoid = ellipsoid = new EllipsoidGraphics();\n  }\n\n  processPacketData(Boolean, ellipsoid, \"show\", ellipsoidData.show, interval, sourceUri, entityCollection);\n  processPacketData(Cartesian3, ellipsoid, \"radii\", ellipsoidData.radii, interval, sourceUri, entityCollection);\n  processPacketData(Cartesian3, ellipsoid, \"innerRadii\", ellipsoidData.innerRadii, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipsoid, \"minimumClock\", ellipsoidData.minimumClock, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipsoid, \"maximumClock\", ellipsoidData.maximumClock, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipsoid, \"minimumCone\", ellipsoidData.minimumCone, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipsoid, \"maximumCone\", ellipsoidData.maximumCone, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, ellipsoid, \"heightReference\", ellipsoidData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, ellipsoid, \"fill\", ellipsoidData.fill, interval, sourceUri, entityCollection);\n  processMaterialPacketData(ellipsoid, \"material\", ellipsoidData.material, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, ellipsoid, \"outline\", ellipsoidData.outline, interval, sourceUri, entityCollection);\n  processPacketData(Color, ellipsoid, \"outlineColor\", ellipsoidData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipsoid, \"outlineWidth\", ellipsoidData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipsoid, \"stackPartitions\", ellipsoidData.stackPartitions, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipsoid, \"slicePartitions\", ellipsoidData.slicePartitions, interval, sourceUri, entityCollection);\n  processPacketData(Number, ellipsoid, \"subdivisions\", ellipsoidData.subdivisions, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, ellipsoid, \"shadows\", ellipsoidData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, ellipsoid, \"distanceDisplayCondition\", ellipsoidData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n}\n\nfunction processLabel(entity, packet, entityCollection, sourceUri) {\n  var labelData = packet.label;\n\n  if (!defined(labelData)) {\n    return;\n  }\n\n  var interval = intervalFromString(labelData.interval);\n  var label = entity.label;\n\n  if (!defined(label)) {\n    entity.label = label = new LabelGraphics();\n  }\n\n  processPacketData(Boolean, label, \"show\", labelData.show, interval, sourceUri, entityCollection);\n  processPacketData(String, label, \"text\", labelData.text, interval, sourceUri, entityCollection);\n  processPacketData(String, label, \"font\", labelData.font, interval, sourceUri, entityCollection);\n  processPacketData(LabelStyle, label, \"style\", labelData.style, interval, sourceUri, entityCollection);\n  processPacketData(Number, label, \"scale\", labelData.scale, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, label, \"showBackground\", labelData.showBackground, interval, sourceUri, entityCollection);\n  processPacketData(Color, label, \"backgroundColor\", labelData.backgroundColor, interval, sourceUri, entityCollection);\n  processPacketData(Cartesian2, label, \"backgroundPadding\", labelData.backgroundPadding, interval, sourceUri, entityCollection);\n  processPacketData(Cartesian2, label, \"pixelOffset\", labelData.pixelOffset, interval, sourceUri, entityCollection);\n  processPacketData(Cartesian3, label, \"eyeOffset\", labelData.eyeOffset, interval, sourceUri, entityCollection);\n  processPacketData(HorizontalOrigin, label, \"horizontalOrigin\", labelData.horizontalOrigin, interval, sourceUri, entityCollection);\n  processPacketData(VerticalOrigin, label, \"verticalOrigin\", labelData.verticalOrigin, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, label, \"heightReference\", labelData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Color, label, \"fillColor\", labelData.fillColor, interval, sourceUri, entityCollection);\n  processPacketData(Color, label, \"outlineColor\", labelData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, label, \"outlineWidth\", labelData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(NearFarScalar, label, \"translucencyByDistance\", labelData.translucencyByDistance, interval, sourceUri, entityCollection);\n  processPacketData(NearFarScalar, label, \"pixelOffsetScaleByDistance\", labelData.pixelOffsetScaleByDistance, interval, sourceUri, entityCollection);\n  processPacketData(NearFarScalar, label, \"scaleByDistance\", labelData.scaleByDistance, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, label, \"distanceDisplayCondition\", labelData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  processPacketData(Number, label, \"disableDepthTestDistance\", labelData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n}\n\nfunction processModel(entity, packet, entityCollection, sourceUri) {\n  var modelData = packet.model;\n\n  if (!defined(modelData)) {\n    return;\n  }\n\n  var interval = intervalFromString(modelData.interval);\n  var model = entity.model;\n\n  if (!defined(model)) {\n    entity.model = model = new ModelGraphics();\n  }\n\n  processPacketData(Boolean, model, \"show\", modelData.show, interval, sourceUri, entityCollection);\n  processPacketData(Uri, model, \"uri\", modelData.gltf, interval, sourceUri, entityCollection);\n  processPacketData(Number, model, \"scale\", modelData.scale, interval, sourceUri, entityCollection);\n  processPacketData(Number, model, \"minimumPixelSize\", modelData.minimumPixelSize, interval, sourceUri, entityCollection);\n  processPacketData(Number, model, \"maximumScale\", modelData.maximumScale, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, model, \"incrementallyLoadTextures\", modelData.incrementallyLoadTextures, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, model, \"runAnimations\", modelData.runAnimations, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, model, \"clampAnimations\", modelData.clampAnimations, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, model, \"shadows\", modelData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, model, \"heightReference\", modelData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Color, model, \"silhouetteColor\", modelData.silhouetteColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, model, \"silhouetteSize\", modelData.silhouetteSize, interval, sourceUri, entityCollection);\n  processPacketData(Color, model, \"color\", modelData.color, interval, sourceUri, entityCollection);\n  processPacketData(ColorBlendMode, model, \"colorBlendMode\", modelData.colorBlendMode, interval, sourceUri, entityCollection);\n  processPacketData(Number, model, \"colorBlendAmount\", modelData.colorBlendAmount, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, model, \"distanceDisplayCondition\", modelData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  var i, len;\n  var nodeTransformationsData = modelData.nodeTransformations;\n\n  if (defined(nodeTransformationsData)) {\n    if (Array.isArray(nodeTransformationsData)) {\n      for (i = 0, len = nodeTransformationsData.length; i < len; ++i) {\n        processNodeTransformations(model, nodeTransformationsData[i], interval, sourceUri, entityCollection);\n      }\n    } else {\n      processNodeTransformations(model, nodeTransformationsData, interval, sourceUri, entityCollection);\n    }\n  }\n\n  var articulationsData = modelData.articulations;\n\n  if (defined(articulationsData)) {\n    if (Array.isArray(articulationsData)) {\n      for (i = 0, len = articulationsData.length; i < len; ++i) {\n        processArticulations(model, articulationsData[i], interval, sourceUri, entityCollection);\n      }\n    } else {\n      processArticulations(model, articulationsData, interval, sourceUri, entityCollection);\n    }\n  }\n}\n\nfunction processNodeTransformations(model, nodeTransformationsData, constrainedInterval, sourceUri, entityCollection) {\n  var combinedInterval = intervalFromString(nodeTransformationsData.interval);\n\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var nodeTransformations = model.nodeTransformations;\n  var nodeNames = Object.keys(nodeTransformationsData);\n\n  for (var i = 0, len = nodeNames.length; i < len; ++i) {\n    var nodeName = nodeNames[i];\n\n    if (nodeName === \"interval\") {\n      continue;\n    }\n\n    var nodeTransformationData = nodeTransformationsData[nodeName];\n\n    if (!defined(nodeTransformationData)) {\n      continue;\n    }\n\n    if (!defined(nodeTransformations)) {\n      model.nodeTransformations = nodeTransformations = new PropertyBag();\n    }\n\n    if (!nodeTransformations.hasProperty(nodeName)) {\n      nodeTransformations.addProperty(nodeName);\n    }\n\n    var nodeTransformation = nodeTransformations[nodeName];\n\n    if (!defined(nodeTransformation)) {\n      nodeTransformations[nodeName] = nodeTransformation = new NodeTransformationProperty();\n    }\n\n    processPacketData(Cartesian3, nodeTransformation, \"translation\", nodeTransformationData.translation, combinedInterval, sourceUri, entityCollection);\n    processPacketData(Quaternion, nodeTransformation, \"rotation\", nodeTransformationData.rotation, combinedInterval, sourceUri, entityCollection);\n    processPacketData(Cartesian3, nodeTransformation, \"scale\", nodeTransformationData.scale, combinedInterval, sourceUri, entityCollection);\n  }\n}\n\nfunction processArticulations(model, articulationsData, constrainedInterval, sourceUri, entityCollection) {\n  var combinedInterval = intervalFromString(articulationsData.interval);\n\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var articulations = model.articulations;\n  var keys = Object.keys(articulationsData);\n\n  for (var i = 0, len = keys.length; i < len; ++i) {\n    var key = keys[i];\n\n    if (key === \"interval\") {\n      continue;\n    }\n\n    var articulationStageData = articulationsData[key];\n\n    if (!defined(articulationStageData)) {\n      continue;\n    }\n\n    if (!defined(articulations)) {\n      model.articulations = articulations = new PropertyBag();\n    }\n\n    if (!articulations.hasProperty(key)) {\n      articulations.addProperty(key);\n    }\n\n    processPacketData(Number, articulations, key, articulationStageData, combinedInterval, sourceUri, entityCollection);\n  }\n}\n\nfunction processPath(entity, packet, entityCollection, sourceUri) {\n  var pathData = packet.path;\n\n  if (!defined(pathData)) {\n    return;\n  }\n\n  var interval = intervalFromString(pathData.interval);\n  var path = entity.path;\n\n  if (!defined(path)) {\n    entity.path = path = new PathGraphics();\n  }\n\n  processPacketData(Boolean, path, \"show\", pathData.show, interval, sourceUri, entityCollection);\n  processPacketData(Number, path, \"leadTime\", pathData.leadTime, interval, sourceUri, entityCollection);\n  processPacketData(Number, path, \"trailTime\", pathData.trailTime, interval, sourceUri, entityCollection);\n  processPacketData(Number, path, \"width\", pathData.width, interval, sourceUri, entityCollection);\n  processPacketData(Number, path, \"resolution\", pathData.resolution, interval, sourceUri, entityCollection);\n  processMaterialPacketData(path, \"material\", pathData.material, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, path, \"distanceDisplayCondition\", pathData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n}\n\nfunction processPoint(entity, packet, entityCollection, sourceUri) {\n  var pointData = packet.point;\n\n  if (!defined(pointData)) {\n    return;\n  }\n\n  var interval = intervalFromString(pointData.interval);\n  var point = entity.point;\n\n  if (!defined(point)) {\n    entity.point = point = new PointGraphics();\n  }\n\n  processPacketData(Boolean, point, \"show\", pointData.show, interval, sourceUri, entityCollection);\n  processPacketData(Number, point, \"pixelSize\", pointData.pixelSize, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, point, \"heightReference\", pointData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Color, point, \"color\", pointData.color, interval, sourceUri, entityCollection);\n  processPacketData(Color, point, \"outlineColor\", pointData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, point, \"outlineWidth\", pointData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(NearFarScalar, point, \"scaleByDistance\", pointData.scaleByDistance, interval, sourceUri, entityCollection);\n  processPacketData(NearFarScalar, point, \"translucencyByDistance\", pointData.translucencyByDistance, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, point, \"distanceDisplayCondition\", pointData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  processPacketData(Number, point, \"disableDepthTestDistance\", pointData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n}\n\nfunction PolygonHierarchyProperty(polygon) {\n  this.polygon = polygon;\n  this._definitionChanged = new Event();\n}\n\nObject.defineProperties(PolygonHierarchyProperty.prototype, {\n  isConstant: {\n    get: function () {\n      var positions = this.polygon._positions;\n      var holes = this.polygon._holes;\n      return (!defined(positions) || positions.isConstant) && (!defined(holes) || holes.isConstant);\n    }\n  },\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    }\n  }\n});\n\nPolygonHierarchyProperty.prototype.getValue = function (time, result) {\n  var positions;\n\n  if (defined(this.polygon._positions)) {\n    positions = this.polygon._positions.getValue(time);\n  }\n\n  var holes;\n\n  if (defined(this.polygon._holes)) {\n    holes = this.polygon._holes.getValue(time);\n\n    if (defined(holes)) {\n      holes = holes.map(function (holePositions) {\n        return new PolygonHierarchy(holePositions);\n      });\n    }\n  }\n\n  if (!defined(result)) {\n    return new PolygonHierarchy(positions, holes);\n  }\n\n  result.positions = positions;\n  result.holes = holes;\n  return result;\n};\n\nPolygonHierarchyProperty.prototype.equals = function (other) {\n  return this === other || other instanceof PolygonHierarchyProperty && Property.equals(this.polygon._positions, other.polygon._positions) && Property.equals(this.polygon._holes, other.polygon._holes);\n};\n\nfunction processPolygon(entity, packet, entityCollection, sourceUri) {\n  var polygonData = packet.polygon;\n\n  if (!defined(polygonData)) {\n    return;\n  }\n\n  var interval = intervalFromString(polygonData.interval);\n  var polygon = entity.polygon;\n\n  if (!defined(polygon)) {\n    entity.polygon = polygon = new PolygonGraphics();\n  }\n\n  processPacketData(Boolean, polygon, \"show\", polygonData.show, interval, sourceUri, entityCollection); // adapt 'position' property producing Cartesian[]\n  // and 'holes' property producing Cartesian[][]\n  // to a single property producing PolygonHierarchy\n\n  processPositionArray(polygon, \"_positions\", polygonData.positions, entityCollection);\n  processPositionArrayOfArrays(polygon, \"_holes\", polygonData.holes, entityCollection);\n\n  if (defined(polygon._positions) || defined(polygon._holes)) {\n    polygon.hierarchy = new PolygonHierarchyProperty(polygon);\n  }\n\n  processPacketData(Number, polygon, \"height\", polygonData.height, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, polygon, \"heightReference\", polygonData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Number, polygon, \"extrudedHeight\", polygonData.extrudedHeight, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, polygon, \"extrudedHeightReference\", polygonData.extrudedHeightReference, interval, sourceUri, entityCollection);\n  processPacketData(Rotation, polygon, \"stRotation\", polygonData.stRotation, interval, sourceUri, entityCollection);\n  processPacketData(Number, polygon, \"granularity\", polygonData.granularity, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, polygon, \"fill\", polygonData.fill, interval, sourceUri, entityCollection);\n  processMaterialPacketData(polygon, \"material\", polygonData.material, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, polygon, \"outline\", polygonData.outline, interval, sourceUri, entityCollection);\n  processPacketData(Color, polygon, \"outlineColor\", polygonData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, polygon, \"outlineWidth\", polygonData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, polygon, \"perPositionHeight\", polygonData.perPositionHeight, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, polygon, \"closeTop\", polygonData.closeTop, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, polygon, \"closeBottom\", polygonData.closeBottom, interval, sourceUri, entityCollection);\n  processPacketData(ArcType, polygon, \"arcType\", polygonData.arcType, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, polygon, \"shadows\", polygonData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, polygon, \"distanceDisplayCondition\", polygonData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  processPacketData(ClassificationType, polygon, \"classificationType\", polygonData.classificationType, interval, sourceUri, entityCollection);\n  processPacketData(Number, polygon, \"zIndex\", polygonData.zIndex, interval, sourceUri, entityCollection);\n}\n\nfunction adaptFollowSurfaceToArcType(followSurface) {\n  return followSurface ? ArcType.GEODESIC : ArcType.NONE;\n}\n\nfunction processPolyline(entity, packet, entityCollection, sourceUri) {\n  var polylineData = packet.polyline;\n\n  if (!defined(polylineData)) {\n    return;\n  }\n\n  var interval = intervalFromString(polylineData.interval);\n  var polyline = entity.polyline;\n\n  if (!defined(polyline)) {\n    entity.polyline = polyline = new PolylineGraphics();\n  }\n\n  processPacketData(Boolean, polyline, \"show\", polylineData.show, interval, sourceUri, entityCollection);\n  processPositionArray(polyline, \"positions\", polylineData.positions, entityCollection);\n  processPacketData(Number, polyline, \"width\", polylineData.width, interval, sourceUri, entityCollection);\n  processPacketData(Number, polyline, \"granularity\", polylineData.granularity, interval, sourceUri, entityCollection);\n  processMaterialPacketData(polyline, \"material\", polylineData.material, interval, sourceUri, entityCollection);\n  processMaterialPacketData(polyline, \"depthFailMaterial\", polylineData.depthFailMaterial, interval, sourceUri, entityCollection);\n  processPacketData(ArcType, polyline, \"arcType\", polylineData.arcType, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, polyline, \"clampToGround\", polylineData.clampToGround, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, polyline, \"shadows\", polylineData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, polyline, \"distanceDisplayCondition\", polylineData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  processPacketData(ClassificationType, polyline, \"classificationType\", polylineData.classificationType, interval, sourceUri, entityCollection);\n  processPacketData(Number, polyline, \"zIndex\", polylineData.zIndex, interval, sourceUri, entityCollection); // for backwards compatibility, adapt CZML followSurface to arcType.\n\n  if (defined(polylineData.followSurface) && !defined(polylineData.arcType)) {\n    var tempObj = {};\n    processPacketData(Boolean, tempObj, \"followSurface\", polylineData.followSurface, interval, sourceUri, entityCollection);\n    polyline.arcType = createAdapterProperty(tempObj.followSurface, adaptFollowSurfaceToArcType);\n  }\n}\n\nfunction processRectangle(entity, packet, entityCollection, sourceUri) {\n  var rectangleData = packet.rectangle;\n\n  if (!defined(rectangleData)) {\n    return;\n  }\n\n  var interval = intervalFromString(rectangleData.interval);\n  var rectangle = entity.rectangle;\n\n  if (!defined(rectangle)) {\n    entity.rectangle = rectangle = new RectangleGraphics();\n  }\n\n  processPacketData(Boolean, rectangle, \"show\", rectangleData.show, interval, sourceUri, entityCollection);\n  processPacketData(Rectangle, rectangle, \"coordinates\", rectangleData.coordinates, interval, sourceUri, entityCollection);\n  processPacketData(Number, rectangle, \"height\", rectangleData.height, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, rectangle, \"heightReference\", rectangleData.heightReference, interval, sourceUri, entityCollection);\n  processPacketData(Number, rectangle, \"extrudedHeight\", rectangleData.extrudedHeight, interval, sourceUri, entityCollection);\n  processPacketData(HeightReference, rectangle, \"extrudedHeightReference\", rectangleData.extrudedHeightReference, interval, sourceUri, entityCollection);\n  processPacketData(Rotation, rectangle, \"rotation\", rectangleData.rotation, interval, sourceUri, entityCollection);\n  processPacketData(Rotation, rectangle, \"stRotation\", rectangleData.stRotation, interval, sourceUri, entityCollection);\n  processPacketData(Number, rectangle, \"granularity\", rectangleData.granularity, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, rectangle, \"fill\", rectangleData.fill, interval, sourceUri, entityCollection);\n  processMaterialPacketData(rectangle, \"material\", rectangleData.material, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, rectangle, \"outline\", rectangleData.outline, interval, sourceUri, entityCollection);\n  processPacketData(Color, rectangle, \"outlineColor\", rectangleData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, rectangle, \"outlineWidth\", rectangleData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, rectangle, \"shadows\", rectangleData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, rectangle, \"distanceDisplayCondition\", rectangleData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n  processPacketData(ClassificationType, rectangle, \"classificationType\", rectangleData.classificationType, interval, sourceUri, entityCollection);\n  processPacketData(Number, rectangle, \"zIndex\", rectangleData.zIndex, interval, sourceUri, entityCollection);\n}\n\nfunction processTileset(entity, packet, entityCollection, sourceUri) {\n  var tilesetData = packet.tileset;\n\n  if (!defined(tilesetData)) {\n    return;\n  }\n\n  var interval = intervalFromString(tilesetData.interval);\n  var tileset = entity.tileset;\n\n  if (!defined(tileset)) {\n    entity.tileset = tileset = new Cesium3DTilesetGraphics();\n  }\n\n  processPacketData(Boolean, tileset, \"show\", tilesetData.show, interval, sourceUri, entityCollection);\n  processPacketData(Uri, tileset, \"uri\", tilesetData.uri, interval, sourceUri, entityCollection);\n  processPacketData(Number, tileset, \"maximumScreenSpaceError\", tilesetData.maximumScreenSpaceError, interval, sourceUri, entityCollection);\n}\n\nfunction processWall(entity, packet, entityCollection, sourceUri) {\n  var wallData = packet.wall;\n\n  if (!defined(wallData)) {\n    return;\n  }\n\n  var interval = intervalFromString(wallData.interval);\n  var wall = entity.wall;\n\n  if (!defined(wall)) {\n    entity.wall = wall = new WallGraphics();\n  }\n\n  processPacketData(Boolean, wall, \"show\", wallData.show, interval, sourceUri, entityCollection);\n  processPositionArray(wall, \"positions\", wallData.positions, entityCollection);\n  processArray(wall, \"minimumHeights\", wallData.minimumHeights, entityCollection);\n  processArray(wall, \"maximumHeights\", wallData.maximumHeights, entityCollection);\n  processPacketData(Number, wall, \"granularity\", wallData.granularity, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, wall, \"fill\", wallData.fill, interval, sourceUri, entityCollection);\n  processMaterialPacketData(wall, \"material\", wallData.material, interval, sourceUri, entityCollection);\n  processPacketData(Boolean, wall, \"outline\", wallData.outline, interval, sourceUri, entityCollection);\n  processPacketData(Color, wall, \"outlineColor\", wallData.outlineColor, interval, sourceUri, entityCollection);\n  processPacketData(Number, wall, \"outlineWidth\", wallData.outlineWidth, interval, sourceUri, entityCollection);\n  processPacketData(ShadowMode, wall, \"shadows\", wallData.shadows, interval, sourceUri, entityCollection);\n  processPacketData(DistanceDisplayCondition, wall, \"distanceDisplayCondition\", wallData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n}\n\nfunction processCzmlPacket(packet, entityCollection, updaterFunctions, sourceUri, dataSource) {\n  var objectId = packet.id;\n\n  if (!defined(objectId)) {\n    objectId = createGuid();\n  }\n\n  currentId = objectId;\n\n  if (!defined(dataSource._version) && objectId !== \"document\") {\n    throw new RuntimeError(\"The first CZML packet is required to be the document object.\");\n  }\n\n  if (packet[\"delete\"] === true) {\n    entityCollection.removeById(objectId);\n  } else if (objectId === \"document\") {\n    processDocument(packet, dataSource);\n  } else {\n    var entity = entityCollection.getOrCreateEntity(objectId);\n    var parentId = packet.parent;\n\n    if (defined(parentId)) {\n      entity.parent = entityCollection.getOrCreateEntity(parentId);\n    }\n\n    for (var i = updaterFunctions.length - 1; i > -1; i--) {\n      updaterFunctions[i](entity, packet, entityCollection, sourceUri);\n    }\n  }\n\n  currentId = undefined;\n}\n\nfunction updateClock(dataSource) {\n  var clock;\n  var clockPacket = dataSource._documentPacket.clock;\n\n  if (!defined(clockPacket)) {\n    if (!defined(dataSource._clock)) {\n      var availability = dataSource._entityCollection.computeAvailability();\n\n      if (!availability.start.equals(Iso8601.MINIMUM_VALUE)) {\n        var startTime = availability.start;\n        var stopTime = availability.stop;\n        var totalSeconds = JulianDate.secondsDifference(stopTime, startTime);\n        var multiplier = Math.round(totalSeconds / 120.0);\n        clock = new DataSourceClock();\n        clock.startTime = JulianDate.clone(startTime);\n        clock.stopTime = JulianDate.clone(stopTime);\n        clock.clockRange = ClockRange.LOOP_STOP;\n        clock.multiplier = multiplier;\n        clock.currentTime = JulianDate.clone(startTime);\n        clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n        dataSource._clock = clock;\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  if (defined(dataSource._clock)) {\n    clock = dataSource._clock.clone();\n  } else {\n    clock = new DataSourceClock();\n    clock.startTime = Iso8601.MINIMUM_VALUE.clone();\n    clock.stopTime = Iso8601.MAXIMUM_VALUE.clone();\n    clock.currentTime = Iso8601.MINIMUM_VALUE.clone();\n    clock.clockRange = ClockRange.LOOP_STOP;\n    clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n    clock.multiplier = 1.0;\n  }\n\n  var interval = intervalFromString(clockPacket.interval);\n\n  if (defined(interval)) {\n    clock.startTime = interval.start;\n    clock.stopTime = interval.stop;\n  }\n\n  if (defined(clockPacket.currentTime)) {\n    clock.currentTime = JulianDate.fromIso8601(clockPacket.currentTime);\n  }\n\n  if (defined(clockPacket.range)) {\n    clock.clockRange = defaultValue(ClockRange[clockPacket.range], ClockRange.LOOP_STOP);\n  }\n\n  if (defined(clockPacket.step)) {\n    clock.clockStep = defaultValue(ClockStep[clockPacket.step], ClockStep.SYSTEM_CLOCK_MULTIPLIER);\n  }\n\n  if (defined(clockPacket.multiplier)) {\n    clock.multiplier = clockPacket.multiplier;\n  }\n\n  if (!clock.equals(dataSource._clock)) {\n    dataSource._clock = clock.clone(dataSource._clock);\n    return true;\n  }\n\n  return false;\n}\n\nfunction load(dataSource, czml, options, clear) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(czml)) {\n    throw new DeveloperError(\"czml is required.\");\n  } //>>includeEnd('debug');\n\n\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  var promise = czml;\n  var sourceUri = options.sourceUri; // User specified credit\n\n  var credit = options.credit;\n\n  if (typeof credit === \"string\") {\n    credit = new Credit(credit);\n  }\n\n  dataSource._credit = credit; // If the czml is a URL\n\n  if (typeof czml === \"string\" || czml instanceof Resource) {\n    czml = Resource.createIfNeeded(czml);\n    promise = czml.fetchJson();\n    sourceUri = defaultValue(sourceUri, czml.clone()); // Add resource credits to our list of credits to display\n\n    var resourceCredits = dataSource._resourceCredits;\n    var credits = czml.credits;\n\n    if (defined(credits)) {\n      var length = credits.length;\n\n      for (var i = 0; i < length; i++) {\n        resourceCredits.push(credits[i]);\n      }\n    }\n  }\n\n  sourceUri = Resource.createIfNeeded(sourceUri);\n  DataSource.setLoading(dataSource, true);\n  return when(promise, function (czml) {\n    return loadCzml(dataSource, czml, sourceUri, clear);\n  }).otherwise(function (error) {\n    DataSource.setLoading(dataSource, false);\n\n    dataSource._error.raiseEvent(dataSource, error);\n\n    console.log(error);\n    return when.reject(error);\n  });\n}\n\nfunction loadCzml(dataSource, czml, sourceUri, clear) {\n  DataSource.setLoading(dataSource, true);\n  var entityCollection = dataSource._entityCollection;\n\n  if (clear) {\n    dataSource._version = undefined;\n    dataSource._documentPacket = new DocumentPacket();\n    entityCollection.removeAll();\n  }\n\n  CzmlDataSource._processCzml(czml, entityCollection, sourceUri, undefined, dataSource);\n\n  var raiseChangedEvent = updateClock(dataSource);\n  var documentPacket = dataSource._documentPacket;\n\n  if (defined(documentPacket.name) && dataSource._name !== documentPacket.name) {\n    dataSource._name = documentPacket.name;\n    raiseChangedEvent = true;\n  } else if (!defined(dataSource._name) && defined(sourceUri)) {\n    dataSource._name = getFilenameFromUri(sourceUri.getUrlComponent());\n    raiseChangedEvent = true;\n  }\n\n  DataSource.setLoading(dataSource, false);\n\n  if (raiseChangedEvent) {\n    dataSource._changed.raiseEvent(dataSource);\n  }\n\n  return dataSource;\n}\n\nfunction DocumentPacket() {\n  this.name = undefined;\n  this.clock = undefined;\n}\n/**\n * A {@link DataSource} which processes {@link https://github.com/AnalyticalGraphicsInc/czml-writer/wiki/CZML-Guide|CZML}.\n * @alias CzmlDataSource\n * @constructor\n *\n * @param {String} [name] An optional name for the data source.  This value will be overwritten if a loaded document contains a name.\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=CZML.html|Cesium Sandcastle CZML Demo}\n */\n\n\nfunction CzmlDataSource(name) {\n  this._name = name;\n  this._changed = new Event();\n  this._error = new Event();\n  this._isLoading = false;\n  this._loading = new Event();\n  this._clock = undefined;\n  this._documentPacket = new DocumentPacket();\n  this._version = undefined;\n  this._entityCollection = new EntityCollection(this);\n  this._entityCluster = new EntityCluster();\n  this._credit = undefined;\n  this._resourceCredits = [];\n}\n/**\n * Creates a Promise to a new instance loaded with the provided CZML data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {Object} [options] An object with the following properties:\n * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links.\n * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to the new instance once the data is processed.\n */\n\n\nCzmlDataSource.load = function (czml, options) {\n  return new CzmlDataSource().load(czml, options);\n};\n\nObject.defineProperties(CzmlDataSource.prototype, {\n  /**\n   * Gets a human-readable name for this instance.\n   * @memberof CzmlDataSource.prototype\n   * @type {String}\n   */\n  name: {\n    get: function () {\n      return this._name;\n    }\n  },\n\n  /**\n   * Gets the clock settings defined by the loaded CZML.  If no clock is explicitly\n   * defined in the CZML, the combined availability of all objects is returned.  If\n   * only static data exists, this value is undefined.\n   * @memberof CzmlDataSource.prototype\n   * @type {DataSourceClock}\n   */\n  clock: {\n    get: function () {\n      return this._clock;\n    }\n  },\n\n  /**\n   * Gets the collection of {@link Entity} instances.\n   * @memberof CzmlDataSource.prototype\n   * @type {EntityCollection}\n   */\n  entities: {\n    get: function () {\n      return this._entityCollection;\n    }\n  },\n\n  /**\n   * Gets a value indicating if the data source is currently loading data.\n   * @memberof CzmlDataSource.prototype\n   * @type {Boolean}\n   */\n  isLoading: {\n    get: function () {\n      return this._isLoading;\n    }\n  },\n\n  /**\n   * Gets an event that will be raised when the underlying data changes.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  changedEvent: {\n    get: function () {\n      return this._changed;\n    }\n  },\n\n  /**\n   * Gets an event that will be raised if an error is encountered during processing.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  errorEvent: {\n    get: function () {\n      return this._error;\n    }\n  },\n\n  /**\n   * Gets an event that will be raised when the data source either starts or stops loading.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  loadingEvent: {\n    get: function () {\n      return this._loading;\n    }\n  },\n\n  /**\n   * Gets whether or not this data source should be displayed.\n   * @memberof CzmlDataSource.prototype\n   * @type {Boolean}\n   */\n  show: {\n    get: function () {\n      return this._entityCollection.show;\n    },\n    set: function (value) {\n      this._entityCollection.show = value;\n    }\n  },\n\n  /**\n   * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n   *\n   * @memberof CzmlDataSource.prototype\n   * @type {EntityCluster}\n   */\n  clustering: {\n    get: function () {\n      return this._entityCluster;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      if (!defined(value)) {\n        throw new DeveloperError(\"value must be defined.\");\n      } //>>includeEnd('debug');\n\n\n      this._entityCluster = value;\n    }\n  },\n\n  /**\n   * Gets the credit that will be displayed for the data source\n   * @memberof CzmlDataSource.prototype\n   * @type {Credit}\n   */\n  credit: {\n    get: function () {\n      return this._credit;\n    }\n  }\n});\n/**\n * Gets the array of CZML processing functions.\n * @memberof CzmlDataSource\n * @type Array\n */\n\nCzmlDataSource.updaters = [processBillboard, //\nprocessBox, //\nprocessCorridor, //\nprocessCylinder, //\nprocessEllipse, //\nprocessEllipsoid, //\nprocessLabel, //\nprocessModel, //\nprocessName, //\nprocessDescription, //\nprocessPath, //\nprocessPoint, //\nprocessPolygon, //\nprocessPolyline, //\nprocessProperties, //\nprocessRectangle, //\nprocessPosition, //\nprocessTileset, //\nprocessViewFrom, //\nprocessWall, //\nprocessOrientation, //\nprocessAvailability];\n/**\n * Processes the provided url or CZML object without clearing any existing data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {Object} [options] An object with the following properties:\n * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n */\n\nCzmlDataSource.prototype.process = function (czml, options) {\n  return load(this, czml, options, false);\n};\n/**\n * Loads the provided url or CZML object, replacing any existing data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {Object} [options] An object with the following properties:\n * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n */\n\n\nCzmlDataSource.prototype.load = function (czml, options) {\n  return load(this, czml, options, true);\n};\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link Property} from a CZML packet.\n * @function\n *\n * @param {Function} type The constructor function for the property being processed.\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\n\n\nCzmlDataSource.processPacketData = processPacketData;\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link PositionProperty} from a CZML packet.\n * @function\n *\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\n\nCzmlDataSource.processPositionPacketData = processPositionPacketData;\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link MaterialProperty} from a CZML packet.\n * @function\n *\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\n\nCzmlDataSource.processMaterialPacketData = processMaterialPacketData;\n\nCzmlDataSource._processCzml = function (czml, entityCollection, sourceUri, updaterFunctions, dataSource) {\n  updaterFunctions = defaultValue(updaterFunctions, CzmlDataSource.updaters);\n\n  if (Array.isArray(czml)) {\n    for (var i = 0, len = czml.length; i < len; ++i) {\n      processCzmlPacket(czml[i], entityCollection, updaterFunctions, sourceUri, dataSource);\n    }\n  } else {\n    processCzmlPacket(czml, entityCollection, updaterFunctions, sourceUri, dataSource);\n  }\n};\n\nexport default CzmlDataSource;","map":{"version":3,"sources":["C:/Users/passa/Desktop/WaterDeployTrial/node_modules/cesium/Source/DataSources/CzmlDataSource.js"],"names":["ArcType","BoundingRectangle","Cartesian2","Cartesian3","Cartographic","ClockRange","ClockStep","Color","CornerType","Credit","createGuid","defaultValue","defined","DeveloperError","DistanceDisplayCondition","Ellipsoid","Event","ExtrapolationType","getFilenameFromUri","HermitePolynomialApproximation","Iso8601","JulianDate","LagrangePolynomialApproximation","LinearApproximation","CesiumMath","NearFarScalar","PolygonHierarchy","Quaternion","Rectangle","ReferenceFrame","Resource","RuntimeError","Spherical","TimeInterval","TimeIntervalCollection","ClassificationType","ColorBlendMode","HeightReference","HorizontalOrigin","LabelStyle","ShadowMode","VerticalOrigin","Uri","when","BillboardGraphics","BoxGraphics","CallbackProperty","CheckerboardMaterialProperty","ColorMaterialProperty","CompositeMaterialProperty","CompositePositionProperty","CompositeProperty","ConstantPositionProperty","ConstantProperty","CorridorGraphics","CylinderGraphics","DataSource","DataSourceClock","EllipseGraphics","EllipsoidGraphics","EntityCluster","EntityCollection","GridMaterialProperty","ImageMaterialProperty","LabelGraphics","ModelGraphics","NodeTransformationProperty","PathGraphics","PointGraphics","PolygonGraphics","PolylineArrowMaterialProperty","PolylineDashMaterialProperty","PolylineGlowMaterialProperty","PolylineGraphics","PolylineOutlineMaterialProperty","PositionPropertyArray","Property","PropertyArray","PropertyBag","RectangleGraphics","ReferenceProperty","Rotation","SampledPositionProperty","SampledProperty","StripeMaterialProperty","StripeOrientation","TimeIntervalCollectionPositionProperty","TimeIntervalCollectionProperty","VelocityOrientationProperty","VelocityVectorProperty","WallGraphics","Cesium3DTilesetGraphics","UnitCartesian3","packedLength","unpack","pack","currentId","createReferenceProperty","entityCollection","referenceString","fromString","createSpecializedProperty","type","packetData","reference","velocityReference","referenceProperty","JSON","stringify","createAdapterProperty","property","adapterFunction","time","result","getValue","isConstant","scratchCartesian","scratchSpherical","scratchCartographic","scratchTimeInterval","scratchQuaternion","unwrapColorInterval","czmlInterval","rgbaf","rgba","undefined","length","byteToFloat","Array","i","unwrapUriInterval","sourceUri","uri","getDerivedResource","url","createIfNeeded","unwrapRectangleInterval","wsen","wsenDegrees","toRadians","convertUnitSphericalToCartesian","unitSpherical","magnitude","clock","cone","fromSpherical","x","y","z","j","convertSphericalToCartesian","spherical","convertCartographicRadiansToCartesian","cartographicRadians","longitude","latitude","height","WGS84","cartographicToCartesian","convertCartographicDegreesToCartesian","cartographicDegrees","unwrapCartesianInterval","cartesian","cartesianVelocity","unitCartesian","normalizePackedCartesianArray","array","startingIndex","normalize","unwrapUnitCartesianInterval","normalizePackedQuaternionArray","unwrapQuaternionInterval","unitQuaternion","getPropertyType","Boolean","Number","String","hasOwnProperty","Object","unwrapInterval","arcType","boundingRectangle","cartesian2","classificationType","colorBlendMode","cornerType","heightReference","horizontalOrigin","Image","fromIso8601","date","labelStyle","number","nearFarScalar","distanceDisplayCondition","object","value","shadowMode","shadows","string","stripeOrientation","verticalOrigin","interpolators","HERMITE","LAGRANGE","LINEAR","updateInterpolationSettings","interpolationAlgorithm","interpolationDegree","setInterpolationOptions","forwardExtrapolationType","forwardExtrapolationDuration","backwardExtrapolationType","backwardExtrapolationDuration","iso8601Scratch","iso8601","intervalFromString","intervalString","wrapPropertyInInfiniteInterval","interval","MAXIMUM_INTERVAL","clone","data","convertPropertyToComposite","composite","intervals","addInterval","convertPositionPropertyToComposite","referenceFrame","processProperty","propertyName","constrainedInterval","combinedInterval","intersect","unwrappedInterval","unwrappedIntervalLength","isValue","hasInterval","equals","delete","removePropertyData","isSampled","needsUnpacking","epoch","packetEpoch","addSamplesPackedArray","findInterval","removeSamples","removeInterval","intersection","get","isEmpty","processPacketData","isArray","len","processPositionProperty","numberOfDerivatives","removePositionPropertyData","FIXED","processPositionPacketData","processMaterialProperty","existingMaterial","existingInterval","thisIntervals","start","stop","materialData","solidColor","color","grid","cellAlpha","lineCount","lineThickness","lineOffset","image","repeat","transparent","stripe","orientation","evenColor","oddColor","offset","polylineOutline","outlineColor","outlineWidth","polylineGlow","glowPower","taperPower","polylineArrow","polylineDash","gapColor","dashLength","dashPattern","checkerboard","processMaterialPacketData","processName","entity","packet","nameData","name","processDescription","descriptionData","description","processPosition","positionData","position","processViewFrom","viewFromData","viewFrom","processOrientation","orientationData","processProperties","propertiesData","properties","key","hasProperty","addProperty","propertyData","processReferencesArrayPacketData","references","PropertyArrayType","CompositePropertyArrayType","map","processArrayPacketData","processArray","processPositionArrayPacketData","unpackArray","fromRadiansArrayHeights","fromDegreesArrayHeights","processPositionArray","unpackCartesianArray","unpackCartographicRadiansArray","unpackCartographicDegreesArray","processPositionArrayOfArraysPacketData","referenceArray","tempObj","positions","processPositionArrayOfArrays","processAvailability","availability","processAlignedAxis","billboard","processBillboard","billboardData","show","scale","pixelOffset","eyeOffset","rotation","alignedAxis","sizeInMeters","width","scaleByDistance","translucencyByDistance","pixelOffsetScaleByDistance","imageSubRegion","disableDepthTestDistance","processBox","boxData","box","dimensions","fill","material","outline","processCorridor","corridorData","corridor","extrudedHeight","extrudedHeightReference","granularity","zIndex","processCylinder","cylinderData","cylinder","topRadius","bottomRadius","numberOfVerticalLines","slices","processDocument","dataSource","version","tokens","split","_version","documentPacket","_documentPacket","clockPacket","currentTime","range","step","multiplier","processEllipse","ellipseData","ellipse","semiMajorAxis","semiMinorAxis","stRotation","processEllipsoid","ellipsoidData","ellipsoid","radii","innerRadii","minimumClock","maximumClock","minimumCone","maximumCone","stackPartitions","slicePartitions","subdivisions","processLabel","labelData","label","text","font","style","showBackground","backgroundColor","backgroundPadding","fillColor","processModel","modelData","model","gltf","minimumPixelSize","maximumScale","incrementallyLoadTextures","runAnimations","clampAnimations","silhouetteColor","silhouetteSize","colorBlendAmount","nodeTransformationsData","nodeTransformations","processNodeTransformations","articulationsData","articulations","processArticulations","nodeNames","keys","nodeName","nodeTransformationData","nodeTransformation","translation","articulationStageData","processPath","pathData","path","leadTime","trailTime","resolution","processPoint","pointData","point","pixelSize","PolygonHierarchyProperty","polygon","_definitionChanged","defineProperties","prototype","_positions","holes","_holes","definitionChanged","holePositions","other","processPolygon","polygonData","hierarchy","perPositionHeight","closeTop","closeBottom","adaptFollowSurfaceToArcType","followSurface","GEODESIC","NONE","processPolyline","polylineData","polyline","depthFailMaterial","clampToGround","processRectangle","rectangleData","rectangle","coordinates","processTileset","tilesetData","tileset","maximumScreenSpaceError","processWall","wallData","wall","minimumHeights","maximumHeights","processCzmlPacket","updaterFunctions","objectId","id","removeById","getOrCreateEntity","parentId","parent","updateClock","_clock","_entityCollection","computeAvailability","MINIMUM_VALUE","startTime","stopTime","totalSeconds","secondsDifference","Math","round","clockRange","LOOP_STOP","clockStep","SYSTEM_CLOCK_MULTIPLIER","MAXIMUM_VALUE","load","czml","options","clear","EMPTY_OBJECT","promise","credit","_credit","fetchJson","resourceCredits","_resourceCredits","credits","push","setLoading","loadCzml","otherwise","error","_error","raiseEvent","console","log","reject","DocumentPacket","removeAll","CzmlDataSource","_processCzml","raiseChangedEvent","_name","getUrlComponent","_changed","_isLoading","_loading","_entityCluster","entities","isLoading","changedEvent","errorEvent","loadingEvent","set","clustering","updaters","process"],"mappings":"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","sourcesContent":["import ArcType from \"../Core/ArcType.js\";\nimport BoundingRectangle from \"../Core/BoundingRectangle.js\";\nimport Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartographic from \"../Core/Cartographic.js\";\nimport ClockRange from \"../Core/ClockRange.js\";\nimport ClockStep from \"../Core/ClockStep.js\";\nimport Color from \"../Core/Color.js\";\nimport CornerType from \"../Core/CornerType.js\";\nimport Credit from \"../Core/Credit.js\";\nimport createGuid from \"../Core/createGuid.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport DistanceDisplayCondition from \"../Core/DistanceDisplayCondition.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\nimport Event from \"../Core/Event.js\";\nimport ExtrapolationType from \"../Core/ExtrapolationType.js\";\nimport getFilenameFromUri from \"../Core/getFilenameFromUri.js\";\nimport HermitePolynomialApproximation from \"../Core/HermitePolynomialApproximation.js\";\nimport Iso8601 from \"../Core/Iso8601.js\";\nimport JulianDate from \"../Core/JulianDate.js\";\nimport LagrangePolynomialApproximation from \"../Core/LagrangePolynomialApproximation.js\";\nimport LinearApproximation from \"../Core/LinearApproximation.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport NearFarScalar from \"../Core/NearFarScalar.js\";\nimport PolygonHierarchy from \"../Core/PolygonHierarchy.js\";\nimport Quaternion from \"../Core/Quaternion.js\";\nimport Rectangle from \"../Core/Rectangle.js\";\nimport ReferenceFrame from \"../Core/ReferenceFrame.js\";\nimport Resource from \"../Core/Resource.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport Spherical from \"../Core/Spherical.js\";\nimport TimeInterval from \"../Core/TimeInterval.js\";\nimport TimeIntervalCollection from \"../Core/TimeIntervalCollection.js\";\nimport ClassificationType from \"../Scene/ClassificationType.js\";\nimport ColorBlendMode from \"../Scene/ColorBlendMode.js\";\nimport HeightReference from \"../Scene/HeightReference.js\";\nimport HorizontalOrigin from \"../Scene/HorizontalOrigin.js\";\nimport LabelStyle from \"../Scene/LabelStyle.js\";\nimport ShadowMode from \"../Scene/ShadowMode.js\";\nimport VerticalOrigin from \"../Scene/VerticalOrigin.js\";\nimport Uri from \"../ThirdParty/Uri.js\";\nimport when from \"../ThirdParty/when.js\";\nimport BillboardGraphics from \"./BillboardGraphics.js\";\nimport BoxGraphics from \"./BoxGraphics.js\";\nimport CallbackProperty from \"./CallbackProperty.js\";\nimport CheckerboardMaterialProperty from \"./CheckerboardMaterialProperty.js\";\nimport ColorMaterialProperty from \"./ColorMaterialProperty.js\";\nimport CompositeMaterialProperty from \"./CompositeMaterialProperty.js\";\nimport CompositePositionProperty from \"./CompositePositionProperty.js\";\nimport CompositeProperty from \"./CompositeProperty.js\";\nimport ConstantPositionProperty from \"./ConstantPositionProperty.js\";\nimport ConstantProperty from \"./ConstantProperty.js\";\nimport CorridorGraphics from \"./CorridorGraphics.js\";\nimport CylinderGraphics from \"./CylinderGraphics.js\";\nimport DataSource from \"./DataSource.js\";\nimport DataSourceClock from \"./DataSourceClock.js\";\nimport EllipseGraphics from \"./EllipseGraphics.js\";\nimport EllipsoidGraphics from \"./EllipsoidGraphics.js\";\nimport EntityCluster from \"./EntityCluster.js\";\nimport EntityCollection from \"./EntityCollection.js\";\nimport GridMaterialProperty from \"./GridMaterialProperty.js\";\nimport ImageMaterialProperty from \"./ImageMaterialProperty.js\";\nimport LabelGraphics from \"./LabelGraphics.js\";\nimport ModelGraphics from \"./ModelGraphics.js\";\nimport NodeTransformationProperty from \"./NodeTransformationProperty.js\";\nimport PathGraphics from \"./PathGraphics.js\";\nimport PointGraphics from \"./PointGraphics.js\";\nimport PolygonGraphics from \"./PolygonGraphics.js\";\nimport PolylineArrowMaterialProperty from \"./PolylineArrowMaterialProperty.js\";\nimport PolylineDashMaterialProperty from \"./PolylineDashMaterialProperty.js\";\nimport PolylineGlowMaterialProperty from \"./PolylineGlowMaterialProperty.js\";\nimport PolylineGraphics from \"./PolylineGraphics.js\";\nimport PolylineOutlineMaterialProperty from \"./PolylineOutlineMaterialProperty.js\";\nimport PositionPropertyArray from \"./PositionPropertyArray.js\";\nimport Property from \"./Property.js\";\nimport PropertyArray from \"./PropertyArray.js\";\nimport PropertyBag from \"./PropertyBag.js\";\nimport RectangleGraphics from \"./RectangleGraphics.js\";\nimport ReferenceProperty from \"./ReferenceProperty.js\";\nimport Rotation from \"./Rotation.js\";\nimport SampledPositionProperty from \"./SampledPositionProperty.js\";\nimport SampledProperty from \"./SampledProperty.js\";\nimport StripeMaterialProperty from \"./StripeMaterialProperty.js\";\nimport StripeOrientation from \"./StripeOrientation.js\";\nimport TimeIntervalCollectionPositionProperty from \"./TimeIntervalCollectionPositionProperty.js\";\nimport TimeIntervalCollectionProperty from \"./TimeIntervalCollectionProperty.js\";\nimport VelocityOrientationProperty from \"./VelocityOrientationProperty.js\";\nimport VelocityVectorProperty from \"./VelocityVectorProperty.js\";\nimport WallGraphics from \"./WallGraphics.js\";\nimport Cesium3DTilesetGraphics from \"./Cesium3DTilesetGraphics.js\";\n\n// A marker type to distinguish CZML properties where we need to end up with a unit vector.\n// The data is still loaded into Cartesian3 objects but they are normalized.\nfunction UnitCartesian3() {}\nUnitCartesian3.packedLength = Cartesian3.packedLength;\nUnitCartesian3.unpack = Cartesian3.unpack;\nUnitCartesian3.pack = Cartesian3.pack;\n\n// As a side note, for the purposes of CZML, Quaternion always indicates a unit quaternion.\n\nvar currentId;\n\nfunction createReferenceProperty(entityCollection, referenceString) {\n  if (referenceString[0] === \"#\") {\n    referenceString = currentId + referenceString;\n  }\n  return ReferenceProperty.fromString(entityCollection, referenceString);\n}\n\nfunction createSpecializedProperty(type, entityCollection, packetData) {\n  if (defined(packetData.reference)) {\n    return createReferenceProperty(entityCollection, packetData.reference);\n  }\n\n  if (defined(packetData.velocityReference)) {\n    var referenceProperty = createReferenceProperty(\n      entityCollection,\n      packetData.velocityReference\n    );\n    switch (type) {\n      case Cartesian3:\n      case UnitCartesian3:\n        return new VelocityVectorProperty(\n          referenceProperty,\n          type === UnitCartesian3\n        );\n      case Quaternion:\n        return new VelocityOrientationProperty(referenceProperty);\n    }\n  }\n\n  throw new RuntimeError(JSON.stringify(packetData) + \" is not valid CZML.\");\n}\n\nfunction createAdapterProperty(property, adapterFunction) {\n  return new CallbackProperty(function (time, result) {\n    return adapterFunction(property.getValue(time, result));\n  }, property.isConstant);\n}\n\nvar scratchCartesian = new Cartesian3();\nvar scratchSpherical = new Spherical();\nvar scratchCartographic = new Cartographic();\nvar scratchTimeInterval = new TimeInterval();\nvar scratchQuaternion = new Quaternion();\n\nfunction unwrapColorInterval(czmlInterval) {\n  var rgbaf = czmlInterval.rgbaf;\n  if (defined(rgbaf)) {\n    return rgbaf;\n  }\n\n  var rgba = czmlInterval.rgba;\n  if (!defined(rgba)) {\n    return undefined;\n  }\n\n  var length = rgba.length;\n  if (length === Color.packedLength) {\n    return [\n      Color.byteToFloat(rgba[0]),\n      Color.byteToFloat(rgba[1]),\n      Color.byteToFloat(rgba[2]),\n      Color.byteToFloat(rgba[3]),\n    ];\n  }\n\n  rgbaf = new Array(length);\n  for (var i = 0; i < length; i += 5) {\n    rgbaf[i] = rgba[i];\n    rgbaf[i + 1] = Color.byteToFloat(rgba[i + 1]);\n    rgbaf[i + 2] = Color.byteToFloat(rgba[i + 2]);\n    rgbaf[i + 3] = Color.byteToFloat(rgba[i + 3]);\n    rgbaf[i + 4] = Color.byteToFloat(rgba[i + 4]);\n  }\n  return rgbaf;\n}\n\nfunction unwrapUriInterval(czmlInterval, sourceUri) {\n  var uri = defaultValue(czmlInterval.uri, czmlInterval);\n  if (defined(sourceUri)) {\n    return sourceUri.getDerivedResource({\n      url: uri,\n    });\n  }\n\n  return Resource.createIfNeeded(uri);\n}\n\nfunction unwrapRectangleInterval(czmlInterval) {\n  var wsen = czmlInterval.wsen;\n  if (defined(wsen)) {\n    return wsen;\n  }\n\n  var wsenDegrees = czmlInterval.wsenDegrees;\n  if (!defined(wsenDegrees)) {\n    return undefined;\n  }\n\n  var length = wsenDegrees.length;\n  if (length === Rectangle.packedLength) {\n    return [\n      CesiumMath.toRadians(wsenDegrees[0]),\n      CesiumMath.toRadians(wsenDegrees[1]),\n      CesiumMath.toRadians(wsenDegrees[2]),\n      CesiumMath.toRadians(wsenDegrees[3]),\n    ];\n  }\n\n  wsen = new Array(length);\n  for (var i = 0; i < length; i += 5) {\n    wsen[i] = wsenDegrees[i];\n    wsen[i + 1] = CesiumMath.toRadians(wsenDegrees[i + 1]);\n    wsen[i + 2] = CesiumMath.toRadians(wsenDegrees[i + 2]);\n    wsen[i + 3] = CesiumMath.toRadians(wsenDegrees[i + 3]);\n    wsen[i + 4] = CesiumMath.toRadians(wsenDegrees[i + 4]);\n  }\n  return wsen;\n}\n\nfunction convertUnitSphericalToCartesian(unitSpherical) {\n  var length = unitSpherical.length;\n  scratchSpherical.magnitude = 1.0;\n  if (length === 2) {\n    scratchSpherical.clock = unitSpherical[0];\n    scratchSpherical.cone = unitSpherical[1];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array((length / 3) * 4);\n  for (var i = 0, j = 0; i < length; i += 3, j += 4) {\n    result[j] = unitSpherical[i];\n\n    scratchSpherical.clock = unitSpherical[i + 1];\n    scratchSpherical.cone = unitSpherical[i + 2];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n    result[j + 1] = scratchCartesian.x;\n    result[j + 2] = scratchCartesian.y;\n    result[j + 3] = scratchCartesian.z;\n  }\n  return result;\n}\n\nfunction convertSphericalToCartesian(spherical) {\n  var length = spherical.length;\n  if (length === 3) {\n    scratchSpherical.clock = spherical[0];\n    scratchSpherical.cone = spherical[1];\n    scratchSpherical.magnitude = spherical[2];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n  for (var i = 0; i < length; i += 4) {\n    result[i] = spherical[i];\n\n    scratchSpherical.clock = spherical[i + 1];\n    scratchSpherical.cone = spherical[i + 2];\n    scratchSpherical.magnitude = spherical[i + 3];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n  return result;\n}\n\nfunction convertCartographicRadiansToCartesian(cartographicRadians) {\n  var length = cartographicRadians.length;\n  if (length === 3) {\n    scratchCartographic.longitude = cartographicRadians[0];\n    scratchCartographic.latitude = cartographicRadians[1];\n    scratchCartographic.height = cartographicRadians[2];\n    Ellipsoid.WGS84.cartographicToCartesian(\n      scratchCartographic,\n      scratchCartesian\n    );\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n  for (var i = 0; i < length; i += 4) {\n    result[i] = cartographicRadians[i];\n\n    scratchCartographic.longitude = cartographicRadians[i + 1];\n    scratchCartographic.latitude = cartographicRadians[i + 2];\n    scratchCartographic.height = cartographicRadians[i + 3];\n    Ellipsoid.WGS84.cartographicToCartesian(\n      scratchCartographic,\n      scratchCartesian\n    );\n\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n  return result;\n}\n\nfunction convertCartographicDegreesToCartesian(cartographicDegrees) {\n  var length = cartographicDegrees.length;\n  if (length === 3) {\n    scratchCartographic.longitude = CesiumMath.toRadians(\n      cartographicDegrees[0]\n    );\n    scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[1]);\n    scratchCartographic.height = cartographicDegrees[2];\n    Ellipsoid.WGS84.cartographicToCartesian(\n      scratchCartographic,\n      scratchCartesian\n    );\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n  for (var i = 0; i < length; i += 4) {\n    result[i] = cartographicDegrees[i];\n\n    scratchCartographic.longitude = CesiumMath.toRadians(\n      cartographicDegrees[i + 1]\n    );\n    scratchCartographic.latitude = CesiumMath.toRadians(\n      cartographicDegrees[i + 2]\n    );\n    scratchCartographic.height = cartographicDegrees[i + 3];\n    Ellipsoid.WGS84.cartographicToCartesian(\n      scratchCartographic,\n      scratchCartesian\n    );\n\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n  return result;\n}\n\nfunction unwrapCartesianInterval(czmlInterval) {\n  var cartesian = czmlInterval.cartesian;\n  if (defined(cartesian)) {\n    return cartesian;\n  }\n\n  var cartesianVelocity = czmlInterval.cartesianVelocity;\n  if (defined(cartesianVelocity)) {\n    return cartesianVelocity;\n  }\n\n  var unitCartesian = czmlInterval.unitCartesian;\n  if (defined(unitCartesian)) {\n    return unitCartesian;\n  }\n\n  var unitSpherical = czmlInterval.unitSpherical;\n  if (defined(unitSpherical)) {\n    return convertUnitSphericalToCartesian(unitSpherical);\n  }\n\n  var spherical = czmlInterval.spherical;\n  if (defined(spherical)) {\n    return convertSphericalToCartesian(spherical);\n  }\n\n  var cartographicRadians = czmlInterval.cartographicRadians;\n  if (defined(cartographicRadians)) {\n    return convertCartographicRadiansToCartesian(cartographicRadians);\n  }\n\n  var cartographicDegrees = czmlInterval.cartographicDegrees;\n  if (defined(cartographicDegrees)) {\n    return convertCartographicDegreesToCartesian(cartographicDegrees);\n  }\n\n  throw new RuntimeError(\n    JSON.stringify(czmlInterval) + \" is not a valid CZML interval.\"\n  );\n}\n\nfunction normalizePackedCartesianArray(array, startingIndex) {\n  Cartesian3.unpack(array, startingIndex, scratchCartesian);\n  Cartesian3.normalize(scratchCartesian, scratchCartesian);\n  Cartesian3.pack(scratchCartesian, array, startingIndex);\n}\n\nfunction unwrapUnitCartesianInterval(czmlInterval) {\n  var cartesian = unwrapCartesianInterval(czmlInterval);\n  if (cartesian.length === 3) {\n    normalizePackedCartesianArray(cartesian, 0);\n    return cartesian;\n  }\n\n  for (var i = 1; i < cartesian.length; i += 4) {\n    normalizePackedCartesianArray(cartesian, i);\n  }\n\n  return cartesian;\n}\n\nfunction normalizePackedQuaternionArray(array, startingIndex) {\n  Quaternion.unpack(array, startingIndex, scratchQuaternion);\n  Quaternion.normalize(scratchQuaternion, scratchQuaternion);\n  Quaternion.pack(scratchQuaternion, array, startingIndex);\n}\n\nfunction unwrapQuaternionInterval(czmlInterval) {\n  var unitQuaternion = czmlInterval.unitQuaternion;\n  if (defined(unitQuaternion)) {\n    if (unitQuaternion.length === 4) {\n      normalizePackedQuaternionArray(unitQuaternion, 0);\n      return unitQuaternion;\n    }\n\n    for (var i = 1; i < unitQuaternion.length; i += 5) {\n      normalizePackedQuaternionArray(unitQuaternion, i);\n    }\n  }\n  return unitQuaternion;\n}\n\nfunction getPropertyType(czmlInterval) {\n  // The associations in this function need to be kept in sync with the\n  // associations in unwrapInterval.\n\n  // Intentionally omitted due to conficts in CZML property names:\n  // * Image (conflicts with Uri)\n  // * Rotation (conflicts with Number)\n  //\n  // cartesianVelocity is also omitted due to incomplete support for\n  // derivative information in CZML properties.\n  // (Currently cartesianVelocity is hacked directly into the position processing code)\n  if (typeof czmlInterval === \"boolean\") {\n    return Boolean;\n  } else if (typeof czmlInterval === \"number\") {\n    return Number;\n  } else if (typeof czmlInterval === \"string\") {\n    return String;\n  } else if (czmlInterval.hasOwnProperty(\"array\")) {\n    return Array;\n  } else if (czmlInterval.hasOwnProperty(\"boolean\")) {\n    return Boolean;\n  } else if (czmlInterval.hasOwnProperty(\"boundingRectangle\")) {\n    return BoundingRectangle;\n  } else if (czmlInterval.hasOwnProperty(\"cartesian2\")) {\n    return Cartesian2;\n  } else if (\n    czmlInterval.hasOwnProperty(\"cartesian\") ||\n    czmlInterval.hasOwnProperty(\"spherical\") ||\n    czmlInterval.hasOwnProperty(\"cartographicRadians\") ||\n    czmlInterval.hasOwnProperty(\"cartographicDegrees\")\n  ) {\n    return Cartesian3;\n  } else if (\n    czmlInterval.hasOwnProperty(\"unitCartesian\") ||\n    czmlInterval.hasOwnProperty(\"unitSpherical\")\n  ) {\n    return UnitCartesian3;\n  } else if (\n    czmlInterval.hasOwnProperty(\"rgba\") ||\n    czmlInterval.hasOwnProperty(\"rgbaf\")\n  ) {\n    return Color;\n  } else if (czmlInterval.hasOwnProperty(\"arcType\")) {\n    return ArcType;\n  } else if (czmlInterval.hasOwnProperty(\"classificationType\")) {\n    return ClassificationType;\n  } else if (czmlInterval.hasOwnProperty(\"colorBlendMode\")) {\n    return ColorBlendMode;\n  } else if (czmlInterval.hasOwnProperty(\"cornerType\")) {\n    return CornerType;\n  } else if (czmlInterval.hasOwnProperty(\"heightReference\")) {\n    return HeightReference;\n  } else if (czmlInterval.hasOwnProperty(\"horizontalOrigin\")) {\n    return HorizontalOrigin;\n  } else if (czmlInterval.hasOwnProperty(\"date\")) {\n    return JulianDate;\n  } else if (czmlInterval.hasOwnProperty(\"labelStyle\")) {\n    return LabelStyle;\n  } else if (czmlInterval.hasOwnProperty(\"number\")) {\n    return Number;\n  } else if (czmlInterval.hasOwnProperty(\"nearFarScalar\")) {\n    return NearFarScalar;\n  } else if (czmlInterval.hasOwnProperty(\"distanceDisplayCondition\")) {\n    return DistanceDisplayCondition;\n  } else if (\n    czmlInterval.hasOwnProperty(\"object\") ||\n    czmlInterval.hasOwnProperty(\"value\")\n  ) {\n    return Object;\n  } else if (czmlInterval.hasOwnProperty(\"unitQuaternion\")) {\n    return Quaternion;\n  } else if (czmlInterval.hasOwnProperty(\"shadowMode\")) {\n    return ShadowMode;\n  } else if (czmlInterval.hasOwnProperty(\"string\")) {\n    return String;\n  } else if (czmlInterval.hasOwnProperty(\"stripeOrientation\")) {\n    return StripeOrientation;\n  } else if (\n    czmlInterval.hasOwnProperty(\"wsen\") ||\n    czmlInterval.hasOwnProperty(\"wsenDegrees\")\n  ) {\n    return Rectangle;\n  } else if (czmlInterval.hasOwnProperty(\"uri\")) {\n    return Uri;\n  } else if (czmlInterval.hasOwnProperty(\"verticalOrigin\")) {\n    return VerticalOrigin;\n  }\n  // fallback case\n  return Object;\n}\n\nfunction unwrapInterval(type, czmlInterval, sourceUri) {\n  // The associations in this function need to be kept in sync with the\n  // associations in getPropertyType\n  switch (type) {\n    case ArcType:\n      return ArcType[defaultValue(czmlInterval.arcType, czmlInterval)];\n    case Array:\n      return czmlInterval.array;\n    case Boolean:\n      return defaultValue(czmlInterval[\"boolean\"], czmlInterval);\n    case BoundingRectangle:\n      return czmlInterval.boundingRectangle;\n    case Cartesian2:\n      return czmlInterval.cartesian2;\n    case Cartesian3:\n      return unwrapCartesianInterval(czmlInterval);\n    case UnitCartesian3:\n      return unwrapUnitCartesianInterval(czmlInterval);\n    case Color:\n      return unwrapColorInterval(czmlInterval);\n    case ClassificationType:\n      return ClassificationType[\n        defaultValue(czmlInterval.classificationType, czmlInterval)\n      ];\n    case ColorBlendMode:\n      return ColorBlendMode[\n        defaultValue(czmlInterval.colorBlendMode, czmlInterval)\n      ];\n    case CornerType:\n      return CornerType[defaultValue(czmlInterval.cornerType, czmlInterval)];\n    case HeightReference:\n      return HeightReference[\n        defaultValue(czmlInterval.heightReference, czmlInterval)\n      ];\n    case HorizontalOrigin:\n      return HorizontalOrigin[\n        defaultValue(czmlInterval.horizontalOrigin, czmlInterval)\n      ];\n    case Image:\n      return unwrapUriInterval(czmlInterval, sourceUri);\n    case JulianDate:\n      return JulianDate.fromIso8601(\n        defaultValue(czmlInterval.date, czmlInterval)\n      );\n    case LabelStyle:\n      return LabelStyle[defaultValue(czmlInterval.labelStyle, czmlInterval)];\n    case Number:\n      return defaultValue(czmlInterval.number, czmlInterval);\n    case NearFarScalar:\n      return czmlInterval.nearFarScalar;\n    case DistanceDisplayCondition:\n      return czmlInterval.distanceDisplayCondition;\n    case Object:\n      return defaultValue(\n        defaultValue(czmlInterval.object, czmlInterval.value),\n        czmlInterval\n      );\n    case Quaternion:\n      return unwrapQuaternionInterval(czmlInterval);\n    case Rotation:\n      return defaultValue(czmlInterval.number, czmlInterval);\n    case ShadowMode:\n      return ShadowMode[\n        defaultValue(\n          defaultValue(czmlInterval.shadowMode, czmlInterval.shadows),\n          czmlInterval\n        )\n      ];\n    case String:\n      return defaultValue(czmlInterval.string, czmlInterval);\n    case StripeOrientation:\n      return StripeOrientation[\n        defaultValue(czmlInterval.stripeOrientation, czmlInterval)\n      ];\n    case Rectangle:\n      return unwrapRectangleInterval(czmlInterval);\n    case Uri:\n      return unwrapUriInterval(czmlInterval, sourceUri);\n    case VerticalOrigin:\n      return VerticalOrigin[\n        defaultValue(czmlInterval.verticalOrigin, czmlInterval)\n      ];\n    default:\n      throw new RuntimeError(type);\n  }\n}\n\nvar interpolators = {\n  HERMITE: HermitePolynomialApproximation,\n  LAGRANGE: LagrangePolynomialApproximation,\n  LINEAR: LinearApproximation,\n};\n\nfunction updateInterpolationSettings(packetData, property) {\n  var interpolationAlgorithm = packetData.interpolationAlgorithm;\n  var interpolationDegree = packetData.interpolationDegree;\n  if (defined(interpolationAlgorithm) || defined(interpolationDegree)) {\n    property.setInterpolationOptions({\n      interpolationAlgorithm: interpolators[interpolationAlgorithm],\n      interpolationDegree: interpolationDegree,\n    });\n  }\n\n  var forwardExtrapolationType = packetData.forwardExtrapolationType;\n  if (defined(forwardExtrapolationType)) {\n    property.forwardExtrapolationType =\n      ExtrapolationType[forwardExtrapolationType];\n  }\n\n  var forwardExtrapolationDuration = packetData.forwardExtrapolationDuration;\n  if (defined(forwardExtrapolationDuration)) {\n    property.forwardExtrapolationDuration = forwardExtrapolationDuration;\n  }\n\n  var backwardExtrapolationType = packetData.backwardExtrapolationType;\n  if (defined(backwardExtrapolationType)) {\n    property.backwardExtrapolationType =\n      ExtrapolationType[backwardExtrapolationType];\n  }\n\n  var backwardExtrapolationDuration = packetData.backwardExtrapolationDuration;\n  if (defined(backwardExtrapolationDuration)) {\n    property.backwardExtrapolationDuration = backwardExtrapolationDuration;\n  }\n}\n\nvar iso8601Scratch = {\n  iso8601: undefined,\n};\n\nfunction intervalFromString(intervalString) {\n  if (!defined(intervalString)) {\n    return undefined;\n  }\n  iso8601Scratch.iso8601 = intervalString;\n  return TimeInterval.fromIso8601(iso8601Scratch);\n}\n\nfunction wrapPropertyInInfiniteInterval(property) {\n  var interval = Iso8601.MAXIMUM_INTERVAL.clone();\n  interval.data = property;\n  return interval;\n}\n\nfunction convertPropertyToComposite(property) {\n  // Create the composite and add the old property, wrapped in an infinite interval.\n  var composite = new CompositeProperty();\n  composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n  return composite;\n}\n\nfunction convertPositionPropertyToComposite(property) {\n  // Create the composite and add the old property, wrapped in an infinite interval.\n  var composite = new CompositePositionProperty(property.referenceFrame);\n  composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n  return composite;\n}\n\nfunction processProperty(\n  type,\n  object,\n  propertyName,\n  packetData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(packetData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var packedLength;\n  var unwrappedInterval;\n  var unwrappedIntervalLength;\n\n  // CZML properties can be defined in many ways.  Most ways represent a structure for\n  // encoding a single value (number, string, cartesian, etc.)  Regardless of the value type,\n  // if it encodes a single value it will get loaded into a ConstantProperty eventually.\n  // Alternatively, there are ways of defining a property that require specialized\n  // client-side representation. Currently, these are ReferenceProperty,\n  // and client-side velocity computation properties such as VelocityVectorProperty.\n  var isValue =\n    !defined(packetData.reference) && !defined(packetData.velocityReference);\n  var hasInterval =\n    defined(combinedInterval) &&\n    !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n  if (packetData.delete === true) {\n    // If deleting this property for all time, we can simply set to undefined and return.\n    if (!hasInterval) {\n      object[propertyName] = undefined;\n      return;\n    }\n\n    // Deleting depends on the type of property we have.\n    return removePropertyData(object[propertyName], combinedInterval);\n  }\n\n  var isSampled = false;\n\n  if (isValue) {\n    unwrappedInterval = unwrapInterval(type, packetData, sourceUri);\n    if (!defined(unwrappedInterval)) {\n      // not a known value type, bail\n      return;\n    }\n    packedLength = defaultValue(type.packedLength, 1);\n    unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n    isSampled =\n      !defined(packetData.array) &&\n      typeof unwrappedInterval !== \"string\" &&\n      unwrappedIntervalLength > packedLength &&\n      type !== Object;\n  }\n\n  // Rotation is a special case because it represents a native type (Number)\n  // and therefore does not need to be unpacked when loaded as a constant value.\n  var needsUnpacking = typeof type.unpack === \"function\" && type !== Rotation;\n\n  // Any time a constant value is assigned, it completely blows away anything else.\n  if (!isSampled && !hasInterval) {\n    if (isValue) {\n      object[propertyName] = new ConstantProperty(\n        needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval\n      );\n    } else {\n      object[propertyName] = createSpecializedProperty(\n        type,\n        entityCollection,\n        packetData\n      );\n    }\n    return;\n  }\n\n  var property = object[propertyName];\n\n  var epoch;\n  var packetEpoch = packetData.epoch;\n  if (defined(packetEpoch)) {\n    epoch = JulianDate.fromIso8601(packetEpoch);\n  }\n\n  // Without an interval, any sampled value is infinite, meaning it completely\n  // replaces any non-sampled property that may exist.\n  if (isSampled && !hasInterval) {\n    if (!(property instanceof SampledProperty)) {\n      object[propertyName] = property = new SampledProperty(type);\n    }\n    property.addSamplesPackedArray(unwrappedInterval, epoch);\n    updateInterpolationSettings(packetData, property);\n    return;\n  }\n\n  var interval;\n\n  // A constant value with an interval is normally part of a TimeIntervalCollection,\n  // However, if the current property is not a time-interval collection, we need\n  // to turn it into a Composite, preserving the old data with the new interval.\n  if (!isSampled && hasInterval) {\n    // Create a new interval for the constant value.\n    combinedInterval = combinedInterval.clone();\n    if (isValue) {\n      combinedInterval.data = needsUnpacking\n        ? type.unpack(unwrappedInterval, 0)\n        : unwrappedInterval;\n    } else {\n      combinedInterval.data = createSpecializedProperty(\n        type,\n        entityCollection,\n        packetData\n      );\n    }\n\n    // If no property exists, simply use a new interval collection\n    if (!defined(property)) {\n      object[propertyName] = property = isValue\n        ? new TimeIntervalCollectionProperty()\n        : new CompositeProperty();\n    }\n\n    if (isValue && property instanceof TimeIntervalCollectionProperty) {\n      // If we created a collection, or it already was one, use it.\n      property.intervals.addInterval(combinedInterval);\n    } else if (property instanceof CompositeProperty) {\n      // If the collection was already a CompositeProperty, use it.\n      if (isValue) {\n        combinedInterval.data = new ConstantProperty(combinedInterval.data);\n      }\n      property.intervals.addInterval(combinedInterval);\n    } else {\n      // Otherwise, create a CompositeProperty but preserve the existing data.\n      object[propertyName] = property = convertPropertyToComposite(property);\n\n      // Change the new data to a ConstantProperty and add it.\n      if (isValue) {\n        combinedInterval.data = new ConstantProperty(combinedInterval.data);\n      }\n      property.intervals.addInterval(combinedInterval);\n    }\n\n    return;\n  }\n\n  // isSampled && hasInterval\n  if (!defined(property)) {\n    object[propertyName] = property = new CompositeProperty();\n  }\n\n  // Create a CompositeProperty but preserve the existing data.\n  if (!(property instanceof CompositeProperty)) {\n    object[propertyName] = property = convertPropertyToComposite(property);\n  }\n\n  // Check if the interval already exists in the composite.\n  var intervals = property.intervals;\n  interval = intervals.findInterval(combinedInterval);\n  if (!defined(interval) || !(interval.data instanceof SampledProperty)) {\n    // If not, create a SampledProperty for it.\n    interval = combinedInterval.clone();\n    interval.data = new SampledProperty(type);\n    intervals.addInterval(interval);\n  }\n  interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n  updateInterpolationSettings(packetData, interval.data);\n}\n\nfunction removePropertyData(property, interval) {\n  if (property instanceof SampledProperty) {\n    property.removeSamples(interval);\n    return;\n  } else if (property instanceof TimeIntervalCollectionProperty) {\n    property.intervals.removeInterval(interval);\n    return;\n  } else if (property instanceof CompositeProperty) {\n    var intervals = property.intervals;\n    for (var i = 0; i < intervals.length; ++i) {\n      var intersection = TimeInterval.intersect(\n        intervals.get(i),\n        interval,\n        scratchTimeInterval\n      );\n      if (!intersection.isEmpty) {\n        // remove data from the contained properties\n        removePropertyData(intersection.data, interval);\n      }\n    }\n    // remove the intervals from the composite\n    intervals.removeInterval(interval);\n    return;\n  }\n}\n\nfunction processPacketData(\n  type,\n  object,\n  propertyName,\n  packetData,\n  interval,\n  sourceUri,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processProperty(\n        type,\n        object,\n        propertyName,\n        packetData[i],\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  } else {\n    processProperty(\n      type,\n      object,\n      propertyName,\n      packetData,\n      interval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processPositionProperty(\n  object,\n  propertyName,\n  packetData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(packetData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var numberOfDerivatives = defined(packetData.cartesianVelocity) ? 1 : 0;\n  var packedLength = Cartesian3.packedLength * (numberOfDerivatives + 1);\n  var unwrappedInterval;\n  var unwrappedIntervalLength;\n  var isValue = !defined(packetData.reference);\n  var hasInterval =\n    defined(combinedInterval) &&\n    !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n  if (packetData.delete === true) {\n    // If deleting this property for all time, we can simply set to undefined and return.\n    if (!hasInterval) {\n      object[propertyName] = undefined;\n      return;\n    }\n\n    // Deleting depends on the type of property we have.\n    return removePositionPropertyData(object[propertyName], combinedInterval);\n  }\n\n  var referenceFrame;\n  var isSampled = false;\n\n  if (isValue) {\n    if (defined(packetData.referenceFrame)) {\n      referenceFrame = ReferenceFrame[packetData.referenceFrame];\n    }\n    referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n    unwrappedInterval = unwrapCartesianInterval(packetData);\n    unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n    isSampled = unwrappedIntervalLength > packedLength;\n  }\n\n  // Any time a constant value is assigned, it completely blows away anything else.\n  if (!isSampled && !hasInterval) {\n    if (isValue) {\n      object[propertyName] = new ConstantPositionProperty(\n        Cartesian3.unpack(unwrappedInterval),\n        referenceFrame\n      );\n    } else {\n      object[propertyName] = createReferenceProperty(\n        entityCollection,\n        packetData.reference\n      );\n    }\n    return;\n  }\n\n  var property = object[propertyName];\n\n  var epoch;\n  var packetEpoch = packetData.epoch;\n  if (defined(packetEpoch)) {\n    epoch = JulianDate.fromIso8601(packetEpoch);\n  }\n\n  // Without an interval, any sampled value is infinite, meaning it completely\n  // replaces any non-sampled property that may exist.\n  if (isSampled && !hasInterval) {\n    if (\n      !(property instanceof SampledPositionProperty) ||\n      (defined(referenceFrame) && property.referenceFrame !== referenceFrame)\n    ) {\n      object[propertyName] = property = new SampledPositionProperty(\n        referenceFrame,\n        numberOfDerivatives\n      );\n    }\n    property.addSamplesPackedArray(unwrappedInterval, epoch);\n    updateInterpolationSettings(packetData, property);\n    return;\n  }\n\n  var interval;\n\n  // A constant value with an interval is normally part of a TimeIntervalCollection,\n  // However, if the current property is not a time-interval collection, we need\n  // to turn it into a Composite, preserving the old data with the new interval.\n  if (!isSampled && hasInterval) {\n    // Create a new interval for the constant value.\n    combinedInterval = combinedInterval.clone();\n    if (isValue) {\n      combinedInterval.data = Cartesian3.unpack(unwrappedInterval);\n    } else {\n      combinedInterval.data = createReferenceProperty(\n        entityCollection,\n        packetData.reference\n      );\n    }\n\n    // If no property exists, simply use a new interval collection\n    if (!defined(property)) {\n      if (isValue) {\n        property = new TimeIntervalCollectionPositionProperty(referenceFrame);\n      } else {\n        property = new CompositePositionProperty(referenceFrame);\n      }\n      object[propertyName] = property;\n    }\n\n    if (\n      isValue &&\n      property instanceof TimeIntervalCollectionPositionProperty &&\n      defined(referenceFrame) &&\n      property.referenceFrame === referenceFrame\n    ) {\n      // If we create a collection, or it already existed, use it.\n      property.intervals.addInterval(combinedInterval);\n    } else if (property instanceof CompositePositionProperty) {\n      // If the collection was already a CompositePositionProperty, use it.\n      if (isValue) {\n        combinedInterval.data = new ConstantPositionProperty(\n          combinedInterval.data,\n          referenceFrame\n        );\n      }\n      property.intervals.addInterval(combinedInterval);\n    } else {\n      // Otherwise, create a CompositePositionProperty but preserve the existing data.\n      object[propertyName] = property = convertPositionPropertyToComposite(\n        property\n      );\n\n      // Change the new data to a ConstantPositionProperty and add it.\n      if (isValue) {\n        combinedInterval.data = new ConstantPositionProperty(\n          combinedInterval.data,\n          referenceFrame\n        );\n      }\n      property.intervals.addInterval(combinedInterval);\n    }\n\n    return;\n  }\n\n  // isSampled && hasInterval\n  if (!defined(property)) {\n    object[propertyName] = property = new CompositePositionProperty(\n      referenceFrame\n    );\n  } else if (!(property instanceof CompositePositionProperty)) {\n    // Create a CompositeProperty but preserve the existing data.\n    object[propertyName] = property = convertPositionPropertyToComposite(\n      property\n    );\n  }\n\n  // Check if the interval already exists in the composite.\n  var intervals = property.intervals;\n  interval = intervals.findInterval(combinedInterval);\n  if (\n    !defined(interval) ||\n    !(interval.data instanceof SampledPositionProperty) ||\n    (defined(referenceFrame) && interval.data.referenceFrame !== referenceFrame)\n  ) {\n    // If not, create a SampledPositionProperty for it.\n    interval = combinedInterval.clone();\n    interval.data = new SampledPositionProperty(\n      referenceFrame,\n      numberOfDerivatives\n    );\n    intervals.addInterval(interval);\n  }\n  interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n  updateInterpolationSettings(packetData, interval.data);\n}\n\nfunction removePositionPropertyData(property, interval) {\n  if (property instanceof SampledPositionProperty) {\n    property.removeSamples(interval);\n    return;\n  } else if (property instanceof TimeIntervalCollectionPositionProperty) {\n    property.intervals.removeInterval(interval);\n    return;\n  } else if (property instanceof CompositePositionProperty) {\n    var intervals = property.intervals;\n    for (var i = 0; i < intervals.length; ++i) {\n      var intersection = TimeInterval.intersect(\n        intervals.get(i),\n        interval,\n        scratchTimeInterval\n      );\n      if (!intersection.isEmpty) {\n        // remove data from the contained properties\n        removePositionPropertyData(intersection.data, interval);\n      }\n    }\n    // remove the intervals from the composite\n    intervals.removeInterval(interval);\n    return;\n  }\n}\n\nfunction processPositionPacketData(\n  object,\n  propertyName,\n  packetData,\n  interval,\n  sourceUri,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processPositionProperty(\n        object,\n        propertyName,\n        packetData[i],\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  } else {\n    processPositionProperty(\n      object,\n      propertyName,\n      packetData,\n      interval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processMaterialProperty(\n  object,\n  propertyName,\n  packetData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(packetData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var property = object[propertyName];\n  var existingMaterial;\n  var existingInterval;\n\n  if (defined(combinedInterval)) {\n    if (!(property instanceof CompositeMaterialProperty)) {\n      property = new CompositeMaterialProperty();\n      object[propertyName] = property;\n    }\n    //See if we already have data at that interval.\n    var thisIntervals = property.intervals;\n    existingInterval = thisIntervals.findInterval({\n      start: combinedInterval.start,\n      stop: combinedInterval.stop,\n    });\n    if (defined(existingInterval)) {\n      //We have an interval, but we need to make sure the\n      //new data is the same type of material as the old data.\n      existingMaterial = existingInterval.data;\n    } else {\n      //If not, create it.\n      existingInterval = combinedInterval.clone();\n      thisIntervals.addInterval(existingInterval);\n    }\n  } else {\n    existingMaterial = property;\n  }\n\n  var materialData;\n  if (defined(packetData.solidColor)) {\n    if (!(existingMaterial instanceof ColorMaterialProperty)) {\n      existingMaterial = new ColorMaterialProperty();\n    }\n    materialData = packetData.solidColor;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      undefined,\n      entityCollection\n    );\n  } else if (defined(packetData.grid)) {\n    if (!(existingMaterial instanceof GridMaterialProperty)) {\n      existingMaterial = new GridMaterialProperty();\n    }\n    materialData = packetData.grid;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"cellAlpha\",\n      materialData.cellAlpha,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"lineCount\",\n      materialData.lineCount,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"lineThickness\",\n      materialData.lineThickness,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"lineOffset\",\n      materialData.lineOffset,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.image)) {\n    if (!(existingMaterial instanceof ImageMaterialProperty)) {\n      existingMaterial = new ImageMaterialProperty();\n    }\n    materialData = packetData.image;\n    processPacketData(\n      Image,\n      existingMaterial,\n      \"image\",\n      materialData.image,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"repeat\",\n      materialData.repeat,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Boolean,\n      existingMaterial,\n      \"transparent\",\n      materialData.transparent,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.stripe)) {\n    if (!(existingMaterial instanceof StripeMaterialProperty)) {\n      existingMaterial = new StripeMaterialProperty();\n    }\n    materialData = packetData.stripe;\n    processPacketData(\n      StripeOrientation,\n      existingMaterial,\n      \"orientation\",\n      materialData.orientation,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"evenColor\",\n      materialData.evenColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"oddColor\",\n      materialData.oddColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"offset\",\n      materialData.offset,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"repeat\",\n      materialData.repeat,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.polylineOutline)) {\n    if (!(existingMaterial instanceof PolylineOutlineMaterialProperty)) {\n      existingMaterial = new PolylineOutlineMaterialProperty();\n    }\n    materialData = packetData.polylineOutline;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"outlineColor\",\n      materialData.outlineColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"outlineWidth\",\n      materialData.outlineWidth,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.polylineGlow)) {\n    if (!(existingMaterial instanceof PolylineGlowMaterialProperty)) {\n      existingMaterial = new PolylineGlowMaterialProperty();\n    }\n    materialData = packetData.polylineGlow;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"glowPower\",\n      materialData.glowPower,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"taperPower\",\n      materialData.taperPower,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.polylineArrow)) {\n    if (!(existingMaterial instanceof PolylineArrowMaterialProperty)) {\n      existingMaterial = new PolylineArrowMaterialProperty();\n    }\n    materialData = packetData.polylineArrow;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      undefined,\n      entityCollection\n    );\n  } else if (defined(packetData.polylineDash)) {\n    if (!(existingMaterial instanceof PolylineDashMaterialProperty)) {\n      existingMaterial = new PolylineDashMaterialProperty();\n    }\n    materialData = packetData.polylineDash;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      undefined,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"gapColor\",\n      materialData.gapColor,\n      undefined,\n      undefined,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"dashLength\",\n      materialData.dashLength,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"dashPattern\",\n      materialData.dashPattern,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.checkerboard)) {\n    if (!(existingMaterial instanceof CheckerboardMaterialProperty)) {\n      existingMaterial = new CheckerboardMaterialProperty();\n    }\n    materialData = packetData.checkerboard;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"evenColor\",\n      materialData.evenColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"oddColor\",\n      materialData.oddColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"repeat\",\n      materialData.repeat,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n\n  if (defined(existingInterval)) {\n    existingInterval.data = existingMaterial;\n  } else {\n    object[propertyName] = existingMaterial;\n  }\n}\n\nfunction processMaterialPacketData(\n  object,\n  propertyName,\n  packetData,\n  interval,\n  sourceUri,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processMaterialProperty(\n        object,\n        propertyName,\n        packetData[i],\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  } else {\n    processMaterialProperty(\n      object,\n      propertyName,\n      packetData,\n      interval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processName(entity, packet, entityCollection, sourceUri) {\n  var nameData = packet.name;\n  if (defined(nameData)) {\n    entity.name = packet.name;\n  }\n}\n\nfunction processDescription(entity, packet, entityCollection, sourceUri) {\n  var descriptionData = packet.description;\n  if (defined(descriptionData)) {\n    processPacketData(\n      String,\n      entity,\n      \"description\",\n      descriptionData,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processPosition(entity, packet, entityCollection, sourceUri) {\n  var positionData = packet.position;\n  if (defined(positionData)) {\n    processPositionPacketData(\n      entity,\n      \"position\",\n      positionData,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processViewFrom(entity, packet, entityCollection, sourceUri) {\n  var viewFromData = packet.viewFrom;\n  if (defined(viewFromData)) {\n    processPacketData(\n      Cartesian3,\n      entity,\n      \"viewFrom\",\n      viewFromData,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processOrientation(entity, packet, entityCollection, sourceUri) {\n  var orientationData = packet.orientation;\n  if (defined(orientationData)) {\n    processPacketData(\n      Quaternion,\n      entity,\n      \"orientation\",\n      orientationData,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processProperties(entity, packet, entityCollection, sourceUri) {\n  var propertiesData = packet.properties;\n  if (defined(propertiesData)) {\n    if (!defined(entity.properties)) {\n      entity.properties = new PropertyBag();\n    }\n\n    // We cannot simply call processPacketData(entity, 'properties', propertyData, undefined, sourceUri, entityCollection)\n    // because each property of \"properties\" may vary separately.\n    // The properties will be accessible as entity.properties.myprop.getValue(time).\n\n    for (var key in propertiesData) {\n      if (propertiesData.hasOwnProperty(key)) {\n        if (!entity.properties.hasProperty(key)) {\n          entity.properties.addProperty(key);\n        }\n\n        var propertyData = propertiesData[key];\n        if (Array.isArray(propertyData)) {\n          for (var i = 0, len = propertyData.length; i < len; ++i) {\n            processProperty(\n              getPropertyType(propertyData[i]),\n              entity.properties,\n              key,\n              propertyData[i],\n              undefined,\n              sourceUri,\n              entityCollection\n            );\n          }\n        } else {\n          processProperty(\n            getPropertyType(propertyData),\n            entity.properties,\n            key,\n            propertyData,\n            undefined,\n            sourceUri,\n            entityCollection\n          );\n        }\n      }\n    }\n  }\n}\n\nfunction processReferencesArrayPacketData(\n  object,\n  propertyName,\n  references,\n  interval,\n  entityCollection,\n  PropertyArrayType,\n  CompositePropertyArrayType\n) {\n  var properties = references.map(function (reference) {\n    return createReferenceProperty(entityCollection, reference);\n  });\n\n  if (defined(interval)) {\n    interval = intervalFromString(interval);\n    var property = object[propertyName];\n    if (!(property instanceof CompositePropertyArrayType)) {\n      // If the property was not already a CompositeProperty,\n      // create a CompositeProperty but preserve the existing data.\n\n      // Create the composite and add the old property, wrapped in an infinite interval.\n      var composite = new CompositePropertyArrayType();\n      composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n\n      object[propertyName] = property = composite;\n    }\n\n    interval.data = new PropertyArrayType(properties);\n    property.intervals.addInterval(interval);\n  } else {\n    object[propertyName] = new PropertyArrayType(properties);\n  }\n}\n\nfunction processArrayPacketData(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  var references = packetData.references;\n  if (defined(references)) {\n    processReferencesArrayPacketData(\n      object,\n      propertyName,\n      references,\n      packetData.interval,\n      entityCollection,\n      PropertyArray,\n      CompositeProperty\n    );\n  } else {\n    processPacketData(\n      Array,\n      object,\n      propertyName,\n      packetData,\n      undefined,\n      undefined,\n      entityCollection\n    );\n  }\n}\n\nfunction processArray(object, propertyName, packetData, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processArrayPacketData(\n        object,\n        propertyName,\n        packetData[i],\n        entityCollection\n      );\n    }\n  } else {\n    processArrayPacketData(object, propertyName, packetData, entityCollection);\n  }\n}\n\nfunction processPositionArrayPacketData(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  var references = packetData.references;\n  if (defined(references)) {\n    processReferencesArrayPacketData(\n      object,\n      propertyName,\n      references,\n      packetData.interval,\n      entityCollection,\n      PositionPropertyArray,\n      CompositePositionProperty\n    );\n  } else {\n    if (defined(packetData.cartesian)) {\n      packetData.array = Cartesian3.unpackArray(packetData.cartesian);\n    } else if (defined(packetData.cartographicRadians)) {\n      packetData.array = Cartesian3.fromRadiansArrayHeights(\n        packetData.cartographicRadians\n      );\n    } else if (defined(packetData.cartographicDegrees)) {\n      packetData.array = Cartesian3.fromDegreesArrayHeights(\n        packetData.cartographicDegrees\n      );\n    }\n\n    if (defined(packetData.array)) {\n      processPacketData(\n        Array,\n        object,\n        propertyName,\n        packetData,\n        undefined,\n        undefined,\n        entityCollection\n      );\n    }\n  }\n}\n\nfunction processPositionArray(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processPositionArrayPacketData(\n        object,\n        propertyName,\n        packetData[i],\n        entityCollection\n      );\n    }\n  } else {\n    processPositionArrayPacketData(\n      object,\n      propertyName,\n      packetData,\n      entityCollection\n    );\n  }\n}\n\nfunction unpackCartesianArray(array) {\n  return Cartesian3.unpackArray(array);\n}\n\nfunction unpackCartographicRadiansArray(array) {\n  return Cartesian3.fromRadiansArrayHeights(array);\n}\n\nfunction unpackCartographicDegreesArray(array) {\n  return Cartesian3.fromDegreesArrayHeights(array);\n}\n\nfunction processPositionArrayOfArraysPacketData(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  var references = packetData.references;\n  if (defined(references)) {\n    var properties = references.map(function (referenceArray) {\n      var tempObj = {};\n      processReferencesArrayPacketData(\n        tempObj,\n        \"positions\",\n        referenceArray,\n        packetData.interval,\n        entityCollection,\n        PositionPropertyArray,\n        CompositePositionProperty\n      );\n      return tempObj.positions;\n    });\n    object[propertyName] = new PositionPropertyArray(properties);\n  } else {\n    if (defined(packetData.cartesian)) {\n      packetData.array = packetData.cartesian.map(unpackCartesianArray);\n    } else if (defined(packetData.cartographicRadians)) {\n      packetData.array = packetData.cartographicRadians.map(\n        unpackCartographicRadiansArray\n      );\n    } else if (defined(packetData.cartographicDegrees)) {\n      packetData.array = packetData.cartographicDegrees.map(\n        unpackCartographicDegreesArray\n      );\n    }\n\n    if (defined(packetData.array)) {\n      processPacketData(\n        Array,\n        object,\n        propertyName,\n        packetData,\n        undefined,\n        undefined,\n        entityCollection\n      );\n    }\n  }\n}\n\nfunction processPositionArrayOfArrays(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processPositionArrayOfArraysPacketData(\n        object,\n        propertyName,\n        packetData[i],\n        entityCollection\n      );\n    }\n  } else {\n    processPositionArrayOfArraysPacketData(\n      object,\n      propertyName,\n      packetData,\n      entityCollection\n    );\n  }\n}\n\nfunction processAvailability(entity, packet, entityCollection, sourceUri) {\n  var packetData = packet.availability;\n  if (!defined(packetData)) {\n    return;\n  }\n\n  var intervals;\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      if (!defined(intervals)) {\n        intervals = new TimeIntervalCollection();\n      }\n      intervals.addInterval(intervalFromString(packetData[i]));\n    }\n  } else {\n    intervals = new TimeIntervalCollection();\n    intervals.addInterval(intervalFromString(packetData));\n  }\n  entity.availability = intervals;\n}\n\nfunction processAlignedAxis(\n  billboard,\n  packetData,\n  interval,\n  sourceUri,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  processPacketData(\n    UnitCartesian3,\n    billboard,\n    \"alignedAxis\",\n    packetData,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processBillboard(entity, packet, entityCollection, sourceUri) {\n  var billboardData = packet.billboard;\n  if (!defined(billboardData)) {\n    return;\n  }\n\n  var interval = intervalFromString(billboardData.interval);\n  var billboard = entity.billboard;\n  if (!defined(billboard)) {\n    entity.billboard = billboard = new BillboardGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    billboard,\n    \"show\",\n    billboardData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Image,\n    billboard,\n    \"image\",\n    billboardData.image,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    billboard,\n    \"scale\",\n    billboardData.scale,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian2,\n    billboard,\n    \"pixelOffset\",\n    billboardData.pixelOffset,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    billboard,\n    \"eyeOffset\",\n    billboardData.eyeOffset,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HorizontalOrigin,\n    billboard,\n    \"horizontalOrigin\",\n    billboardData.horizontalOrigin,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    VerticalOrigin,\n    billboard,\n    \"verticalOrigin\",\n    billboardData.verticalOrigin,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    billboard,\n    \"heightReference\",\n    billboardData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    billboard,\n    \"color\",\n    billboardData.color,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    billboard,\n    \"rotation\",\n    billboardData.rotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processAlignedAxis(\n    billboard,\n    billboardData.alignedAxis,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    billboard,\n    \"sizeInMeters\",\n    billboardData.sizeInMeters,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    billboard,\n    \"width\",\n    billboardData.width,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    billboard,\n    \"height\",\n    billboardData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    billboard,\n    \"scaleByDistance\",\n    billboardData.scaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    billboard,\n    \"translucencyByDistance\",\n    billboardData.translucencyByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    billboard,\n    \"pixelOffsetScaleByDistance\",\n    billboardData.pixelOffsetScaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    BoundingRectangle,\n    billboard,\n    \"imageSubRegion\",\n    billboardData.imageSubRegion,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    billboard,\n    \"distanceDisplayCondition\",\n    billboardData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    billboard,\n    \"disableDepthTestDistance\",\n    billboardData.disableDepthTestDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processBox(entity, packet, entityCollection, sourceUri) {\n  var boxData = packet.box;\n  if (!defined(boxData)) {\n    return;\n  }\n\n  var interval = intervalFromString(boxData.interval);\n  var box = entity.box;\n  if (!defined(box)) {\n    entity.box = box = new BoxGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    box,\n    \"show\",\n    boxData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    box,\n    \"dimensions\",\n    boxData.dimensions,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    box,\n    \"heightReference\",\n    boxData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    box,\n    \"fill\",\n    boxData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    box,\n    \"material\",\n    boxData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    box,\n    \"outline\",\n    boxData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    box,\n    \"outlineColor\",\n    boxData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    box,\n    \"outlineWidth\",\n    boxData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    box,\n    \"shadows\",\n    boxData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    box,\n    \"distanceDisplayCondition\",\n    boxData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processCorridor(entity, packet, entityCollection, sourceUri) {\n  var corridorData = packet.corridor;\n  if (!defined(corridorData)) {\n    return;\n  }\n\n  var interval = intervalFromString(corridorData.interval);\n  var corridor = entity.corridor;\n  if (!defined(corridor)) {\n    entity.corridor = corridor = new CorridorGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    corridor,\n    \"show\",\n    corridorData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPositionArray(\n    corridor,\n    \"positions\",\n    corridorData.positions,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"width\",\n    corridorData.width,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"height\",\n    corridorData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    corridor,\n    \"heightReference\",\n    corridorData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"extrudedHeight\",\n    corridorData.extrudedHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    corridor,\n    \"extrudedHeightReference\",\n    corridorData.extrudedHeightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    CornerType,\n    corridor,\n    \"cornerType\",\n    corridorData.cornerType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"granularity\",\n    corridorData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    corridor,\n    \"fill\",\n    corridorData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    corridor,\n    \"material\",\n    corridorData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    corridor,\n    \"outline\",\n    corridorData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    corridor,\n    \"outlineColor\",\n    corridorData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"outlineWidth\",\n    corridorData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    corridor,\n    \"shadows\",\n    corridorData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    corridor,\n    \"distanceDisplayCondition\",\n    corridorData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    corridor,\n    \"classificationType\",\n    corridorData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"zIndex\",\n    corridorData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processCylinder(entity, packet, entityCollection, sourceUri) {\n  var cylinderData = packet.cylinder;\n  if (!defined(cylinderData)) {\n    return;\n  }\n\n  var interval = intervalFromString(cylinderData.interval);\n  var cylinder = entity.cylinder;\n  if (!defined(cylinder)) {\n    entity.cylinder = cylinder = new CylinderGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    cylinder,\n    \"show\",\n    cylinderData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"length\",\n    cylinderData.length,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"topRadius\",\n    cylinderData.topRadius,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"bottomRadius\",\n    cylinderData.bottomRadius,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    cylinder,\n    \"heightReference\",\n    cylinderData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    cylinder,\n    \"fill\",\n    cylinderData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    cylinder,\n    \"material\",\n    cylinderData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    cylinder,\n    \"outline\",\n    cylinderData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    cylinder,\n    \"outlineColor\",\n    cylinderData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"outlineWidth\",\n    cylinderData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"numberOfVerticalLines\",\n    cylinderData.numberOfVerticalLines,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"slices\",\n    cylinderData.slices,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    cylinder,\n    \"shadows\",\n    cylinderData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    cylinder,\n    \"distanceDisplayCondition\",\n    cylinderData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processDocument(packet, dataSource) {\n  var version = packet.version;\n  if (defined(version)) {\n    if (typeof version === \"string\") {\n      var tokens = version.split(\".\");\n      if (tokens.length === 2) {\n        if (tokens[0] !== \"1\") {\n          throw new RuntimeError(\"Cesium only supports CZML version 1.\");\n        }\n        dataSource._version = version;\n      }\n    }\n  }\n\n  if (!defined(dataSource._version)) {\n    throw new RuntimeError(\n      \"CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.\"\n    );\n  }\n\n  var documentPacket = dataSource._documentPacket;\n\n  if (defined(packet.name)) {\n    documentPacket.name = packet.name;\n  }\n\n  var clockPacket = packet.clock;\n  if (defined(clockPacket)) {\n    var clock = documentPacket.clock;\n    if (!defined(clock)) {\n      documentPacket.clock = {\n        interval: clockPacket.interval,\n        currentTime: clockPacket.currentTime,\n        range: clockPacket.range,\n        step: clockPacket.step,\n        multiplier: clockPacket.multiplier,\n      };\n    } else {\n      clock.interval = defaultValue(clockPacket.interval, clock.interval);\n      clock.currentTime = defaultValue(\n        clockPacket.currentTime,\n        clock.currentTime\n      );\n      clock.range = defaultValue(clockPacket.range, clock.range);\n      clock.step = defaultValue(clockPacket.step, clock.step);\n      clock.multiplier = defaultValue(clockPacket.multiplier, clock.multiplier);\n    }\n  }\n}\n\nfunction processEllipse(entity, packet, entityCollection, sourceUri) {\n  var ellipseData = packet.ellipse;\n  if (!defined(ellipseData)) {\n    return;\n  }\n\n  var interval = intervalFromString(ellipseData.interval);\n  var ellipse = entity.ellipse;\n  if (!defined(ellipse)) {\n    entity.ellipse = ellipse = new EllipseGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    ellipse,\n    \"show\",\n    ellipseData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"semiMajorAxis\",\n    ellipseData.semiMajorAxis,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"semiMinorAxis\",\n    ellipseData.semiMinorAxis,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"height\",\n    ellipseData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    ellipse,\n    \"heightReference\",\n    ellipseData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"extrudedHeight\",\n    ellipseData.extrudedHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    ellipse,\n    \"extrudedHeightReference\",\n    ellipseData.extrudedHeightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    ellipse,\n    \"rotation\",\n    ellipseData.rotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    ellipse,\n    \"stRotation\",\n    ellipseData.stRotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"granularity\",\n    ellipseData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    ellipse,\n    \"fill\",\n    ellipseData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    ellipse,\n    \"material\",\n    ellipseData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    ellipse,\n    \"outline\",\n    ellipseData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    ellipse,\n    \"outlineColor\",\n    ellipseData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"outlineWidth\",\n    ellipseData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"numberOfVerticalLines\",\n    ellipseData.numberOfVerticalLines,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    ellipse,\n    \"shadows\",\n    ellipseData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    ellipse,\n    \"distanceDisplayCondition\",\n    ellipseData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    ellipse,\n    \"classificationType\",\n    ellipseData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"zIndex\",\n    ellipseData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processEllipsoid(entity, packet, entityCollection, sourceUri) {\n  var ellipsoidData = packet.ellipsoid;\n  if (!defined(ellipsoidData)) {\n    return;\n  }\n\n  var interval = intervalFromString(ellipsoidData.interval);\n  var ellipsoid = entity.ellipsoid;\n  if (!defined(ellipsoid)) {\n    entity.ellipsoid = ellipsoid = new EllipsoidGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    ellipsoid,\n    \"show\",\n    ellipsoidData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    ellipsoid,\n    \"radii\",\n    ellipsoidData.radii,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    ellipsoid,\n    \"innerRadii\",\n    ellipsoidData.innerRadii,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"minimumClock\",\n    ellipsoidData.minimumClock,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"maximumClock\",\n    ellipsoidData.maximumClock,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"minimumCone\",\n    ellipsoidData.minimumCone,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"maximumCone\",\n    ellipsoidData.maximumCone,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    ellipsoid,\n    \"heightReference\",\n    ellipsoidData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    ellipsoid,\n    \"fill\",\n    ellipsoidData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    ellipsoid,\n    \"material\",\n    ellipsoidData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    ellipsoid,\n    \"outline\",\n    ellipsoidData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    ellipsoid,\n    \"outlineColor\",\n    ellipsoidData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"outlineWidth\",\n    ellipsoidData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"stackPartitions\",\n    ellipsoidData.stackPartitions,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"slicePartitions\",\n    ellipsoidData.slicePartitions,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"subdivisions\",\n    ellipsoidData.subdivisions,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    ellipsoid,\n    \"shadows\",\n    ellipsoidData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    ellipsoid,\n    \"distanceDisplayCondition\",\n    ellipsoidData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processLabel(entity, packet, entityCollection, sourceUri) {\n  var labelData = packet.label;\n  if (!defined(labelData)) {\n    return;\n  }\n\n  var interval = intervalFromString(labelData.interval);\n  var label = entity.label;\n  if (!defined(label)) {\n    entity.label = label = new LabelGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    label,\n    \"show\",\n    labelData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    String,\n    label,\n    \"text\",\n    labelData.text,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    String,\n    label,\n    \"font\",\n    labelData.font,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    LabelStyle,\n    label,\n    \"style\",\n    labelData.style,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    label,\n    \"scale\",\n    labelData.scale,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    label,\n    \"showBackground\",\n    labelData.showBackground,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    label,\n    \"backgroundColor\",\n    labelData.backgroundColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian2,\n    label,\n    \"backgroundPadding\",\n    labelData.backgroundPadding,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian2,\n    label,\n    \"pixelOffset\",\n    labelData.pixelOffset,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    label,\n    \"eyeOffset\",\n    labelData.eyeOffset,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HorizontalOrigin,\n    label,\n    \"horizontalOrigin\",\n    labelData.horizontalOrigin,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    VerticalOrigin,\n    label,\n    \"verticalOrigin\",\n    labelData.verticalOrigin,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    label,\n    \"heightReference\",\n    labelData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    label,\n    \"fillColor\",\n    labelData.fillColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    label,\n    \"outlineColor\",\n    labelData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    label,\n    \"outlineWidth\",\n    labelData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    label,\n    \"translucencyByDistance\",\n    labelData.translucencyByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    label,\n    \"pixelOffsetScaleByDistance\",\n    labelData.pixelOffsetScaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    label,\n    \"scaleByDistance\",\n    labelData.scaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    label,\n    \"distanceDisplayCondition\",\n    labelData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    label,\n    \"disableDepthTestDistance\",\n    labelData.disableDepthTestDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processModel(entity, packet, entityCollection, sourceUri) {\n  var modelData = packet.model;\n  if (!defined(modelData)) {\n    return;\n  }\n\n  var interval = intervalFromString(modelData.interval);\n  var model = entity.model;\n  if (!defined(model)) {\n    entity.model = model = new ModelGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    model,\n    \"show\",\n    modelData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Uri,\n    model,\n    \"uri\",\n    modelData.gltf,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"scale\",\n    modelData.scale,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"minimumPixelSize\",\n    modelData.minimumPixelSize,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"maximumScale\",\n    modelData.maximumScale,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    model,\n    \"incrementallyLoadTextures\",\n    modelData.incrementallyLoadTextures,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    model,\n    \"runAnimations\",\n    modelData.runAnimations,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    model,\n    \"clampAnimations\",\n    modelData.clampAnimations,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    model,\n    \"shadows\",\n    modelData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    model,\n    \"heightReference\",\n    modelData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    model,\n    \"silhouetteColor\",\n    modelData.silhouetteColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"silhouetteSize\",\n    modelData.silhouetteSize,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    model,\n    \"color\",\n    modelData.color,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ColorBlendMode,\n    model,\n    \"colorBlendMode\",\n    modelData.colorBlendMode,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"colorBlendAmount\",\n    modelData.colorBlendAmount,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    model,\n    \"distanceDisplayCondition\",\n    modelData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n\n  var i, len;\n  var nodeTransformationsData = modelData.nodeTransformations;\n  if (defined(nodeTransformationsData)) {\n    if (Array.isArray(nodeTransformationsData)) {\n      for (i = 0, len = nodeTransformationsData.length; i < len; ++i) {\n        processNodeTransformations(\n          model,\n          nodeTransformationsData[i],\n          interval,\n          sourceUri,\n          entityCollection\n        );\n      }\n    } else {\n      processNodeTransformations(\n        model,\n        nodeTransformationsData,\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  }\n\n  var articulationsData = modelData.articulations;\n  if (defined(articulationsData)) {\n    if (Array.isArray(articulationsData)) {\n      for (i = 0, len = articulationsData.length; i < len; ++i) {\n        processArticulations(\n          model,\n          articulationsData[i],\n          interval,\n          sourceUri,\n          entityCollection\n        );\n      }\n    } else {\n      processArticulations(\n        model,\n        articulationsData,\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  }\n}\n\nfunction processNodeTransformations(\n  model,\n  nodeTransformationsData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(nodeTransformationsData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var nodeTransformations = model.nodeTransformations;\n  var nodeNames = Object.keys(nodeTransformationsData);\n  for (var i = 0, len = nodeNames.length; i < len; ++i) {\n    var nodeName = nodeNames[i];\n    if (nodeName === \"interval\") {\n      continue;\n    }\n\n    var nodeTransformationData = nodeTransformationsData[nodeName];\n    if (!defined(nodeTransformationData)) {\n      continue;\n    }\n\n    if (!defined(nodeTransformations)) {\n      model.nodeTransformations = nodeTransformations = new PropertyBag();\n    }\n\n    if (!nodeTransformations.hasProperty(nodeName)) {\n      nodeTransformations.addProperty(nodeName);\n    }\n\n    var nodeTransformation = nodeTransformations[nodeName];\n    if (!defined(nodeTransformation)) {\n      nodeTransformations[\n        nodeName\n      ] = nodeTransformation = new NodeTransformationProperty();\n    }\n\n    processPacketData(\n      Cartesian3,\n      nodeTransformation,\n      \"translation\",\n      nodeTransformationData.translation,\n      combinedInterval,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Quaternion,\n      nodeTransformation,\n      \"rotation\",\n      nodeTransformationData.rotation,\n      combinedInterval,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian3,\n      nodeTransformation,\n      \"scale\",\n      nodeTransformationData.scale,\n      combinedInterval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processArticulations(\n  model,\n  articulationsData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(articulationsData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var articulations = model.articulations;\n  var keys = Object.keys(articulationsData);\n  for (var i = 0, len = keys.length; i < len; ++i) {\n    var key = keys[i];\n    if (key === \"interval\") {\n      continue;\n    }\n\n    var articulationStageData = articulationsData[key];\n    if (!defined(articulationStageData)) {\n      continue;\n    }\n\n    if (!defined(articulations)) {\n      model.articulations = articulations = new PropertyBag();\n    }\n\n    if (!articulations.hasProperty(key)) {\n      articulations.addProperty(key);\n    }\n\n    processPacketData(\n      Number,\n      articulations,\n      key,\n      articulationStageData,\n      combinedInterval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processPath(entity, packet, entityCollection, sourceUri) {\n  var pathData = packet.path;\n  if (!defined(pathData)) {\n    return;\n  }\n\n  var interval = intervalFromString(pathData.interval);\n  var path = entity.path;\n  if (!defined(path)) {\n    entity.path = path = new PathGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    path,\n    \"show\",\n    pathData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    path,\n    \"leadTime\",\n    pathData.leadTime,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    path,\n    \"trailTime\",\n    pathData.trailTime,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    path,\n    \"width\",\n    pathData.width,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    path,\n    \"resolution\",\n    pathData.resolution,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    path,\n    \"material\",\n    pathData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    path,\n    \"distanceDisplayCondition\",\n    pathData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processPoint(entity, packet, entityCollection, sourceUri) {\n  var pointData = packet.point;\n  if (!defined(pointData)) {\n    return;\n  }\n\n  var interval = intervalFromString(pointData.interval);\n  var point = entity.point;\n  if (!defined(point)) {\n    entity.point = point = new PointGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    point,\n    \"show\",\n    pointData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    point,\n    \"pixelSize\",\n    pointData.pixelSize,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    point,\n    \"heightReference\",\n    pointData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    point,\n    \"color\",\n    pointData.color,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    point,\n    \"outlineColor\",\n    pointData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    point,\n    \"outlineWidth\",\n    pointData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    point,\n    \"scaleByDistance\",\n    pointData.scaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    point,\n    \"translucencyByDistance\",\n    pointData.translucencyByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    point,\n    \"distanceDisplayCondition\",\n    pointData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    point,\n    \"disableDepthTestDistance\",\n    pointData.disableDepthTestDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction PolygonHierarchyProperty(polygon) {\n  this.polygon = polygon;\n  this._definitionChanged = new Event();\n}\n\nObject.defineProperties(PolygonHierarchyProperty.prototype, {\n  isConstant: {\n    get: function () {\n      var positions = this.polygon._positions;\n      var holes = this.polygon._holes;\n      return (\n        (!defined(positions) || positions.isConstant) &&\n        (!defined(holes) || holes.isConstant)\n      );\n    },\n  },\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n});\n\nPolygonHierarchyProperty.prototype.getValue = function (time, result) {\n  var positions;\n  if (defined(this.polygon._positions)) {\n    positions = this.polygon._positions.getValue(time);\n  }\n\n  var holes;\n  if (defined(this.polygon._holes)) {\n    holes = this.polygon._holes.getValue(time);\n    if (defined(holes)) {\n      holes = holes.map(function (holePositions) {\n        return new PolygonHierarchy(holePositions);\n      });\n    }\n  }\n\n  if (!defined(result)) {\n    return new PolygonHierarchy(positions, holes);\n  }\n\n  result.positions = positions;\n  result.holes = holes;\n  return result;\n};\n\nPolygonHierarchyProperty.prototype.equals = function (other) {\n  return (\n    this === other ||\n    (other instanceof PolygonHierarchyProperty &&\n      Property.equals(this.polygon._positions, other.polygon._positions) &&\n      Property.equals(this.polygon._holes, other.polygon._holes))\n  );\n};\n\nfunction processPolygon(entity, packet, entityCollection, sourceUri) {\n  var polygonData = packet.polygon;\n  if (!defined(polygonData)) {\n    return;\n  }\n\n  var interval = intervalFromString(polygonData.interval);\n  var polygon = entity.polygon;\n  if (!defined(polygon)) {\n    entity.polygon = polygon = new PolygonGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    polygon,\n    \"show\",\n    polygonData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n\n  // adapt 'position' property producing Cartesian[]\n  // and 'holes' property producing Cartesian[][]\n  // to a single property producing PolygonHierarchy\n  processPositionArray(\n    polygon,\n    \"_positions\",\n    polygonData.positions,\n    entityCollection\n  );\n  processPositionArrayOfArrays(\n    polygon,\n    \"_holes\",\n    polygonData.holes,\n    entityCollection\n  );\n  if (defined(polygon._positions) || defined(polygon._holes)) {\n    polygon.hierarchy = new PolygonHierarchyProperty(polygon);\n  }\n\n  processPacketData(\n    Number,\n    polygon,\n    \"height\",\n    polygonData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    polygon,\n    \"heightReference\",\n    polygonData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polygon,\n    \"extrudedHeight\",\n    polygonData.extrudedHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    polygon,\n    \"extrudedHeightReference\",\n    polygonData.extrudedHeightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    polygon,\n    \"stRotation\",\n    polygonData.stRotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polygon,\n    \"granularity\",\n    polygonData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"fill\",\n    polygonData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    polygon,\n    \"material\",\n    polygonData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"outline\",\n    polygonData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    polygon,\n    \"outlineColor\",\n    polygonData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polygon,\n    \"outlineWidth\",\n    polygonData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"perPositionHeight\",\n    polygonData.perPositionHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"closeTop\",\n    polygonData.closeTop,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"closeBottom\",\n    polygonData.closeBottom,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ArcType,\n    polygon,\n    \"arcType\",\n    polygonData.arcType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    polygon,\n    \"shadows\",\n    polygonData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    polygon,\n    \"distanceDisplayCondition\",\n    polygonData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    polygon,\n    \"classificationType\",\n    polygonData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polygon,\n    \"zIndex\",\n    polygonData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction adaptFollowSurfaceToArcType(followSurface) {\n  return followSurface ? ArcType.GEODESIC : ArcType.NONE;\n}\n\nfunction processPolyline(entity, packet, entityCollection, sourceUri) {\n  var polylineData = packet.polyline;\n  if (!defined(polylineData)) {\n    return;\n  }\n\n  var interval = intervalFromString(polylineData.interval);\n  var polyline = entity.polyline;\n  if (!defined(polyline)) {\n    entity.polyline = polyline = new PolylineGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    polyline,\n    \"show\",\n    polylineData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPositionArray(\n    polyline,\n    \"positions\",\n    polylineData.positions,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polyline,\n    \"width\",\n    polylineData.width,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polyline,\n    \"granularity\",\n    polylineData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    polyline,\n    \"material\",\n    polylineData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    polyline,\n    \"depthFailMaterial\",\n    polylineData.depthFailMaterial,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ArcType,\n    polyline,\n    \"arcType\",\n    polylineData.arcType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polyline,\n    \"clampToGround\",\n    polylineData.clampToGround,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    polyline,\n    \"shadows\",\n    polylineData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    polyline,\n    \"distanceDisplayCondition\",\n    polylineData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    polyline,\n    \"classificationType\",\n    polylineData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polyline,\n    \"zIndex\",\n    polylineData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n\n  // for backwards compatibility, adapt CZML followSurface to arcType.\n  if (defined(polylineData.followSurface) && !defined(polylineData.arcType)) {\n    var tempObj = {};\n    processPacketData(\n      Boolean,\n      tempObj,\n      \"followSurface\",\n      polylineData.followSurface,\n      interval,\n      sourceUri,\n      entityCollection\n    );\n    polyline.arcType = createAdapterProperty(\n      tempObj.followSurface,\n      adaptFollowSurfaceToArcType\n    );\n  }\n}\n\nfunction processRectangle(entity, packet, entityCollection, sourceUri) {\n  var rectangleData = packet.rectangle;\n  if (!defined(rectangleData)) {\n    return;\n  }\n\n  var interval = intervalFromString(rectangleData.interval);\n  var rectangle = entity.rectangle;\n  if (!defined(rectangle)) {\n    entity.rectangle = rectangle = new RectangleGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    rectangle,\n    \"show\",\n    rectangleData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rectangle,\n    rectangle,\n    \"coordinates\",\n    rectangleData.coordinates,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"height\",\n    rectangleData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    rectangle,\n    \"heightReference\",\n    rectangleData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"extrudedHeight\",\n    rectangleData.extrudedHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    rectangle,\n    \"extrudedHeightReference\",\n    rectangleData.extrudedHeightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    rectangle,\n    \"rotation\",\n    rectangleData.rotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    rectangle,\n    \"stRotation\",\n    rectangleData.stRotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"granularity\",\n    rectangleData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    rectangle,\n    \"fill\",\n    rectangleData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    rectangle,\n    \"material\",\n    rectangleData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    rectangle,\n    \"outline\",\n    rectangleData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    rectangle,\n    \"outlineColor\",\n    rectangleData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"outlineWidth\",\n    rectangleData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    rectangle,\n    \"shadows\",\n    rectangleData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    rectangle,\n    \"distanceDisplayCondition\",\n    rectangleData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    rectangle,\n    \"classificationType\",\n    rectangleData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"zIndex\",\n    rectangleData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processTileset(entity, packet, entityCollection, sourceUri) {\n  var tilesetData = packet.tileset;\n  if (!defined(tilesetData)) {\n    return;\n  }\n\n  var interval = intervalFromString(tilesetData.interval);\n  var tileset = entity.tileset;\n  if (!defined(tileset)) {\n    entity.tileset = tileset = new Cesium3DTilesetGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    tileset,\n    \"show\",\n    tilesetData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Uri,\n    tileset,\n    \"uri\",\n    tilesetData.uri,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    tileset,\n    \"maximumScreenSpaceError\",\n    tilesetData.maximumScreenSpaceError,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processWall(entity, packet, entityCollection, sourceUri) {\n  var wallData = packet.wall;\n  if (!defined(wallData)) {\n    return;\n  }\n\n  var interval = intervalFromString(wallData.interval);\n  var wall = entity.wall;\n  if (!defined(wall)) {\n    entity.wall = wall = new WallGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    wall,\n    \"show\",\n    wallData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPositionArray(wall, \"positions\", wallData.positions, entityCollection);\n  processArray(\n    wall,\n    \"minimumHeights\",\n    wallData.minimumHeights,\n    entityCollection\n  );\n  processArray(\n    wall,\n    \"maximumHeights\",\n    wallData.maximumHeights,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    wall,\n    \"granularity\",\n    wallData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    wall,\n    \"fill\",\n    wallData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    wall,\n    \"material\",\n    wallData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    wall,\n    \"outline\",\n    wallData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    wall,\n    \"outlineColor\",\n    wallData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    wall,\n    \"outlineWidth\",\n    wallData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    wall,\n    \"shadows\",\n    wallData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    wall,\n    \"distanceDisplayCondition\",\n    wallData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processCzmlPacket(\n  packet,\n  entityCollection,\n  updaterFunctions,\n  sourceUri,\n  dataSource\n) {\n  var objectId = packet.id;\n  if (!defined(objectId)) {\n    objectId = createGuid();\n  }\n\n  currentId = objectId;\n\n  if (!defined(dataSource._version) && objectId !== \"document\") {\n    throw new RuntimeError(\n      \"The first CZML packet is required to be the document object.\"\n    );\n  }\n\n  if (packet[\"delete\"] === true) {\n    entityCollection.removeById(objectId);\n  } else if (objectId === \"document\") {\n    processDocument(packet, dataSource);\n  } else {\n    var entity = entityCollection.getOrCreateEntity(objectId);\n\n    var parentId = packet.parent;\n    if (defined(parentId)) {\n      entity.parent = entityCollection.getOrCreateEntity(parentId);\n    }\n\n    for (var i = updaterFunctions.length - 1; i > -1; i--) {\n      updaterFunctions[i](entity, packet, entityCollection, sourceUri);\n    }\n  }\n\n  currentId = undefined;\n}\n\nfunction updateClock(dataSource) {\n  var clock;\n  var clockPacket = dataSource._documentPacket.clock;\n  if (!defined(clockPacket)) {\n    if (!defined(dataSource._clock)) {\n      var availability = dataSource._entityCollection.computeAvailability();\n      if (!availability.start.equals(Iso8601.MINIMUM_VALUE)) {\n        var startTime = availability.start;\n        var stopTime = availability.stop;\n        var totalSeconds = JulianDate.secondsDifference(stopTime, startTime);\n        var multiplier = Math.round(totalSeconds / 120.0);\n\n        clock = new DataSourceClock();\n        clock.startTime = JulianDate.clone(startTime);\n        clock.stopTime = JulianDate.clone(stopTime);\n        clock.clockRange = ClockRange.LOOP_STOP;\n        clock.multiplier = multiplier;\n        clock.currentTime = JulianDate.clone(startTime);\n        clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n        dataSource._clock = clock;\n        return true;\n      }\n    }\n    return false;\n  }\n\n  if (defined(dataSource._clock)) {\n    clock = dataSource._clock.clone();\n  } else {\n    clock = new DataSourceClock();\n    clock.startTime = Iso8601.MINIMUM_VALUE.clone();\n    clock.stopTime = Iso8601.MAXIMUM_VALUE.clone();\n    clock.currentTime = Iso8601.MINIMUM_VALUE.clone();\n    clock.clockRange = ClockRange.LOOP_STOP;\n    clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n    clock.multiplier = 1.0;\n  }\n\n  var interval = intervalFromString(clockPacket.interval);\n  if (defined(interval)) {\n    clock.startTime = interval.start;\n    clock.stopTime = interval.stop;\n  }\n\n  if (defined(clockPacket.currentTime)) {\n    clock.currentTime = JulianDate.fromIso8601(clockPacket.currentTime);\n  }\n  if (defined(clockPacket.range)) {\n    clock.clockRange = defaultValue(\n      ClockRange[clockPacket.range],\n      ClockRange.LOOP_STOP\n    );\n  }\n  if (defined(clockPacket.step)) {\n    clock.clockStep = defaultValue(\n      ClockStep[clockPacket.step],\n      ClockStep.SYSTEM_CLOCK_MULTIPLIER\n    );\n  }\n  if (defined(clockPacket.multiplier)) {\n    clock.multiplier = clockPacket.multiplier;\n  }\n\n  if (!clock.equals(dataSource._clock)) {\n    dataSource._clock = clock.clone(dataSource._clock);\n    return true;\n  }\n\n  return false;\n}\n\nfunction load(dataSource, czml, options, clear) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(czml)) {\n    throw new DeveloperError(\"czml is required.\");\n  }\n  //>>includeEnd('debug');\n\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  var promise = czml;\n  var sourceUri = options.sourceUri;\n\n  // User specified credit\n  var credit = options.credit;\n  if (typeof credit === \"string\") {\n    credit = new Credit(credit);\n  }\n  dataSource._credit = credit;\n\n  // If the czml is a URL\n  if (typeof czml === \"string\" || czml instanceof Resource) {\n    czml = Resource.createIfNeeded(czml);\n    promise = czml.fetchJson();\n    sourceUri = defaultValue(sourceUri, czml.clone());\n\n    // Add resource credits to our list of credits to display\n    var resourceCredits = dataSource._resourceCredits;\n    var credits = czml.credits;\n    if (defined(credits)) {\n      var length = credits.length;\n      for (var i = 0; i < length; i++) {\n        resourceCredits.push(credits[i]);\n      }\n    }\n  }\n\n  sourceUri = Resource.createIfNeeded(sourceUri);\n\n  DataSource.setLoading(dataSource, true);\n\n  return when(promise, function (czml) {\n    return loadCzml(dataSource, czml, sourceUri, clear);\n  }).otherwise(function (error) {\n    DataSource.setLoading(dataSource, false);\n    dataSource._error.raiseEvent(dataSource, error);\n    console.log(error);\n    return when.reject(error);\n  });\n}\n\nfunction loadCzml(dataSource, czml, sourceUri, clear) {\n  DataSource.setLoading(dataSource, true);\n  var entityCollection = dataSource._entityCollection;\n\n  if (clear) {\n    dataSource._version = undefined;\n    dataSource._documentPacket = new DocumentPacket();\n    entityCollection.removeAll();\n  }\n\n  CzmlDataSource._processCzml(\n    czml,\n    entityCollection,\n    sourceUri,\n    undefined,\n    dataSource\n  );\n\n  var raiseChangedEvent = updateClock(dataSource);\n\n  var documentPacket = dataSource._documentPacket;\n  if (\n    defined(documentPacket.name) &&\n    dataSource._name !== documentPacket.name\n  ) {\n    dataSource._name = documentPacket.name;\n    raiseChangedEvent = true;\n  } else if (!defined(dataSource._name) && defined(sourceUri)) {\n    dataSource._name = getFilenameFromUri(sourceUri.getUrlComponent());\n    raiseChangedEvent = true;\n  }\n\n  DataSource.setLoading(dataSource, false);\n  if (raiseChangedEvent) {\n    dataSource._changed.raiseEvent(dataSource);\n  }\n\n  return dataSource;\n}\n\nfunction DocumentPacket() {\n  this.name = undefined;\n  this.clock = undefined;\n}\n\n/**\n * A {@link DataSource} which processes {@link https://github.com/AnalyticalGraphicsInc/czml-writer/wiki/CZML-Guide|CZML}.\n * @alias CzmlDataSource\n * @constructor\n *\n * @param {String} [name] An optional name for the data source.  This value will be overwritten if a loaded document contains a name.\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=CZML.html|Cesium Sandcastle CZML Demo}\n */\nfunction CzmlDataSource(name) {\n  this._name = name;\n  this._changed = new Event();\n  this._error = new Event();\n  this._isLoading = false;\n  this._loading = new Event();\n  this._clock = undefined;\n  this._documentPacket = new DocumentPacket();\n  this._version = undefined;\n  this._entityCollection = new EntityCollection(this);\n  this._entityCluster = new EntityCluster();\n  this._credit = undefined;\n  this._resourceCredits = [];\n}\n\n/**\n * Creates a Promise to a new instance loaded with the provided CZML data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {Object} [options] An object with the following properties:\n * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links.\n * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to the new instance once the data is processed.\n */\nCzmlDataSource.load = function (czml, options) {\n  return new CzmlDataSource().load(czml, options);\n};\n\nObject.defineProperties(CzmlDataSource.prototype, {\n  /**\n   * Gets a human-readable name for this instance.\n   * @memberof CzmlDataSource.prototype\n   * @type {String}\n   */\n  name: {\n    get: function () {\n      return this._name;\n    },\n  },\n  /**\n   * Gets the clock settings defined by the loaded CZML.  If no clock is explicitly\n   * defined in the CZML, the combined availability of all objects is returned.  If\n   * only static data exists, this value is undefined.\n   * @memberof CzmlDataSource.prototype\n   * @type {DataSourceClock}\n   */\n  clock: {\n    get: function () {\n      return this._clock;\n    },\n  },\n  /**\n   * Gets the collection of {@link Entity} instances.\n   * @memberof CzmlDataSource.prototype\n   * @type {EntityCollection}\n   */\n  entities: {\n    get: function () {\n      return this._entityCollection;\n    },\n  },\n  /**\n   * Gets a value indicating if the data source is currently loading data.\n   * @memberof CzmlDataSource.prototype\n   * @type {Boolean}\n   */\n  isLoading: {\n    get: function () {\n      return this._isLoading;\n    },\n  },\n  /**\n   * Gets an event that will be raised when the underlying data changes.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  changedEvent: {\n    get: function () {\n      return this._changed;\n    },\n  },\n  /**\n   * Gets an event that will be raised if an error is encountered during processing.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  errorEvent: {\n    get: function () {\n      return this._error;\n    },\n  },\n  /**\n   * Gets an event that will be raised when the data source either starts or stops loading.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  loadingEvent: {\n    get: function () {\n      return this._loading;\n    },\n  },\n  /**\n   * Gets whether or not this data source should be displayed.\n   * @memberof CzmlDataSource.prototype\n   * @type {Boolean}\n   */\n  show: {\n    get: function () {\n      return this._entityCollection.show;\n    },\n    set: function (value) {\n      this._entityCollection.show = value;\n    },\n  },\n\n  /**\n   * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n   *\n   * @memberof CzmlDataSource.prototype\n   * @type {EntityCluster}\n   */\n  clustering: {\n    get: function () {\n      return this._entityCluster;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      if (!defined(value)) {\n        throw new DeveloperError(\"value must be defined.\");\n      }\n      //>>includeEnd('debug');\n      this._entityCluster = value;\n    },\n  },\n  /**\n   * Gets the credit that will be displayed for the data source\n   * @memberof CzmlDataSource.prototype\n   * @type {Credit}\n   */\n  credit: {\n    get: function () {\n      return this._credit;\n    },\n  },\n});\n\n/**\n * Gets the array of CZML processing functions.\n * @memberof CzmlDataSource\n * @type Array\n */\nCzmlDataSource.updaters = [\n  processBillboard, //\n  processBox, //\n  processCorridor, //\n  processCylinder, //\n  processEllipse, //\n  processEllipsoid, //\n  processLabel, //\n  processModel, //\n  processName, //\n  processDescription, //\n  processPath, //\n  processPoint, //\n  processPolygon, //\n  processPolyline, //\n  processProperties, //\n  processRectangle, //\n  processPosition, //\n  processTileset, //\n  processViewFrom, //\n  processWall, //\n  processOrientation, //\n  processAvailability,\n];\n\n/**\n * Processes the provided url or CZML object without clearing any existing data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {Object} [options] An object with the following properties:\n * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n */\nCzmlDataSource.prototype.process = function (czml, options) {\n  return load(this, czml, options, false);\n};\n\n/**\n * Loads the provided url or CZML object, replacing any existing data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {Object} [options] An object with the following properties:\n * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n */\nCzmlDataSource.prototype.load = function (czml, options) {\n  return load(this, czml, options, true);\n};\n\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link Property} from a CZML packet.\n * @function\n *\n * @param {Function} type The constructor function for the property being processed.\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\nCzmlDataSource.processPacketData = processPacketData;\n\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link PositionProperty} from a CZML packet.\n * @function\n *\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\nCzmlDataSource.processPositionPacketData = processPositionPacketData;\n\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link MaterialProperty} from a CZML packet.\n * @function\n *\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\nCzmlDataSource.processMaterialPacketData = processMaterialPacketData;\n\nCzmlDataSource._processCzml = function (\n  czml,\n  entityCollection,\n  sourceUri,\n  updaterFunctions,\n  dataSource\n) {\n  updaterFunctions = defaultValue(updaterFunctions, CzmlDataSource.updaters);\n\n  if (Array.isArray(czml)) {\n    for (var i = 0, len = czml.length; i < len; ++i) {\n      processCzmlPacket(\n        czml[i],\n        entityCollection,\n        updaterFunctions,\n        sourceUri,\n        dataSource\n      );\n    }\n  } else {\n    processCzmlPacket(\n      czml,\n      entityCollection,\n      updaterFunctions,\n      sourceUri,\n      dataSource\n    );\n  }\n};\nexport default CzmlDataSource;\n"]},"metadata":{},"sourceType":"module"}