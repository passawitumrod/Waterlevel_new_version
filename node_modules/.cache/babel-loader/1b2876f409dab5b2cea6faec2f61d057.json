{"ast":null,"code":"import ClockRange from \"../../Core/ClockRange.js\";\nimport defined from \"../../Core/defined.js\";\nimport destroyObject from \"../../Core/destroyObject.js\";\nimport DeveloperError from \"../../Core/DeveloperError.js\";\nimport JulianDate from \"../../Core/JulianDate.js\";\nimport getElement from \"../getElement.js\";\nimport TimelineHighlightRange from \"./TimelineHighlightRange.js\";\nimport TimelineTrack from \"./TimelineTrack.js\";\nvar timelineWheelDelta = 1e12;\nvar timelineMouseMode = {\n  none: 0,\n  scrub: 1,\n  slide: 2,\n  zoom: 3,\n  touchOnly: 4\n};\nvar timelineTouchMode = {\n  none: 0,\n  scrub: 1,\n  slideZoom: 2,\n  singleTap: 3,\n  ignore: 4\n};\nvar timelineTicScales = [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.1, 0.25, 0.5, 1.0, 2.0, 5.0, 10.0, 15.0, 30.0, 60.0, // 1min\n120.0, // 2min\n300.0, // 5min\n600.0, // 10min\n900.0, // 15min\n1800.0, // 30min\n3600.0, // 1hr\n7200.0, // 2hr\n14400.0, // 4hr\n21600.0, // 6hr\n43200.0, // 12hr\n86400.0, // 24hr\n172800.0, // 2days\n345600.0, // 4days\n604800.0, // 7days\n1296000.0, // 15days\n2592000.0, // 30days\n5184000.0, // 60days\n7776000.0, // 90days\n15552000.0, // 180days\n31536000.0, // 365days\n63072000.0, // 2years\n126144000.0, // 4years\n157680000.0, // 5years\n315360000.0, // 10years\n630720000.0, // 20years\n1261440000.0, // 40years\n1576800000.0, // 50years\n3153600000.0, // 100years\n6307200000.0, // 200years\n12614400000.0, // 400years\n15768000000.0, // 500years\n31536000000.0 // 1000years\n];\nvar timelineMonthNames = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n/**\n * The Timeline is a widget for displaying and controlling the current scene time.\n * @alias Timeline\n * @constructor\n *\n * @param {Element} container The parent HTML container node for this widget.\n * @param {Clock} clock The clock to use.\n */\n\nfunction Timeline(container, clock) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(container)) {\n    throw new DeveloperError(\"container is required.\");\n  }\n\n  if (!defined(clock)) {\n    throw new DeveloperError(\"clock is required.\");\n  } //>>includeEnd('debug');\n\n\n  container = getElement(container);\n  var ownerDocument = container.ownerDocument;\n  /**\n   * Gets the parent container.\n   * @type {Element}\n   */\n\n  this.container = container;\n  var topDiv = ownerDocument.createElement(\"div\");\n  topDiv.className = \"cesium-timeline-main\";\n  container.appendChild(topDiv);\n  this._topDiv = topDiv;\n  this._endJulian = undefined;\n  this._epochJulian = undefined;\n  this._lastXPos = undefined;\n  this._scrubElement = undefined;\n  this._startJulian = undefined;\n  this._timeBarSecondsSpan = undefined;\n  this._clock = clock;\n  this._scrubJulian = clock.currentTime;\n  this._mainTicSpan = -1;\n  this._mouseMode = timelineMouseMode.none;\n  this._touchMode = timelineTouchMode.none;\n  this._touchState = {\n    centerX: 0,\n    spanX: 0\n  };\n  this._mouseX = 0;\n  this._timelineDrag = 0;\n  this._timelineDragLocation = undefined;\n  this._lastHeight = undefined;\n  this._lastWidth = undefined;\n  this._topDiv.innerHTML = '<div class=\"cesium-timeline-bar\"></div><div class=\"cesium-timeline-trackContainer\">' + '<canvas class=\"cesium-timeline-tracks\" width=\"10\" height=\"1\">' + '</canvas></div><div class=\"cesium-timeline-needle\"></div><span class=\"cesium-timeline-ruler\"></span>';\n  this._timeBarEle = this._topDiv.childNodes[0];\n  this._trackContainer = this._topDiv.childNodes[1];\n  this._trackListEle = this._topDiv.childNodes[1].childNodes[0];\n  this._needleEle = this._topDiv.childNodes[2];\n  this._rulerEle = this._topDiv.childNodes[3];\n  this._context = this._trackListEle.getContext(\"2d\");\n  this._trackList = [];\n  this._highlightRanges = [];\n  this.zoomTo(clock.startTime, clock.stopTime);\n  this._onMouseDown = createMouseDownCallback(this);\n  this._onMouseUp = createMouseUpCallback(this);\n  this._onMouseMove = createMouseMoveCallback(this);\n  this._onMouseWheel = createMouseWheelCallback(this);\n  this._onTouchStart = createTouchStartCallback(this);\n  this._onTouchMove = createTouchMoveCallback(this);\n  this._onTouchEnd = createTouchEndCallback(this);\n  var timeBarEle = this._timeBarEle;\n  ownerDocument.addEventListener(\"mouseup\", this._onMouseUp, false);\n  ownerDocument.addEventListener(\"mousemove\", this._onMouseMove, false);\n  timeBarEle.addEventListener(\"mousedown\", this._onMouseDown, false);\n  timeBarEle.addEventListener(\"DOMMouseScroll\", this._onMouseWheel, false); // Mozilla mouse wheel\n\n  timeBarEle.addEventListener(\"mousewheel\", this._onMouseWheel, false);\n  timeBarEle.addEventListener(\"touchstart\", this._onTouchStart, false);\n  timeBarEle.addEventListener(\"touchmove\", this._onTouchMove, false);\n  timeBarEle.addEventListener(\"touchend\", this._onTouchEnd, false);\n  timeBarEle.addEventListener(\"touchcancel\", this._onTouchEnd, false);\n\n  this._topDiv.oncontextmenu = function () {\n    return false;\n  };\n\n  clock.onTick.addEventListener(this.updateFromClock, this);\n  this.updateFromClock();\n}\n/**\n * @private\n */\n\n\nTimeline.prototype.addEventListener = function (type, listener, useCapture) {\n  this._topDiv.addEventListener(type, listener, useCapture);\n};\n/**\n * @private\n */\n\n\nTimeline.prototype.removeEventListener = function (type, listener, useCapture) {\n  this._topDiv.removeEventListener(type, listener, useCapture);\n};\n/**\n * @returns {Boolean} true if the object has been destroyed, false otherwise.\n */\n\n\nTimeline.prototype.isDestroyed = function () {\n  return false;\n};\n/**\n * Destroys the widget.  Should be called if permanently\n * removing the widget from layout.\n */\n\n\nTimeline.prototype.destroy = function () {\n  this._clock.onTick.removeEventListener(this.updateFromClock, this);\n\n  var doc = this.container.ownerDocument;\n  doc.removeEventListener(\"mouseup\", this._onMouseUp, false);\n  doc.removeEventListener(\"mousemove\", this._onMouseMove, false);\n  var timeBarEle = this._timeBarEle;\n  timeBarEle.removeEventListener(\"mousedown\", this._onMouseDown, false);\n  timeBarEle.removeEventListener(\"DOMMouseScroll\", this._onMouseWheel, false); // Mozilla mouse wheel\n\n  timeBarEle.removeEventListener(\"mousewheel\", this._onMouseWheel, false);\n  timeBarEle.removeEventListener(\"touchstart\", this._onTouchStart, false);\n  timeBarEle.removeEventListener(\"touchmove\", this._onTouchMove, false);\n  timeBarEle.removeEventListener(\"touchend\", this._onTouchEnd, false);\n  timeBarEle.removeEventListener(\"touchcancel\", this._onTouchEnd, false);\n  this.container.removeChild(this._topDiv);\n  destroyObject(this);\n};\n/**\n * @private\n */\n\n\nTimeline.prototype.addHighlightRange = function (color, heightInPx, base) {\n  var newHighlightRange = new TimelineHighlightRange(color, heightInPx, base);\n\n  this._highlightRanges.push(newHighlightRange);\n\n  this.resize();\n  return newHighlightRange;\n};\n/**\n * @private\n */\n\n\nTimeline.prototype.addTrack = function (interval, heightInPx, color, backgroundColor) {\n  var newTrack = new TimelineTrack(interval, heightInPx, color, backgroundColor);\n\n  this._trackList.push(newTrack);\n\n  this._lastHeight = undefined;\n  this.resize();\n  return newTrack;\n};\n/**\n * Sets the view to the provided times.\n *\n * @param {JulianDate} startTime The start time.\n * @param {JulianDate} stopTime The stop time.\n */\n\n\nTimeline.prototype.zoomTo = function (startTime, stopTime) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(startTime)) {\n    throw new DeveloperError(\"startTime is required.\");\n  }\n\n  if (!defined(stopTime)) {\n    throw new DeveloperError(\"stopTime is required\");\n  }\n\n  if (JulianDate.lessThanOrEquals(stopTime, startTime)) {\n    throw new DeveloperError(\"Start time must come before end time.\");\n  } //>>includeEnd('debug');\n\n\n  this._startJulian = startTime;\n  this._endJulian = stopTime;\n  this._timeBarSecondsSpan = JulianDate.secondsDifference(stopTime, startTime); // If clock is not unbounded, clamp timeline range to clock.\n\n  if (this._clock && this._clock.clockRange !== ClockRange.UNBOUNDED) {\n    var clockStart = this._clock.startTime;\n    var clockEnd = this._clock.stopTime;\n    var clockSpan = JulianDate.secondsDifference(clockEnd, clockStart);\n    var startOffset = JulianDate.secondsDifference(clockStart, this._startJulian);\n    var endOffset = JulianDate.secondsDifference(clockEnd, this._endJulian);\n\n    if (this._timeBarSecondsSpan >= clockSpan) {\n      // if new duration longer than clock range duration, clamp to full range.\n      this._timeBarSecondsSpan = clockSpan;\n      this._startJulian = this._clock.startTime;\n      this._endJulian = this._clock.stopTime;\n    } else if (startOffset > 0) {\n      // if timeline start is before clock start, shift right\n      this._endJulian = JulianDate.addSeconds(this._endJulian, startOffset, new JulianDate());\n      this._startJulian = clockStart;\n      this._timeBarSecondsSpan = JulianDate.secondsDifference(this._endJulian, this._startJulian);\n    } else if (endOffset < 0) {\n      // if timeline end is after clock end, shift left\n      this._startJulian = JulianDate.addSeconds(this._startJulian, endOffset, new JulianDate());\n      this._endJulian = clockEnd;\n      this._timeBarSecondsSpan = JulianDate.secondsDifference(this._endJulian, this._startJulian);\n    }\n  }\n\n  this._makeTics();\n\n  var evt = document.createEvent(\"Event\");\n  evt.initEvent(\"setzoom\", true, true);\n  evt.startJulian = this._startJulian;\n  evt.endJulian = this._endJulian;\n  evt.epochJulian = this._epochJulian;\n  evt.totalSpan = this._timeBarSecondsSpan;\n  evt.mainTicSpan = this._mainTicSpan;\n\n  this._topDiv.dispatchEvent(evt);\n};\n/**\n * @private\n */\n\n\nTimeline.prototype.zoomFrom = function (amount) {\n  var centerSec = JulianDate.secondsDifference(this._scrubJulian, this._startJulian);\n\n  if (amount > 1 || centerSec < 0 || centerSec > this._timeBarSecondsSpan) {\n    centerSec = this._timeBarSecondsSpan * 0.5;\n  } else {\n    centerSec += centerSec - this._timeBarSecondsSpan * 0.5;\n  }\n\n  var centerSecFlip = this._timeBarSecondsSpan - centerSec;\n  this.zoomTo(JulianDate.addSeconds(this._startJulian, centerSec - centerSec * amount, new JulianDate()), JulianDate.addSeconds(this._endJulian, centerSecFlip * amount - centerSecFlip, new JulianDate()));\n};\n\nfunction twoDigits(num) {\n  return num < 10 ? \"0\" + num.toString() : num.toString();\n}\n/**\n * @private\n */\n\n\nTimeline.prototype.makeLabel = function (time) {\n  var gregorian = JulianDate.toGregorianDate(time);\n  var millisecond = gregorian.millisecond,\n      millisecondString = \" UTC\";\n\n  if (millisecond > 0 && this._timeBarSecondsSpan < 3600) {\n    millisecondString = Math.floor(millisecond).toString();\n\n    while (millisecondString.length < 3) {\n      millisecondString = \"0\" + millisecondString;\n    }\n\n    millisecondString = \".\" + millisecondString;\n  }\n\n  return timelineMonthNames[gregorian.month - 1] + \" \" + gregorian.day + \" \" + gregorian.year + \" \" + twoDigits(gregorian.hour) + \":\" + twoDigits(gregorian.minute) + \":\" + twoDigits(gregorian.second) + millisecondString;\n};\n/**\n * @private\n */\n\n\nTimeline.prototype.smallestTicInPixels = 7.0;\n/**\n * @private\n */\n\nTimeline.prototype._makeTics = function () {\n  var timeBar = this._timeBarEle;\n  var seconds = JulianDate.secondsDifference(this._scrubJulian, this._startJulian);\n  var xPos = Math.round(seconds * this._topDiv.clientWidth / this._timeBarSecondsSpan);\n  var scrubX = xPos - 8,\n      tic;\n  var widget = this;\n  this._needleEle.style.left = xPos.toString() + \"px\";\n  var tics = \"\";\n  var minimumDuration = 0.01;\n  var maximumDuration = 31536000000.0; // ~1000 years\n\n  var epsilon = 1e-10; // If time step size is known, enter it here...\n\n  var minSize = 0;\n  var duration = this._timeBarSecondsSpan;\n\n  if (duration < minimumDuration) {\n    duration = minimumDuration;\n    this._timeBarSecondsSpan = minimumDuration;\n    this._endJulian = JulianDate.addSeconds(this._startJulian, minimumDuration, new JulianDate());\n  } else if (duration > maximumDuration) {\n    duration = maximumDuration;\n    this._timeBarSecondsSpan = maximumDuration;\n    this._endJulian = JulianDate.addSeconds(this._startJulian, maximumDuration, new JulianDate());\n  }\n\n  var timeBarWidth = this._timeBarEle.clientWidth;\n\n  if (timeBarWidth < 10) {\n    timeBarWidth = 10;\n  }\n\n  var startJulian = this._startJulian; // epsilonTime: a small fraction of one pixel width of the timeline, measured in seconds.\n\n  var epsilonTime = Math.min(duration / timeBarWidth * 1e-5, 0.4); // epochJulian: a nearby time to be considered \"zero seconds\", should be a round-ish number by human standards.\n\n  var epochJulian;\n  var gregorianDate = JulianDate.toGregorianDate(startJulian);\n\n  if (duration > 315360000) {\n    // 3650+ days visible, epoch is start of the first visible century.\n    epochJulian = JulianDate.fromDate(new Date(Date.UTC(Math.floor(gregorianDate.year / 100) * 100, 0)));\n  } else if (duration > 31536000) {\n    // 365+ days visible, epoch is start of the first visible decade.\n    epochJulian = JulianDate.fromDate(new Date(Date.UTC(Math.floor(gregorianDate.year / 10) * 10, 0)));\n  } else if (duration > 86400) {\n    // 1+ day(s) visible, epoch is start of the year.\n    epochJulian = JulianDate.fromDate(new Date(Date.UTC(gregorianDate.year, 0)));\n  } else {\n    // Less than a day on timeline, epoch is midnight of the visible day.\n    epochJulian = JulianDate.fromDate(new Date(Date.UTC(gregorianDate.year, gregorianDate.month, gregorianDate.day)));\n  } // startTime: Seconds offset of the left side of the timeline from epochJulian.\n\n\n  var startTime = JulianDate.secondsDifference(this._startJulian, JulianDate.addSeconds(epochJulian, epsilonTime, new JulianDate())); // endTime: Seconds offset of the right side of the timeline from epochJulian.\n\n  var endTime = startTime + duration;\n  this._epochJulian = epochJulian;\n\n  function getStartTic(ticScale) {\n    return Math.floor(startTime / ticScale) * ticScale;\n  }\n\n  function getNextTic(tic, ticScale) {\n    return Math.ceil(tic / ticScale + 0.5) * ticScale;\n  }\n\n  function getAlpha(time) {\n    return (time - startTime) / duration;\n  }\n\n  function remainder(x, y) {\n    //return x % y;\n    return x - y * Math.round(x / y);\n  } // Width in pixels of a typical label, plus padding\n\n\n  this._rulerEle.innerHTML = this.makeLabel(JulianDate.addSeconds(this._endJulian, -minimumDuration, new JulianDate()));\n  var sampleWidth = this._rulerEle.offsetWidth + 20;\n\n  if (sampleWidth < 30) {\n    // Workaround an apparent IE bug with measuring the width after going full-screen from inside an iframe.\n    sampleWidth = 180;\n  }\n\n  var origMinSize = minSize;\n  minSize -= epsilon;\n  var renderState = {\n    startTime: startTime,\n    startJulian: startJulian,\n    epochJulian: epochJulian,\n    duration: duration,\n    timeBarWidth: timeBarWidth,\n    getAlpha: getAlpha\n  };\n\n  this._highlightRanges.forEach(function (highlightRange) {\n    tics += highlightRange.render(renderState);\n  }); // Calculate tic mark label spacing in the TimeBar.\n\n\n  var mainTic = 0.0,\n      subTic = 0.0,\n      tinyTic = 0.0; // Ideal labeled tic as percentage of zoom interval\n\n  var idealTic = sampleWidth / timeBarWidth;\n\n  if (idealTic > 1.0) {\n    // Clamp to width of window, for thin windows.\n    idealTic = 1.0;\n  } // Ideal labeled tic size in seconds\n\n\n  idealTic *= this._timeBarSecondsSpan;\n  var ticIndex = -1,\n      smallestIndex = -1;\n  var i,\n      ticScaleLen = timelineTicScales.length;\n\n  for (i = 0; i < ticScaleLen; ++i) {\n    var sc = timelineTicScales[i];\n    ++ticIndex;\n    mainTic = sc; // Find acceptable main tic size not smaller than ideal size.\n\n    if (sc > idealTic && sc > minSize) {\n      break;\n    }\n\n    if (smallestIndex < 0 && timeBarWidth * (sc / this._timeBarSecondsSpan) >= this.smallestTicInPixels) {\n      smallestIndex = ticIndex;\n    }\n  }\n\n  if (ticIndex > 0) {\n    while (ticIndex > 0) {\n      // Compute sub-tic size that evenly divides main tic.\n      --ticIndex;\n\n      if (Math.abs(remainder(mainTic, timelineTicScales[ticIndex])) < 0.00001) {\n        if (timelineTicScales[ticIndex] >= minSize) {\n          subTic = timelineTicScales[ticIndex];\n        }\n\n        break;\n      }\n    }\n\n    if (smallestIndex >= 0) {\n      while (smallestIndex < ticIndex) {\n        // Compute tiny tic size that evenly divides sub-tic.\n        if (Math.abs(remainder(subTic, timelineTicScales[smallestIndex])) < 0.00001 && timelineTicScales[smallestIndex] >= minSize) {\n          tinyTic = timelineTicScales[smallestIndex];\n          break;\n        }\n\n        ++smallestIndex;\n      }\n    }\n  }\n\n  minSize = origMinSize;\n\n  if (minSize > epsilon && tinyTic < 0.00001 && Math.abs(minSize - mainTic) > epsilon) {\n    tinyTic = minSize;\n\n    if (minSize <= mainTic + epsilon) {\n      subTic = 0.0;\n    }\n  }\n\n  var lastTextLeft = -999999,\n      textWidth;\n\n  if (timeBarWidth * (tinyTic / this._timeBarSecondsSpan) >= 3.0) {\n    for (tic = getStartTic(tinyTic); tic <= endTime; tic = getNextTic(tic, tinyTic)) {\n      tics += '<span class=\"cesium-timeline-ticTiny\" style=\"left: ' + Math.round(timeBarWidth * getAlpha(tic)).toString() + 'px;\"></span>';\n    }\n  }\n\n  if (timeBarWidth * (subTic / this._timeBarSecondsSpan) >= 3.0) {\n    for (tic = getStartTic(subTic); tic <= endTime; tic = getNextTic(tic, subTic)) {\n      tics += '<span class=\"cesium-timeline-ticSub\" style=\"left: ' + Math.round(timeBarWidth * getAlpha(tic)).toString() + 'px;\"></span>';\n    }\n  }\n\n  if (timeBarWidth * (mainTic / this._timeBarSecondsSpan) >= 2.0) {\n    this._mainTicSpan = mainTic;\n    endTime += mainTic;\n    tic = getStartTic(mainTic);\n    var leapSecond = JulianDate.computeTaiMinusUtc(epochJulian);\n\n    while (tic <= endTime) {\n      var ticTime = JulianDate.addSeconds(startJulian, tic - startTime, new JulianDate());\n\n      if (mainTic > 2.1) {\n        var ticLeap = JulianDate.computeTaiMinusUtc(ticTime);\n\n        if (Math.abs(ticLeap - leapSecond) > 0.1) {\n          tic += ticLeap - leapSecond;\n          ticTime = JulianDate.addSeconds(startJulian, tic - startTime, new JulianDate());\n        }\n      }\n\n      var ticLeft = Math.round(timeBarWidth * getAlpha(tic));\n      var ticLabel = this.makeLabel(ticTime);\n      this._rulerEle.innerHTML = ticLabel;\n      textWidth = this._rulerEle.offsetWidth;\n\n      if (textWidth < 10) {\n        // IE iframe fullscreen sampleWidth workaround, continued.\n        textWidth = sampleWidth;\n      }\n\n      var labelLeft = ticLeft - (textWidth / 2 - 1);\n\n      if (labelLeft > lastTextLeft) {\n        lastTextLeft = labelLeft + textWidth + 5;\n        tics += '<span class=\"cesium-timeline-ticMain\" style=\"left: ' + ticLeft.toString() + 'px;\"></span>' + '<span class=\"cesium-timeline-ticLabel\" style=\"left: ' + labelLeft.toString() + 'px;\">' + ticLabel + \"</span>\";\n      } else {\n        tics += '<span class=\"cesium-timeline-ticSub\" style=\"left: ' + ticLeft.toString() + 'px;\"></span>';\n      }\n\n      tic = getNextTic(tic, mainTic);\n    }\n  } else {\n    this._mainTicSpan = -1;\n  }\n\n  tics += '<span class=\"cesium-timeline-icon16\" style=\"left:' + scrubX + 'px;bottom:0;background-position: 0 0;\"></span>';\n  timeBar.innerHTML = tics;\n  this._scrubElement = timeBar.lastChild; // Clear track canvas.\n\n  this._context.clearRect(0, 0, this._trackListEle.width, this._trackListEle.height);\n\n  renderState.y = 0;\n\n  this._trackList.forEach(function (track) {\n    track.render(widget._context, renderState);\n    renderState.y += track.height;\n  });\n};\n/**\n * @private\n */\n\n\nTimeline.prototype.updateFromClock = function () {\n  this._scrubJulian = this._clock.currentTime;\n  var scrubElement = this._scrubElement;\n\n  if (defined(this._scrubElement)) {\n    var seconds = JulianDate.secondsDifference(this._scrubJulian, this._startJulian);\n    var xPos = Math.round(seconds * this._topDiv.clientWidth / this._timeBarSecondsSpan);\n\n    if (this._lastXPos !== xPos) {\n      this._lastXPos = xPos;\n      scrubElement.style.left = xPos - 8 + \"px\";\n      this._needleEle.style.left = xPos + \"px\";\n    }\n  }\n\n  if (defined(this._timelineDragLocation)) {\n    this._setTimeBarTime(this._timelineDragLocation, this._timelineDragLocation * this._timeBarSecondsSpan / this._topDiv.clientWidth);\n\n    this.zoomTo(JulianDate.addSeconds(this._startJulian, this._timelineDrag, new JulianDate()), JulianDate.addSeconds(this._endJulian, this._timelineDrag, new JulianDate()));\n  }\n};\n/**\n * @private\n */\n\n\nTimeline.prototype._setTimeBarTime = function (xPos, seconds) {\n  xPos = Math.round(xPos);\n  this._scrubJulian = JulianDate.addSeconds(this._startJulian, seconds, new JulianDate());\n\n  if (this._scrubElement) {\n    var scrubX = xPos - 8;\n    this._scrubElement.style.left = scrubX.toString() + \"px\";\n    this._needleEle.style.left = xPos.toString() + \"px\";\n  }\n\n  var evt = document.createEvent(\"Event\");\n  evt.initEvent(\"settime\", true, true);\n  evt.clientX = xPos;\n  evt.timeSeconds = seconds;\n  evt.timeJulian = this._scrubJulian;\n  evt.clock = this._clock;\n\n  this._topDiv.dispatchEvent(evt);\n};\n\nfunction createMouseDownCallback(timeline) {\n  return function (e) {\n    if (timeline._mouseMode !== timelineMouseMode.touchOnly) {\n      if (e.button === 0) {\n        timeline._mouseMode = timelineMouseMode.scrub;\n\n        if (timeline._scrubElement) {\n          timeline._scrubElement.style.backgroundPosition = \"-16px 0\";\n        }\n\n        timeline._onMouseMove(e);\n      } else {\n        timeline._mouseX = e.clientX;\n\n        if (e.button === 2) {\n          timeline._mouseMode = timelineMouseMode.zoom;\n        } else {\n          timeline._mouseMode = timelineMouseMode.slide;\n        }\n      }\n    }\n\n    e.preventDefault();\n  };\n}\n\nfunction createMouseUpCallback(timeline) {\n  return function (e) {\n    timeline._mouseMode = timelineMouseMode.none;\n\n    if (timeline._scrubElement) {\n      timeline._scrubElement.style.backgroundPosition = \"0 0\";\n    }\n\n    timeline._timelineDrag = 0;\n    timeline._timelineDragLocation = undefined;\n  };\n}\n\nfunction createMouseMoveCallback(timeline) {\n  return function (e) {\n    var dx;\n\n    if (timeline._mouseMode === timelineMouseMode.scrub) {\n      e.preventDefault();\n\n      var x = e.clientX - timeline._topDiv.getBoundingClientRect().left;\n\n      if (x < 0) {\n        timeline._timelineDragLocation = 0;\n        timeline._timelineDrag = -0.01 * timeline._timeBarSecondsSpan;\n      } else if (x > timeline._topDiv.clientWidth) {\n        timeline._timelineDragLocation = timeline._topDiv.clientWidth;\n        timeline._timelineDrag = 0.01 * timeline._timeBarSecondsSpan;\n      } else {\n        timeline._timelineDragLocation = undefined;\n\n        timeline._setTimeBarTime(x, x * timeline._timeBarSecondsSpan / timeline._topDiv.clientWidth);\n      }\n    } else if (timeline._mouseMode === timelineMouseMode.slide) {\n      dx = timeline._mouseX - e.clientX;\n      timeline._mouseX = e.clientX;\n\n      if (dx !== 0) {\n        var dsec = dx * timeline._timeBarSecondsSpan / timeline._topDiv.clientWidth;\n        timeline.zoomTo(JulianDate.addSeconds(timeline._startJulian, dsec, new JulianDate()), JulianDate.addSeconds(timeline._endJulian, dsec, new JulianDate()));\n      }\n    } else if (timeline._mouseMode === timelineMouseMode.zoom) {\n      dx = timeline._mouseX - e.clientX;\n      timeline._mouseX = e.clientX;\n\n      if (dx !== 0) {\n        timeline.zoomFrom(Math.pow(1.01, dx));\n      }\n    }\n  };\n}\n\nfunction createMouseWheelCallback(timeline) {\n  return function (e) {\n    var dy = e.wheelDeltaY || e.wheelDelta || -e.detail;\n    timelineWheelDelta = Math.max(Math.min(Math.abs(dy), timelineWheelDelta), 1);\n    dy /= timelineWheelDelta;\n    timeline.zoomFrom(Math.pow(1.05, -dy));\n  };\n}\n\nfunction createTouchStartCallback(timeline) {\n  return function (e) {\n    var len = e.touches.length,\n        seconds,\n        xPos,\n        leftX = timeline._topDiv.getBoundingClientRect().left;\n\n    e.preventDefault();\n    timeline._mouseMode = timelineMouseMode.touchOnly;\n\n    if (len === 1) {\n      seconds = JulianDate.secondsDifference(timeline._scrubJulian, timeline._startJulian);\n      xPos = Math.round(seconds * timeline._topDiv.clientWidth / timeline._timeBarSecondsSpan + leftX);\n\n      if (Math.abs(e.touches[0].clientX - xPos) < 50) {\n        timeline._touchMode = timelineTouchMode.scrub;\n\n        if (timeline._scrubElement) {\n          timeline._scrubElement.style.backgroundPosition = len === 1 ? \"-16px 0\" : \"0 0\";\n        }\n      } else {\n        timeline._touchMode = timelineTouchMode.singleTap;\n        timeline._touchState.centerX = e.touches[0].clientX - leftX;\n      }\n    } else if (len === 2) {\n      timeline._touchMode = timelineTouchMode.slideZoom;\n      timeline._touchState.centerX = (e.touches[0].clientX + e.touches[1].clientX) * 0.5 - leftX;\n      timeline._touchState.spanX = Math.abs(e.touches[0].clientX - e.touches[1].clientX);\n    } else {\n      timeline._touchMode = timelineTouchMode.ignore;\n    }\n  };\n}\n\nfunction createTouchEndCallback(timeline) {\n  return function (e) {\n    var len = e.touches.length,\n        leftX = timeline._topDiv.getBoundingClientRect().left;\n\n    if (timeline._touchMode === timelineTouchMode.singleTap) {\n      timeline._touchMode = timelineTouchMode.scrub;\n\n      timeline._onTouchMove(e);\n    } else if (timeline._touchMode === timelineTouchMode.scrub) {\n      timeline._onTouchMove(e);\n    }\n\n    timeline._mouseMode = timelineMouseMode.touchOnly;\n\n    if (len !== 1) {\n      timeline._touchMode = len > 0 ? timelineTouchMode.ignore : timelineTouchMode.none;\n    } else if (timeline._touchMode === timelineTouchMode.slideZoom) {\n      timeline._touchState.centerX = e.touches[0].clientX - leftX;\n    }\n\n    if (timeline._scrubElement) {\n      timeline._scrubElement.style.backgroundPosition = \"0 0\";\n    }\n  };\n}\n\nfunction createTouchMoveCallback(timeline) {\n  return function (e) {\n    var dx,\n        x,\n        len,\n        newCenter,\n        newSpan,\n        newStartTime,\n        zoom = 1,\n        leftX = timeline._topDiv.getBoundingClientRect().left;\n\n    if (timeline._touchMode === timelineTouchMode.singleTap) {\n      timeline._touchMode = timelineTouchMode.slideZoom;\n    }\n\n    timeline._mouseMode = timelineMouseMode.touchOnly;\n\n    if (timeline._touchMode === timelineTouchMode.scrub) {\n      e.preventDefault();\n\n      if (e.changedTouches.length === 1) {\n        x = e.changedTouches[0].clientX - leftX;\n\n        if (x >= 0 && x <= timeline._topDiv.clientWidth) {\n          timeline._setTimeBarTime(x, x * timeline._timeBarSecondsSpan / timeline._topDiv.clientWidth);\n        }\n      }\n    } else if (timeline._touchMode === timelineTouchMode.slideZoom) {\n      len = e.touches.length;\n\n      if (len === 2) {\n        newCenter = (e.touches[0].clientX + e.touches[1].clientX) * 0.5 - leftX;\n        newSpan = Math.abs(e.touches[0].clientX - e.touches[1].clientX);\n      } else if (len === 1) {\n        newCenter = e.touches[0].clientX - leftX;\n        newSpan = 0;\n      }\n\n      if (defined(newCenter)) {\n        if (newSpan > 0 && timeline._touchState.spanX > 0) {\n          // Zoom and slide\n          zoom = timeline._touchState.spanX / newSpan;\n          newStartTime = JulianDate.addSeconds(timeline._startJulian, (timeline._touchState.centerX * timeline._timeBarSecondsSpan - newCenter * timeline._timeBarSecondsSpan * zoom) / timeline._topDiv.clientWidth, new JulianDate());\n        } else {\n          // Slide to newCenter\n          dx = timeline._touchState.centerX - newCenter;\n          newStartTime = JulianDate.addSeconds(timeline._startJulian, dx * timeline._timeBarSecondsSpan / timeline._topDiv.clientWidth, new JulianDate());\n        }\n\n        timeline.zoomTo(newStartTime, JulianDate.addSeconds(newStartTime, timeline._timeBarSecondsSpan * zoom, new JulianDate()));\n        timeline._touchState.centerX = newCenter;\n        timeline._touchState.spanX = newSpan;\n      }\n    }\n  };\n}\n/**\n * Resizes the widget to match the container size.\n */\n\n\nTimeline.prototype.resize = function () {\n  var width = this.container.clientWidth;\n  var height = this.container.clientHeight;\n\n  if (width === this._lastWidth && height === this._lastHeight) {\n    return;\n  }\n\n  this._trackContainer.style.height = height + \"px\";\n  var trackListHeight = 1;\n\n  this._trackList.forEach(function (track) {\n    trackListHeight += track.height;\n  });\n\n  this._trackListEle.style.height = trackListHeight.toString() + \"px\";\n  this._trackListEle.width = this._trackListEle.clientWidth;\n  this._trackListEle.height = trackListHeight;\n\n  this._makeTics();\n\n  this._lastXPos = undefined;\n  this._lastWidth = width;\n  this._lastHeight = height;\n};\n\nexport default Timeline;","map":{"version":3,"sources":["C:/Users/passa/Desktop/WaterDeployTrial/node_modules/cesium/Source/Widgets/Timeline/Timeline.js"],"names":["ClockRange","defined","destroyObject","DeveloperError","JulianDate","getElement","TimelineHighlightRange","TimelineTrack","timelineWheelDelta","timelineMouseMode","none","scrub","slide","zoom","touchOnly","timelineTouchMode","slideZoom","singleTap","ignore","timelineTicScales","timelineMonthNames","Timeline","container","clock","ownerDocument","topDiv","createElement","className","appendChild","_topDiv","_endJulian","undefined","_epochJulian","_lastXPos","_scrubElement","_startJulian","_timeBarSecondsSpan","_clock","_scrubJulian","currentTime","_mainTicSpan","_mouseMode","_touchMode","_touchState","centerX","spanX","_mouseX","_timelineDrag","_timelineDragLocation","_lastHeight","_lastWidth","innerHTML","_timeBarEle","childNodes","_trackContainer","_trackListEle","_needleEle","_rulerEle","_context","getContext","_trackList","_highlightRanges","zoomTo","startTime","stopTime","_onMouseDown","createMouseDownCallback","_onMouseUp","createMouseUpCallback","_onMouseMove","createMouseMoveCallback","_onMouseWheel","createMouseWheelCallback","_onTouchStart","createTouchStartCallback","_onTouchMove","createTouchMoveCallback","_onTouchEnd","createTouchEndCallback","timeBarEle","addEventListener","oncontextmenu","onTick","updateFromClock","prototype","type","listener","useCapture","removeEventListener","isDestroyed","destroy","doc","removeChild","addHighlightRange","color","heightInPx","base","newHighlightRange","push","resize","addTrack","interval","backgroundColor","newTrack","lessThanOrEquals","secondsDifference","clockRange","UNBOUNDED","clockStart","clockEnd","clockSpan","startOffset","endOffset","addSeconds","_makeTics","evt","document","createEvent","initEvent","startJulian","endJulian","epochJulian","totalSpan","mainTicSpan","dispatchEvent","zoomFrom","amount","centerSec","centerSecFlip","twoDigits","num","toString","makeLabel","time","gregorian","toGregorianDate","millisecond","millisecondString","Math","floor","length","month","day","year","hour","minute","second","smallestTicInPixels","timeBar","seconds","xPos","round","clientWidth","scrubX","tic","widget","style","left","tics","minimumDuration","maximumDuration","epsilon","minSize","duration","timeBarWidth","epsilonTime","min","gregorianDate","fromDate","Date","UTC","endTime","getStartTic","ticScale","getNextTic","ceil","getAlpha","remainder","x","y","sampleWidth","offsetWidth","origMinSize","renderState","forEach","highlightRange","render","mainTic","subTic","tinyTic","idealTic","ticIndex","smallestIndex","i","ticScaleLen","sc","abs","lastTextLeft","textWidth","leapSecond","computeTaiMinusUtc","ticTime","ticLeap","ticLeft","ticLabel","labelLeft","lastChild","clearRect","width","height","track","scrubElement","_setTimeBarTime","clientX","timeSeconds","timeJulian","timeline","e","button","backgroundPosition","preventDefault","dx","getBoundingClientRect","dsec","pow","dy","wheelDeltaY","wheelDelta","detail","max","len","touches","leftX","newCenter","newSpan","newStartTime","changedTouches","clientHeight","trackListHeight"],"mappings":"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","sourcesContent":["import ClockRange from \"../../Core/ClockRange.js\";\nimport defined from \"../../Core/defined.js\";\nimport destroyObject from \"../../Core/destroyObject.js\";\nimport DeveloperError from \"../../Core/DeveloperError.js\";\nimport JulianDate from \"../../Core/JulianDate.js\";\nimport getElement from \"../getElement.js\";\nimport TimelineHighlightRange from \"./TimelineHighlightRange.js\";\nimport TimelineTrack from \"./TimelineTrack.js\";\n\nvar timelineWheelDelta = 1e12;\n\nvar timelineMouseMode = {\n  none: 0,\n  scrub: 1,\n  slide: 2,\n  zoom: 3,\n  touchOnly: 4,\n};\nvar timelineTouchMode = {\n  none: 0,\n  scrub: 1,\n  slideZoom: 2,\n  singleTap: 3,\n  ignore: 4,\n};\n\nvar timelineTicScales = [\n  0.001,\n  0.002,\n  0.005,\n  0.01,\n  0.02,\n  0.05,\n  0.1,\n  0.25,\n  0.5,\n  1.0,\n  2.0,\n  5.0,\n  10.0,\n  15.0,\n  30.0,\n  60.0, // 1min\n  120.0, // 2min\n  300.0, // 5min\n  600.0, // 10min\n  900.0, // 15min\n  1800.0, // 30min\n  3600.0, // 1hr\n  7200.0, // 2hr\n  14400.0, // 4hr\n  21600.0, // 6hr\n  43200.0, // 12hr\n  86400.0, // 24hr\n  172800.0, // 2days\n  345600.0, // 4days\n  604800.0, // 7days\n  1296000.0, // 15days\n  2592000.0, // 30days\n  5184000.0, // 60days\n  7776000.0, // 90days\n  15552000.0, // 180days\n  31536000.0, // 365days\n  63072000.0, // 2years\n  126144000.0, // 4years\n  157680000.0, // 5years\n  315360000.0, // 10years\n  630720000.0, // 20years\n  1261440000.0, // 40years\n  1576800000.0, // 50years\n  3153600000.0, // 100years\n  6307200000.0, // 200years\n  12614400000.0, // 400years\n  15768000000.0, // 500years\n  31536000000.0, // 1000years\n];\n\nvar timelineMonthNames = [\n  \"Jan\",\n  \"Feb\",\n  \"Mar\",\n  \"Apr\",\n  \"May\",\n  \"Jun\",\n  \"Jul\",\n  \"Aug\",\n  \"Sep\",\n  \"Oct\",\n  \"Nov\",\n  \"Dec\",\n];\n\n/**\n * The Timeline is a widget for displaying and controlling the current scene time.\n * @alias Timeline\n * @constructor\n *\n * @param {Element} container The parent HTML container node for this widget.\n * @param {Clock} clock The clock to use.\n */\nfunction Timeline(container, clock) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(container)) {\n    throw new DeveloperError(\"container is required.\");\n  }\n  if (!defined(clock)) {\n    throw new DeveloperError(\"clock is required.\");\n  }\n  //>>includeEnd('debug');\n\n  container = getElement(container);\n\n  var ownerDocument = container.ownerDocument;\n\n  /**\n   * Gets the parent container.\n   * @type {Element}\n   */\n  this.container = container;\n\n  var topDiv = ownerDocument.createElement(\"div\");\n  topDiv.className = \"cesium-timeline-main\";\n  container.appendChild(topDiv);\n  this._topDiv = topDiv;\n\n  this._endJulian = undefined;\n  this._epochJulian = undefined;\n  this._lastXPos = undefined;\n  this._scrubElement = undefined;\n  this._startJulian = undefined;\n  this._timeBarSecondsSpan = undefined;\n  this._clock = clock;\n  this._scrubJulian = clock.currentTime;\n  this._mainTicSpan = -1;\n  this._mouseMode = timelineMouseMode.none;\n  this._touchMode = timelineTouchMode.none;\n  this._touchState = {\n    centerX: 0,\n    spanX: 0,\n  };\n  this._mouseX = 0;\n  this._timelineDrag = 0;\n  this._timelineDragLocation = undefined;\n  this._lastHeight = undefined;\n  this._lastWidth = undefined;\n\n  this._topDiv.innerHTML =\n    '<div class=\"cesium-timeline-bar\"></div><div class=\"cesium-timeline-trackContainer\">' +\n    '<canvas class=\"cesium-timeline-tracks\" width=\"10\" height=\"1\">' +\n    '</canvas></div><div class=\"cesium-timeline-needle\"></div><span class=\"cesium-timeline-ruler\"></span>';\n  this._timeBarEle = this._topDiv.childNodes[0];\n  this._trackContainer = this._topDiv.childNodes[1];\n  this._trackListEle = this._topDiv.childNodes[1].childNodes[0];\n  this._needleEle = this._topDiv.childNodes[2];\n  this._rulerEle = this._topDiv.childNodes[3];\n  this._context = this._trackListEle.getContext(\"2d\");\n\n  this._trackList = [];\n  this._highlightRanges = [];\n\n  this.zoomTo(clock.startTime, clock.stopTime);\n\n  this._onMouseDown = createMouseDownCallback(this);\n  this._onMouseUp = createMouseUpCallback(this);\n  this._onMouseMove = createMouseMoveCallback(this);\n  this._onMouseWheel = createMouseWheelCallback(this);\n  this._onTouchStart = createTouchStartCallback(this);\n  this._onTouchMove = createTouchMoveCallback(this);\n  this._onTouchEnd = createTouchEndCallback(this);\n\n  var timeBarEle = this._timeBarEle;\n  ownerDocument.addEventListener(\"mouseup\", this._onMouseUp, false);\n  ownerDocument.addEventListener(\"mousemove\", this._onMouseMove, false);\n  timeBarEle.addEventListener(\"mousedown\", this._onMouseDown, false);\n  timeBarEle.addEventListener(\"DOMMouseScroll\", this._onMouseWheel, false); // Mozilla mouse wheel\n  timeBarEle.addEventListener(\"mousewheel\", this._onMouseWheel, false);\n  timeBarEle.addEventListener(\"touchstart\", this._onTouchStart, false);\n  timeBarEle.addEventListener(\"touchmove\", this._onTouchMove, false);\n  timeBarEle.addEventListener(\"touchend\", this._onTouchEnd, false);\n  timeBarEle.addEventListener(\"touchcancel\", this._onTouchEnd, false);\n\n  this._topDiv.oncontextmenu = function () {\n    return false;\n  };\n\n  clock.onTick.addEventListener(this.updateFromClock, this);\n  this.updateFromClock();\n}\n\n/**\n * @private\n */\nTimeline.prototype.addEventListener = function (type, listener, useCapture) {\n  this._topDiv.addEventListener(type, listener, useCapture);\n};\n\n/**\n * @private\n */\nTimeline.prototype.removeEventListener = function (type, listener, useCapture) {\n  this._topDiv.removeEventListener(type, listener, useCapture);\n};\n\n/**\n * @returns {Boolean} true if the object has been destroyed, false otherwise.\n */\nTimeline.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the widget.  Should be called if permanently\n * removing the widget from layout.\n */\nTimeline.prototype.destroy = function () {\n  this._clock.onTick.removeEventListener(this.updateFromClock, this);\n\n  var doc = this.container.ownerDocument;\n  doc.removeEventListener(\"mouseup\", this._onMouseUp, false);\n  doc.removeEventListener(\"mousemove\", this._onMouseMove, false);\n\n  var timeBarEle = this._timeBarEle;\n  timeBarEle.removeEventListener(\"mousedown\", this._onMouseDown, false);\n  timeBarEle.removeEventListener(\"DOMMouseScroll\", this._onMouseWheel, false); // Mozilla mouse wheel\n  timeBarEle.removeEventListener(\"mousewheel\", this._onMouseWheel, false);\n  timeBarEle.removeEventListener(\"touchstart\", this._onTouchStart, false);\n  timeBarEle.removeEventListener(\"touchmove\", this._onTouchMove, false);\n  timeBarEle.removeEventListener(\"touchend\", this._onTouchEnd, false);\n  timeBarEle.removeEventListener(\"touchcancel\", this._onTouchEnd, false);\n  this.container.removeChild(this._topDiv);\n  destroyObject(this);\n};\n\n/**\n * @private\n */\nTimeline.prototype.addHighlightRange = function (color, heightInPx, base) {\n  var newHighlightRange = new TimelineHighlightRange(color, heightInPx, base);\n  this._highlightRanges.push(newHighlightRange);\n  this.resize();\n  return newHighlightRange;\n};\n\n/**\n * @private\n */\nTimeline.prototype.addTrack = function (\n  interval,\n  heightInPx,\n  color,\n  backgroundColor\n) {\n  var newTrack = new TimelineTrack(\n    interval,\n    heightInPx,\n    color,\n    backgroundColor\n  );\n  this._trackList.push(newTrack);\n  this._lastHeight = undefined;\n  this.resize();\n  return newTrack;\n};\n\n/**\n * Sets the view to the provided times.\n *\n * @param {JulianDate} startTime The start time.\n * @param {JulianDate} stopTime The stop time.\n */\nTimeline.prototype.zoomTo = function (startTime, stopTime) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(startTime)) {\n    throw new DeveloperError(\"startTime is required.\");\n  }\n  if (!defined(stopTime)) {\n    throw new DeveloperError(\"stopTime is required\");\n  }\n  if (JulianDate.lessThanOrEquals(stopTime, startTime)) {\n    throw new DeveloperError(\"Start time must come before end time.\");\n  }\n  //>>includeEnd('debug');\n\n  this._startJulian = startTime;\n  this._endJulian = stopTime;\n  this._timeBarSecondsSpan = JulianDate.secondsDifference(stopTime, startTime);\n\n  // If clock is not unbounded, clamp timeline range to clock.\n  if (this._clock && this._clock.clockRange !== ClockRange.UNBOUNDED) {\n    var clockStart = this._clock.startTime;\n    var clockEnd = this._clock.stopTime;\n    var clockSpan = JulianDate.secondsDifference(clockEnd, clockStart);\n    var startOffset = JulianDate.secondsDifference(\n      clockStart,\n      this._startJulian\n    );\n    var endOffset = JulianDate.secondsDifference(clockEnd, this._endJulian);\n\n    if (this._timeBarSecondsSpan >= clockSpan) {\n      // if new duration longer than clock range duration, clamp to full range.\n      this._timeBarSecondsSpan = clockSpan;\n      this._startJulian = this._clock.startTime;\n      this._endJulian = this._clock.stopTime;\n    } else if (startOffset > 0) {\n      // if timeline start is before clock start, shift right\n      this._endJulian = JulianDate.addSeconds(\n        this._endJulian,\n        startOffset,\n        new JulianDate()\n      );\n      this._startJulian = clockStart;\n      this._timeBarSecondsSpan = JulianDate.secondsDifference(\n        this._endJulian,\n        this._startJulian\n      );\n    } else if (endOffset < 0) {\n      // if timeline end is after clock end, shift left\n      this._startJulian = JulianDate.addSeconds(\n        this._startJulian,\n        endOffset,\n        new JulianDate()\n      );\n      this._endJulian = clockEnd;\n      this._timeBarSecondsSpan = JulianDate.secondsDifference(\n        this._endJulian,\n        this._startJulian\n      );\n    }\n  }\n\n  this._makeTics();\n\n  var evt = document.createEvent(\"Event\");\n  evt.initEvent(\"setzoom\", true, true);\n  evt.startJulian = this._startJulian;\n  evt.endJulian = this._endJulian;\n  evt.epochJulian = this._epochJulian;\n  evt.totalSpan = this._timeBarSecondsSpan;\n  evt.mainTicSpan = this._mainTicSpan;\n  this._topDiv.dispatchEvent(evt);\n};\n\n/**\n * @private\n */\nTimeline.prototype.zoomFrom = function (amount) {\n  var centerSec = JulianDate.secondsDifference(\n    this._scrubJulian,\n    this._startJulian\n  );\n  if (amount > 1 || centerSec < 0 || centerSec > this._timeBarSecondsSpan) {\n    centerSec = this._timeBarSecondsSpan * 0.5;\n  } else {\n    centerSec += centerSec - this._timeBarSecondsSpan * 0.5;\n  }\n  var centerSecFlip = this._timeBarSecondsSpan - centerSec;\n  this.zoomTo(\n    JulianDate.addSeconds(\n      this._startJulian,\n      centerSec - centerSec * amount,\n      new JulianDate()\n    ),\n    JulianDate.addSeconds(\n      this._endJulian,\n      centerSecFlip * amount - centerSecFlip,\n      new JulianDate()\n    )\n  );\n};\n\nfunction twoDigits(num) {\n  return num < 10 ? \"0\" + num.toString() : num.toString();\n}\n\n/**\n * @private\n */\nTimeline.prototype.makeLabel = function (time) {\n  var gregorian = JulianDate.toGregorianDate(time);\n  var millisecond = gregorian.millisecond,\n    millisecondString = \" UTC\";\n  if (millisecond > 0 && this._timeBarSecondsSpan < 3600) {\n    millisecondString = Math.floor(millisecond).toString();\n    while (millisecondString.length < 3) {\n      millisecondString = \"0\" + millisecondString;\n    }\n    millisecondString = \".\" + millisecondString;\n  }\n\n  return (\n    timelineMonthNames[gregorian.month - 1] +\n    \" \" +\n    gregorian.day +\n    \" \" +\n    gregorian.year +\n    \" \" +\n    twoDigits(gregorian.hour) +\n    \":\" +\n    twoDigits(gregorian.minute) +\n    \":\" +\n    twoDigits(gregorian.second) +\n    millisecondString\n  );\n};\n\n/**\n * @private\n */\nTimeline.prototype.smallestTicInPixels = 7.0;\n\n/**\n * @private\n */\nTimeline.prototype._makeTics = function () {\n  var timeBar = this._timeBarEle;\n\n  var seconds = JulianDate.secondsDifference(\n    this._scrubJulian,\n    this._startJulian\n  );\n  var xPos = Math.round(\n    (seconds * this._topDiv.clientWidth) / this._timeBarSecondsSpan\n  );\n  var scrubX = xPos - 8,\n    tic;\n  var widget = this;\n\n  this._needleEle.style.left = xPos.toString() + \"px\";\n\n  var tics = \"\";\n\n  var minimumDuration = 0.01;\n  var maximumDuration = 31536000000.0; // ~1000 years\n  var epsilon = 1e-10;\n\n  // If time step size is known, enter it here...\n  var minSize = 0;\n\n  var duration = this._timeBarSecondsSpan;\n  if (duration < minimumDuration) {\n    duration = minimumDuration;\n    this._timeBarSecondsSpan = minimumDuration;\n    this._endJulian = JulianDate.addSeconds(\n      this._startJulian,\n      minimumDuration,\n      new JulianDate()\n    );\n  } else if (duration > maximumDuration) {\n    duration = maximumDuration;\n    this._timeBarSecondsSpan = maximumDuration;\n    this._endJulian = JulianDate.addSeconds(\n      this._startJulian,\n      maximumDuration,\n      new JulianDate()\n    );\n  }\n\n  var timeBarWidth = this._timeBarEle.clientWidth;\n  if (timeBarWidth < 10) {\n    timeBarWidth = 10;\n  }\n  var startJulian = this._startJulian;\n\n  // epsilonTime: a small fraction of one pixel width of the timeline, measured in seconds.\n  var epsilonTime = Math.min((duration / timeBarWidth) * 1e-5, 0.4);\n\n  // epochJulian: a nearby time to be considered \"zero seconds\", should be a round-ish number by human standards.\n  var epochJulian;\n  var gregorianDate = JulianDate.toGregorianDate(startJulian);\n  if (duration > 315360000) {\n    // 3650+ days visible, epoch is start of the first visible century.\n    epochJulian = JulianDate.fromDate(\n      new Date(Date.UTC(Math.floor(gregorianDate.year / 100) * 100, 0))\n    );\n  } else if (duration > 31536000) {\n    // 365+ days visible, epoch is start of the first visible decade.\n    epochJulian = JulianDate.fromDate(\n      new Date(Date.UTC(Math.floor(gregorianDate.year / 10) * 10, 0))\n    );\n  } else if (duration > 86400) {\n    // 1+ day(s) visible, epoch is start of the year.\n    epochJulian = JulianDate.fromDate(\n      new Date(Date.UTC(gregorianDate.year, 0))\n    );\n  } else {\n    // Less than a day on timeline, epoch is midnight of the visible day.\n    epochJulian = JulianDate.fromDate(\n      new Date(\n        Date.UTC(gregorianDate.year, gregorianDate.month, gregorianDate.day)\n      )\n    );\n  }\n\n  // startTime: Seconds offset of the left side of the timeline from epochJulian.\n  var startTime = JulianDate.secondsDifference(\n    this._startJulian,\n    JulianDate.addSeconds(epochJulian, epsilonTime, new JulianDate())\n  );\n  // endTime: Seconds offset of the right side of the timeline from epochJulian.\n  var endTime = startTime + duration;\n  this._epochJulian = epochJulian;\n\n  function getStartTic(ticScale) {\n    return Math.floor(startTime / ticScale) * ticScale;\n  }\n\n  function getNextTic(tic, ticScale) {\n    return Math.ceil(tic / ticScale + 0.5) * ticScale;\n  }\n\n  function getAlpha(time) {\n    return (time - startTime) / duration;\n  }\n\n  function remainder(x, y) {\n    //return x % y;\n    return x - y * Math.round(x / y);\n  }\n\n  // Width in pixels of a typical label, plus padding\n  this._rulerEle.innerHTML = this.makeLabel(\n    JulianDate.addSeconds(this._endJulian, -minimumDuration, new JulianDate())\n  );\n  var sampleWidth = this._rulerEle.offsetWidth + 20;\n  if (sampleWidth < 30) {\n    // Workaround an apparent IE bug with measuring the width after going full-screen from inside an iframe.\n    sampleWidth = 180;\n  }\n\n  var origMinSize = minSize;\n  minSize -= epsilon;\n\n  var renderState = {\n    startTime: startTime,\n    startJulian: startJulian,\n    epochJulian: epochJulian,\n    duration: duration,\n    timeBarWidth: timeBarWidth,\n    getAlpha: getAlpha,\n  };\n  this._highlightRanges.forEach(function (highlightRange) {\n    tics += highlightRange.render(renderState);\n  });\n\n  // Calculate tic mark label spacing in the TimeBar.\n  var mainTic = 0.0,\n    subTic = 0.0,\n    tinyTic = 0.0;\n  // Ideal labeled tic as percentage of zoom interval\n  var idealTic = sampleWidth / timeBarWidth;\n  if (idealTic > 1.0) {\n    // Clamp to width of window, for thin windows.\n    idealTic = 1.0;\n  }\n  // Ideal labeled tic size in seconds\n  idealTic *= this._timeBarSecondsSpan;\n  var ticIndex = -1,\n    smallestIndex = -1;\n\n  var i,\n    ticScaleLen = timelineTicScales.length;\n  for (i = 0; i < ticScaleLen; ++i) {\n    var sc = timelineTicScales[i];\n    ++ticIndex;\n    mainTic = sc;\n    // Find acceptable main tic size not smaller than ideal size.\n    if (sc > idealTic && sc > minSize) {\n      break;\n    }\n    if (\n      smallestIndex < 0 &&\n      timeBarWidth * (sc / this._timeBarSecondsSpan) >= this.smallestTicInPixels\n    ) {\n      smallestIndex = ticIndex;\n    }\n  }\n  if (ticIndex > 0) {\n    while (ticIndex > 0) {\n      // Compute sub-tic size that evenly divides main tic.\n      --ticIndex;\n      if (Math.abs(remainder(mainTic, timelineTicScales[ticIndex])) < 0.00001) {\n        if (timelineTicScales[ticIndex] >= minSize) {\n          subTic = timelineTicScales[ticIndex];\n        }\n        break;\n      }\n    }\n\n    if (smallestIndex >= 0) {\n      while (smallestIndex < ticIndex) {\n        // Compute tiny tic size that evenly divides sub-tic.\n        if (\n          Math.abs(remainder(subTic, timelineTicScales[smallestIndex])) <\n            0.00001 &&\n          timelineTicScales[smallestIndex] >= minSize\n        ) {\n          tinyTic = timelineTicScales[smallestIndex];\n          break;\n        }\n        ++smallestIndex;\n      }\n    }\n  }\n\n  minSize = origMinSize;\n  if (\n    minSize > epsilon &&\n    tinyTic < 0.00001 &&\n    Math.abs(minSize - mainTic) > epsilon\n  ) {\n    tinyTic = minSize;\n    if (minSize <= mainTic + epsilon) {\n      subTic = 0.0;\n    }\n  }\n\n  var lastTextLeft = -999999,\n    textWidth;\n  if (timeBarWidth * (tinyTic / this._timeBarSecondsSpan) >= 3.0) {\n    for (\n      tic = getStartTic(tinyTic);\n      tic <= endTime;\n      tic = getNextTic(tic, tinyTic)\n    ) {\n      tics +=\n        '<span class=\"cesium-timeline-ticTiny\" style=\"left: ' +\n        Math.round(timeBarWidth * getAlpha(tic)).toString() +\n        'px;\"></span>';\n    }\n  }\n  if (timeBarWidth * (subTic / this._timeBarSecondsSpan) >= 3.0) {\n    for (\n      tic = getStartTic(subTic);\n      tic <= endTime;\n      tic = getNextTic(tic, subTic)\n    ) {\n      tics +=\n        '<span class=\"cesium-timeline-ticSub\" style=\"left: ' +\n        Math.round(timeBarWidth * getAlpha(tic)).toString() +\n        'px;\"></span>';\n    }\n  }\n  if (timeBarWidth * (mainTic / this._timeBarSecondsSpan) >= 2.0) {\n    this._mainTicSpan = mainTic;\n    endTime += mainTic;\n    tic = getStartTic(mainTic);\n    var leapSecond = JulianDate.computeTaiMinusUtc(epochJulian);\n    while (tic <= endTime) {\n      var ticTime = JulianDate.addSeconds(\n        startJulian,\n        tic - startTime,\n        new JulianDate()\n      );\n      if (mainTic > 2.1) {\n        var ticLeap = JulianDate.computeTaiMinusUtc(ticTime);\n        if (Math.abs(ticLeap - leapSecond) > 0.1) {\n          tic += ticLeap - leapSecond;\n          ticTime = JulianDate.addSeconds(\n            startJulian,\n            tic - startTime,\n            new JulianDate()\n          );\n        }\n      }\n      var ticLeft = Math.round(timeBarWidth * getAlpha(tic));\n      var ticLabel = this.makeLabel(ticTime);\n      this._rulerEle.innerHTML = ticLabel;\n      textWidth = this._rulerEle.offsetWidth;\n      if (textWidth < 10) {\n        // IE iframe fullscreen sampleWidth workaround, continued.\n        textWidth = sampleWidth;\n      }\n      var labelLeft = ticLeft - (textWidth / 2 - 1);\n      if (labelLeft > lastTextLeft) {\n        lastTextLeft = labelLeft + textWidth + 5;\n        tics +=\n          '<span class=\"cesium-timeline-ticMain\" style=\"left: ' +\n          ticLeft.toString() +\n          'px;\"></span>' +\n          '<span class=\"cesium-timeline-ticLabel\" style=\"left: ' +\n          labelLeft.toString() +\n          'px;\">' +\n          ticLabel +\n          \"</span>\";\n      } else {\n        tics +=\n          '<span class=\"cesium-timeline-ticSub\" style=\"left: ' +\n          ticLeft.toString() +\n          'px;\"></span>';\n      }\n      tic = getNextTic(tic, mainTic);\n    }\n  } else {\n    this._mainTicSpan = -1;\n  }\n\n  tics +=\n    '<span class=\"cesium-timeline-icon16\" style=\"left:' +\n    scrubX +\n    'px;bottom:0;background-position: 0 0;\"></span>';\n  timeBar.innerHTML = tics;\n  this._scrubElement = timeBar.lastChild;\n\n  // Clear track canvas.\n  this._context.clearRect(\n    0,\n    0,\n    this._trackListEle.width,\n    this._trackListEle.height\n  );\n\n  renderState.y = 0;\n  this._trackList.forEach(function (track) {\n    track.render(widget._context, renderState);\n    renderState.y += track.height;\n  });\n};\n\n/**\n * @private\n */\nTimeline.prototype.updateFromClock = function () {\n  this._scrubJulian = this._clock.currentTime;\n  var scrubElement = this._scrubElement;\n  if (defined(this._scrubElement)) {\n    var seconds = JulianDate.secondsDifference(\n      this._scrubJulian,\n      this._startJulian\n    );\n    var xPos = Math.round(\n      (seconds * this._topDiv.clientWidth) / this._timeBarSecondsSpan\n    );\n\n    if (this._lastXPos !== xPos) {\n      this._lastXPos = xPos;\n\n      scrubElement.style.left = xPos - 8 + \"px\";\n      this._needleEle.style.left = xPos + \"px\";\n    }\n  }\n  if (defined(this._timelineDragLocation)) {\n    this._setTimeBarTime(\n      this._timelineDragLocation,\n      (this._timelineDragLocation * this._timeBarSecondsSpan) /\n        this._topDiv.clientWidth\n    );\n    this.zoomTo(\n      JulianDate.addSeconds(\n        this._startJulian,\n        this._timelineDrag,\n        new JulianDate()\n      ),\n      JulianDate.addSeconds(\n        this._endJulian,\n        this._timelineDrag,\n        new JulianDate()\n      )\n    );\n  }\n};\n\n/**\n * @private\n */\nTimeline.prototype._setTimeBarTime = function (xPos, seconds) {\n  xPos = Math.round(xPos);\n  this._scrubJulian = JulianDate.addSeconds(\n    this._startJulian,\n    seconds,\n    new JulianDate()\n  );\n  if (this._scrubElement) {\n    var scrubX = xPos - 8;\n    this._scrubElement.style.left = scrubX.toString() + \"px\";\n    this._needleEle.style.left = xPos.toString() + \"px\";\n  }\n\n  var evt = document.createEvent(\"Event\");\n  evt.initEvent(\"settime\", true, true);\n  evt.clientX = xPos;\n  evt.timeSeconds = seconds;\n  evt.timeJulian = this._scrubJulian;\n  evt.clock = this._clock;\n  this._topDiv.dispatchEvent(evt);\n};\n\nfunction createMouseDownCallback(timeline) {\n  return function (e) {\n    if (timeline._mouseMode !== timelineMouseMode.touchOnly) {\n      if (e.button === 0) {\n        timeline._mouseMode = timelineMouseMode.scrub;\n        if (timeline._scrubElement) {\n          timeline._scrubElement.style.backgroundPosition = \"-16px 0\";\n        }\n        timeline._onMouseMove(e);\n      } else {\n        timeline._mouseX = e.clientX;\n        if (e.button === 2) {\n          timeline._mouseMode = timelineMouseMode.zoom;\n        } else {\n          timeline._mouseMode = timelineMouseMode.slide;\n        }\n      }\n    }\n    e.preventDefault();\n  };\n}\n\nfunction createMouseUpCallback(timeline) {\n  return function (e) {\n    timeline._mouseMode = timelineMouseMode.none;\n    if (timeline._scrubElement) {\n      timeline._scrubElement.style.backgroundPosition = \"0 0\";\n    }\n    timeline._timelineDrag = 0;\n    timeline._timelineDragLocation = undefined;\n  };\n}\n\nfunction createMouseMoveCallback(timeline) {\n  return function (e) {\n    var dx;\n    if (timeline._mouseMode === timelineMouseMode.scrub) {\n      e.preventDefault();\n      var x = e.clientX - timeline._topDiv.getBoundingClientRect().left;\n\n      if (x < 0) {\n        timeline._timelineDragLocation = 0;\n        timeline._timelineDrag = -0.01 * timeline._timeBarSecondsSpan;\n      } else if (x > timeline._topDiv.clientWidth) {\n        timeline._timelineDragLocation = timeline._topDiv.clientWidth;\n        timeline._timelineDrag = 0.01 * timeline._timeBarSecondsSpan;\n      } else {\n        timeline._timelineDragLocation = undefined;\n        timeline._setTimeBarTime(\n          x,\n          (x * timeline._timeBarSecondsSpan) / timeline._topDiv.clientWidth\n        );\n      }\n    } else if (timeline._mouseMode === timelineMouseMode.slide) {\n      dx = timeline._mouseX - e.clientX;\n      timeline._mouseX = e.clientX;\n      if (dx !== 0) {\n        var dsec =\n          (dx * timeline._timeBarSecondsSpan) / timeline._topDiv.clientWidth;\n        timeline.zoomTo(\n          JulianDate.addSeconds(timeline._startJulian, dsec, new JulianDate()),\n          JulianDate.addSeconds(timeline._endJulian, dsec, new JulianDate())\n        );\n      }\n    } else if (timeline._mouseMode === timelineMouseMode.zoom) {\n      dx = timeline._mouseX - e.clientX;\n      timeline._mouseX = e.clientX;\n      if (dx !== 0) {\n        timeline.zoomFrom(Math.pow(1.01, dx));\n      }\n    }\n  };\n}\n\nfunction createMouseWheelCallback(timeline) {\n  return function (e) {\n    var dy = e.wheelDeltaY || e.wheelDelta || -e.detail;\n    timelineWheelDelta = Math.max(\n      Math.min(Math.abs(dy), timelineWheelDelta),\n      1\n    );\n    dy /= timelineWheelDelta;\n    timeline.zoomFrom(Math.pow(1.05, -dy));\n  };\n}\n\nfunction createTouchStartCallback(timeline) {\n  return function (e) {\n    var len = e.touches.length,\n      seconds,\n      xPos,\n      leftX = timeline._topDiv.getBoundingClientRect().left;\n    e.preventDefault();\n    timeline._mouseMode = timelineMouseMode.touchOnly;\n    if (len === 1) {\n      seconds = JulianDate.secondsDifference(\n        timeline._scrubJulian,\n        timeline._startJulian\n      );\n      xPos = Math.round(\n        (seconds * timeline._topDiv.clientWidth) /\n          timeline._timeBarSecondsSpan +\n          leftX\n      );\n      if (Math.abs(e.touches[0].clientX - xPos) < 50) {\n        timeline._touchMode = timelineTouchMode.scrub;\n        if (timeline._scrubElement) {\n          timeline._scrubElement.style.backgroundPosition =\n            len === 1 ? \"-16px 0\" : \"0 0\";\n        }\n      } else {\n        timeline._touchMode = timelineTouchMode.singleTap;\n        timeline._touchState.centerX = e.touches[0].clientX - leftX;\n      }\n    } else if (len === 2) {\n      timeline._touchMode = timelineTouchMode.slideZoom;\n      timeline._touchState.centerX =\n        (e.touches[0].clientX + e.touches[1].clientX) * 0.5 - leftX;\n      timeline._touchState.spanX = Math.abs(\n        e.touches[0].clientX - e.touches[1].clientX\n      );\n    } else {\n      timeline._touchMode = timelineTouchMode.ignore;\n    }\n  };\n}\n\nfunction createTouchEndCallback(timeline) {\n  return function (e) {\n    var len = e.touches.length,\n      leftX = timeline._topDiv.getBoundingClientRect().left;\n    if (timeline._touchMode === timelineTouchMode.singleTap) {\n      timeline._touchMode = timelineTouchMode.scrub;\n      timeline._onTouchMove(e);\n    } else if (timeline._touchMode === timelineTouchMode.scrub) {\n      timeline._onTouchMove(e);\n    }\n    timeline._mouseMode = timelineMouseMode.touchOnly;\n    if (len !== 1) {\n      timeline._touchMode =\n        len > 0 ? timelineTouchMode.ignore : timelineTouchMode.none;\n    } else if (timeline._touchMode === timelineTouchMode.slideZoom) {\n      timeline._touchState.centerX = e.touches[0].clientX - leftX;\n    }\n    if (timeline._scrubElement) {\n      timeline._scrubElement.style.backgroundPosition = \"0 0\";\n    }\n  };\n}\n\nfunction createTouchMoveCallback(timeline) {\n  return function (e) {\n    var dx,\n      x,\n      len,\n      newCenter,\n      newSpan,\n      newStartTime,\n      zoom = 1,\n      leftX = timeline._topDiv.getBoundingClientRect().left;\n    if (timeline._touchMode === timelineTouchMode.singleTap) {\n      timeline._touchMode = timelineTouchMode.slideZoom;\n    }\n    timeline._mouseMode = timelineMouseMode.touchOnly;\n    if (timeline._touchMode === timelineTouchMode.scrub) {\n      e.preventDefault();\n      if (e.changedTouches.length === 1) {\n        x = e.changedTouches[0].clientX - leftX;\n        if (x >= 0 && x <= timeline._topDiv.clientWidth) {\n          timeline._setTimeBarTime(\n            x,\n            (x * timeline._timeBarSecondsSpan) / timeline._topDiv.clientWidth\n          );\n        }\n      }\n    } else if (timeline._touchMode === timelineTouchMode.slideZoom) {\n      len = e.touches.length;\n      if (len === 2) {\n        newCenter = (e.touches[0].clientX + e.touches[1].clientX) * 0.5 - leftX;\n        newSpan = Math.abs(e.touches[0].clientX - e.touches[1].clientX);\n      } else if (len === 1) {\n        newCenter = e.touches[0].clientX - leftX;\n        newSpan = 0;\n      }\n\n      if (defined(newCenter)) {\n        if (newSpan > 0 && timeline._touchState.spanX > 0) {\n          // Zoom and slide\n          zoom = timeline._touchState.spanX / newSpan;\n          newStartTime = JulianDate.addSeconds(\n            timeline._startJulian,\n            (timeline._touchState.centerX * timeline._timeBarSecondsSpan -\n              newCenter * timeline._timeBarSecondsSpan * zoom) /\n              timeline._topDiv.clientWidth,\n            new JulianDate()\n          );\n        } else {\n          // Slide to newCenter\n          dx = timeline._touchState.centerX - newCenter;\n          newStartTime = JulianDate.addSeconds(\n            timeline._startJulian,\n            (dx * timeline._timeBarSecondsSpan) / timeline._topDiv.clientWidth,\n            new JulianDate()\n          );\n        }\n\n        timeline.zoomTo(\n          newStartTime,\n          JulianDate.addSeconds(\n            newStartTime,\n            timeline._timeBarSecondsSpan * zoom,\n            new JulianDate()\n          )\n        );\n        timeline._touchState.centerX = newCenter;\n        timeline._touchState.spanX = newSpan;\n      }\n    }\n  };\n}\n\n/**\n * Resizes the widget to match the container size.\n */\nTimeline.prototype.resize = function () {\n  var width = this.container.clientWidth;\n  var height = this.container.clientHeight;\n\n  if (width === this._lastWidth && height === this._lastHeight) {\n    return;\n  }\n\n  this._trackContainer.style.height = height + \"px\";\n\n  var trackListHeight = 1;\n  this._trackList.forEach(function (track) {\n    trackListHeight += track.height;\n  });\n  this._trackListEle.style.height = trackListHeight.toString() + \"px\";\n  this._trackListEle.width = this._trackListEle.clientWidth;\n  this._trackListEle.height = trackListHeight;\n  this._makeTics();\n\n  this._lastXPos = undefined;\n  this._lastWidth = width;\n  this._lastHeight = height;\n};\nexport default Timeline;\n"]},"metadata":{},"sourceType":"module"}