{"ast":null,"code":"import Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport Color from \"../Core/Color.js\";\nimport ColorGeometryInstanceAttribute from \"../Core/ColorGeometryInstanceAttribute.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport DistanceDisplayConditionGeometryInstanceAttribute from \"../Core/DistanceDisplayConditionGeometryInstanceAttribute.js\";\nimport GeometryInstance from \"../Core/GeometryInstance.js\";\nimport Iso8601 from \"../Core/Iso8601.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport Matrix3 from \"../Core/Matrix3.js\";\nimport Matrix4 from \"../Core/Matrix4.js\";\nimport PlaneGeometry from \"../Core/PlaneGeometry.js\";\nimport PlaneOutlineGeometry from \"../Core/PlaneOutlineGeometry.js\";\nimport Quaternion from \"../Core/Quaternion.js\";\nimport ShowGeometryInstanceAttribute from \"../Core/ShowGeometryInstanceAttribute.js\";\nimport MaterialAppearance from \"../Scene/MaterialAppearance.js\";\nimport PerInstanceColorAppearance from \"../Scene/PerInstanceColorAppearance.js\";\nimport ColorMaterialProperty from \"./ColorMaterialProperty.js\";\nimport DynamicGeometryUpdater from \"./DynamicGeometryUpdater.js\";\nimport GeometryUpdater from \"./GeometryUpdater.js\";\nimport Property from \"./Property.js\";\nvar positionScratch = new Cartesian3();\nvar scratchColor = new Color();\n\nfunction PlaneGeometryOptions(entity) {\n  this.id = entity;\n  this.vertexFormat = undefined;\n  this.plane = undefined;\n  this.dimensions = undefined;\n}\n/**\n * A {@link GeometryUpdater} for planes.\n * Clients do not normally create this class directly, but instead rely on {@link DataSourceDisplay}.\n * @alias PlaneGeometryUpdater\n * @constructor\n *\n * @param {Entity} entity The entity containing the geometry to be visualized.\n * @param {Scene} scene The scene where visualization is taking place.\n */\n\n\nfunction PlaneGeometryUpdater(entity, scene) {\n  GeometryUpdater.call(this, {\n    entity: entity,\n    scene: scene,\n    geometryOptions: new PlaneGeometryOptions(entity),\n    geometryPropertyName: \"plane\",\n    observedPropertyNames: [\"availability\", \"position\", \"orientation\", \"plane\"]\n  });\n\n  this._onEntityPropertyChanged(entity, \"plane\", entity.plane, undefined);\n}\n\nif (defined(Object.create)) {\n  PlaneGeometryUpdater.prototype = Object.create(GeometryUpdater.prototype);\n  PlaneGeometryUpdater.prototype.constructor = PlaneGeometryUpdater;\n}\n/**\n * Creates the geometry instance which represents the fill of the geometry.\n *\n * @param {JulianDate} time The time to use when retrieving initial attribute values.\n * @returns {GeometryInstance} The geometry instance representing the filled portion of the geometry.\n *\n * @exception {DeveloperError} This instance does not represent a filled geometry.\n */\n\n\nPlaneGeometryUpdater.prototype.createFillGeometryInstance = function (time) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"time\", time);\n\n  if (!this._fillEnabled) {\n    throw new DeveloperError(\"This instance does not represent a filled geometry.\");\n  } //>>includeEnd('debug');\n\n\n  var entity = this._entity;\n  var isAvailable = entity.isAvailable(time);\n  var attributes;\n  var color;\n  var show = new ShowGeometryInstanceAttribute(isAvailable && entity.isShowing && this._showProperty.getValue(time) && this._fillProperty.getValue(time));\n\n  var distanceDisplayCondition = this._distanceDisplayConditionProperty.getValue(time);\n\n  var distanceDisplayConditionAttribute = DistanceDisplayConditionGeometryInstanceAttribute.fromDistanceDisplayCondition(distanceDisplayCondition);\n\n  if (this._materialProperty instanceof ColorMaterialProperty) {\n    var currentColor;\n\n    if (defined(this._materialProperty.color) && (this._materialProperty.color.isConstant || isAvailable)) {\n      currentColor = this._materialProperty.color.getValue(time, scratchColor);\n    }\n\n    if (!defined(currentColor)) {\n      currentColor = Color.WHITE;\n    }\n\n    color = ColorGeometryInstanceAttribute.fromColor(currentColor);\n    attributes = {\n      show: show,\n      distanceDisplayCondition: distanceDisplayConditionAttribute,\n      color: color\n    };\n  } else {\n    attributes = {\n      show: show,\n      distanceDisplayCondition: distanceDisplayConditionAttribute\n    };\n  }\n\n  var planeGraphics = entity.plane;\n  var options = this._options;\n  var modelMatrix = entity.computeModelMatrix(time);\n  var plane = Property.getValueOrDefault(planeGraphics.plane, time, options.plane);\n  var dimensions = Property.getValueOrUndefined(planeGraphics.dimensions, time, options.dimensions);\n  options.plane = plane;\n  options.dimensions = dimensions;\n  modelMatrix = createPrimitiveMatrix(plane, dimensions, modelMatrix, this._scene.mapProjection.ellipsoid, modelMatrix);\n  return new GeometryInstance({\n    id: entity,\n    geometry: new PlaneGeometry(this._options),\n    modelMatrix: modelMatrix,\n    attributes: attributes\n  });\n};\n/**\n * Creates the geometry instance which represents the outline of the geometry.\n *\n * @param {JulianDate} time The time to use when retrieving initial attribute values.\n * @returns {GeometryInstance} The geometry instance representing the outline portion of the geometry.\n *\n * @exception {DeveloperError} This instance does not represent an outlined geometry.\n */\n\n\nPlaneGeometryUpdater.prototype.createOutlineGeometryInstance = function (time) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"time\", time);\n\n  if (!this._outlineEnabled) {\n    throw new DeveloperError(\"This instance does not represent an outlined geometry.\");\n  } //>>includeEnd('debug');\n\n\n  var entity = this._entity;\n  var isAvailable = entity.isAvailable(time);\n  var outlineColor = Property.getValueOrDefault(this._outlineColorProperty, time, Color.BLACK, scratchColor);\n\n  var distanceDisplayCondition = this._distanceDisplayConditionProperty.getValue(time);\n\n  var planeGraphics = entity.plane;\n  var options = this._options;\n  var modelMatrix = entity.computeModelMatrix(time);\n  var plane = Property.getValueOrDefault(planeGraphics.plane, time, options.plane);\n  var dimensions = Property.getValueOrUndefined(planeGraphics.dimensions, time, options.dimensions);\n  options.plane = plane;\n  options.dimensions = dimensions;\n  modelMatrix = createPrimitiveMatrix(plane, dimensions, modelMatrix, this._scene.mapProjection.ellipsoid, modelMatrix);\n  return new GeometryInstance({\n    id: entity,\n    geometry: new PlaneOutlineGeometry(),\n    modelMatrix: modelMatrix,\n    attributes: {\n      show: new ShowGeometryInstanceAttribute(isAvailable && entity.isShowing && this._showProperty.getValue(time) && this._showOutlineProperty.getValue(time)),\n      color: ColorGeometryInstanceAttribute.fromColor(outlineColor),\n      distanceDisplayCondition: DistanceDisplayConditionGeometryInstanceAttribute.fromDistanceDisplayCondition(distanceDisplayCondition)\n    }\n  });\n};\n\nPlaneGeometryUpdater.prototype._isHidden = function (entity, plane) {\n  return !defined(plane.plane) || !defined(plane.dimensions) || !defined(entity.position) || GeometryUpdater.prototype._isHidden.call(this, entity, plane);\n};\n\nPlaneGeometryUpdater.prototype._getIsClosed = function (options) {\n  return false;\n};\n\nPlaneGeometryUpdater.prototype._isDynamic = function (entity, plane) {\n  return !entity.position.isConstant || //\n  !Property.isConstant(entity.orientation) || //\n  !plane.plane.isConstant || //\n  !plane.dimensions.isConstant || //\n  !Property.isConstant(plane.outlineWidth);\n};\n\nPlaneGeometryUpdater.prototype._setStaticOptions = function (entity, plane) {\n  var isColorMaterial = this._materialProperty instanceof ColorMaterialProperty;\n  var options = this._options;\n  options.vertexFormat = isColorMaterial ? PerInstanceColorAppearance.VERTEX_FORMAT : MaterialAppearance.MaterialSupport.TEXTURED.vertexFormat;\n  options.plane = plane.plane.getValue(Iso8601.MINIMUM_VALUE, options.plane);\n  options.dimensions = plane.dimensions.getValue(Iso8601.MINIMUM_VALUE, options.dimensions);\n};\n\nPlaneGeometryUpdater.DynamicGeometryUpdater = DynamicPlaneGeometryUpdater;\n/**\n * @private\n */\n\nfunction DynamicPlaneGeometryUpdater(geometryUpdater, primitives, groundPrimitives) {\n  DynamicGeometryUpdater.call(this, geometryUpdater, primitives, groundPrimitives);\n}\n\nif (defined(Object.create)) {\n  DynamicPlaneGeometryUpdater.prototype = Object.create(DynamicGeometryUpdater.prototype);\n  DynamicPlaneGeometryUpdater.prototype.constructor = DynamicPlaneGeometryUpdater;\n}\n\nDynamicPlaneGeometryUpdater.prototype._isHidden = function (entity, plane, time) {\n  var options = this._options;\n  var position = Property.getValueOrUndefined(entity.position, time, positionScratch);\n  return !defined(position) || !defined(options.plane) || !defined(options.dimensions) || DynamicGeometryUpdater.prototype._isHidden.call(this, entity, plane, time);\n};\n\nDynamicPlaneGeometryUpdater.prototype._setOptions = function (entity, plane, time) {\n  var options = this._options;\n  options.plane = Property.getValueOrDefault(plane.plane, time, options.plane);\n  options.dimensions = Property.getValueOrUndefined(plane.dimensions, time, options.dimensions);\n};\n\nvar scratchAxis = new Cartesian3();\nvar scratchAxis2 = new Cartesian3();\nvar scratchTranslation = new Cartesian3();\nvar scratchNormal = new Cartesian3();\nvar scratchScale = new Cartesian3();\nvar scratchQuaternion = new Quaternion();\nvar scratchMatrix3 = new Matrix3();\n\nfunction createPrimitiveMatrix(plane, dimensions, transform, ellipsoid, result) {\n  var normal = plane.normal;\n  var distance = plane.distance;\n  var translation = Cartesian3.multiplyByScalar(normal, -distance, scratchTranslation);\n  translation = Matrix4.multiplyByPoint(transform, translation, translation);\n  var transformedNormal = Matrix4.multiplyByPointAsVector(transform, normal, scratchNormal);\n  Cartesian3.normalize(transformedNormal, transformedNormal);\n  var up = ellipsoid.geodeticSurfaceNormal(translation, scratchAxis2);\n\n  if (CesiumMath.equalsEpsilon(Math.abs(Cartesian3.dot(up, transformedNormal)), 1.0, CesiumMath.EPSILON8)) {\n    up = Cartesian3.clone(Cartesian3.UNIT_Z, up);\n\n    if (CesiumMath.equalsEpsilon(Math.abs(Cartesian3.dot(up, transformedNormal)), 1.0, CesiumMath.EPSILON8)) {\n      up = Cartesian3.clone(Cartesian3.UNIT_X, up);\n    }\n  }\n\n  var left = Cartesian3.cross(up, transformedNormal, scratchAxis);\n  up = Cartesian3.cross(transformedNormal, left, up);\n  Cartesian3.normalize(left, left);\n  Cartesian3.normalize(up, up);\n  var rotationMatrix = scratchMatrix3;\n  Matrix3.setColumn(rotationMatrix, 0, left, rotationMatrix);\n  Matrix3.setColumn(rotationMatrix, 1, up, rotationMatrix);\n  Matrix3.setColumn(rotationMatrix, 2, transformedNormal, rotationMatrix);\n  var rotation = Quaternion.fromRotationMatrix(rotationMatrix, scratchQuaternion);\n  var scale = Cartesian2.clone(dimensions, scratchScale);\n  scale.z = 1.0;\n  return Matrix4.fromTranslationQuaternionRotationScale(translation, rotation, scale, result);\n}\n/**\n * @private\n */\n\n\nPlaneGeometryUpdater.createPrimitiveMatrix = createPrimitiveMatrix;\nexport default PlaneGeometryUpdater;","map":{"version":3,"sources":["C:/Users/passa/Desktop/WaterLevelReact/node_modules/cesium/Source/DataSources/PlaneGeometryUpdater.js"],"names":["Cartesian2","Cartesian3","Check","Color","ColorGeometryInstanceAttribute","defined","DeveloperError","DistanceDisplayConditionGeometryInstanceAttribute","GeometryInstance","Iso8601","CesiumMath","Matrix3","Matrix4","PlaneGeometry","PlaneOutlineGeometry","Quaternion","ShowGeometryInstanceAttribute","MaterialAppearance","PerInstanceColorAppearance","ColorMaterialProperty","DynamicGeometryUpdater","GeometryUpdater","Property","positionScratch","scratchColor","PlaneGeometryOptions","entity","id","vertexFormat","undefined","plane","dimensions","PlaneGeometryUpdater","scene","call","geometryOptions","geometryPropertyName","observedPropertyNames","_onEntityPropertyChanged","Object","create","prototype","constructor","createFillGeometryInstance","time","_fillEnabled","_entity","isAvailable","attributes","color","show","isShowing","_showProperty","getValue","_fillProperty","distanceDisplayCondition","_distanceDisplayConditionProperty","distanceDisplayConditionAttribute","fromDistanceDisplayCondition","_materialProperty","currentColor","isConstant","WHITE","fromColor","planeGraphics","options","_options","modelMatrix","computeModelMatrix","getValueOrDefault","getValueOrUndefined","createPrimitiveMatrix","_scene","mapProjection","ellipsoid","geometry","createOutlineGeometryInstance","_outlineEnabled","outlineColor","_outlineColorProperty","BLACK","_showOutlineProperty","_isHidden","position","_getIsClosed","_isDynamic","orientation","outlineWidth","_setStaticOptions","isColorMaterial","VERTEX_FORMAT","MaterialSupport","TEXTURED","MINIMUM_VALUE","DynamicPlaneGeometryUpdater","geometryUpdater","primitives","groundPrimitives","_setOptions","scratchAxis","scratchAxis2","scratchTranslation","scratchNormal","scratchScale","scratchQuaternion","scratchMatrix3","transform","result","normal","distance","translation","multiplyByScalar","multiplyByPoint","transformedNormal","multiplyByPointAsVector","normalize","up","geodeticSurfaceNormal","equalsEpsilon","Math","abs","dot","EPSILON8","clone","UNIT_Z","UNIT_X","left","cross","rotationMatrix","setColumn","rotation","fromRotationMatrix","scale","z","fromTranslationQuaternionRotationScale"],"mappings":"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","sourcesContent":["import Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport Color from \"../Core/Color.js\";\nimport ColorGeometryInstanceAttribute from \"../Core/ColorGeometryInstanceAttribute.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport DistanceDisplayConditionGeometryInstanceAttribute from \"../Core/DistanceDisplayConditionGeometryInstanceAttribute.js\";\nimport GeometryInstance from \"../Core/GeometryInstance.js\";\nimport Iso8601 from \"../Core/Iso8601.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport Matrix3 from \"../Core/Matrix3.js\";\nimport Matrix4 from \"../Core/Matrix4.js\";\nimport PlaneGeometry from \"../Core/PlaneGeometry.js\";\nimport PlaneOutlineGeometry from \"../Core/PlaneOutlineGeometry.js\";\nimport Quaternion from \"../Core/Quaternion.js\";\nimport ShowGeometryInstanceAttribute from \"../Core/ShowGeometryInstanceAttribute.js\";\nimport MaterialAppearance from \"../Scene/MaterialAppearance.js\";\nimport PerInstanceColorAppearance from \"../Scene/PerInstanceColorAppearance.js\";\nimport ColorMaterialProperty from \"./ColorMaterialProperty.js\";\nimport DynamicGeometryUpdater from \"./DynamicGeometryUpdater.js\";\nimport GeometryUpdater from \"./GeometryUpdater.js\";\nimport Property from \"./Property.js\";\n\nvar positionScratch = new Cartesian3();\nvar scratchColor = new Color();\n\nfunction PlaneGeometryOptions(entity) {\n  this.id = entity;\n  this.vertexFormat = undefined;\n  this.plane = undefined;\n  this.dimensions = undefined;\n}\n\n/**\n * A {@link GeometryUpdater} for planes.\n * Clients do not normally create this class directly, but instead rely on {@link DataSourceDisplay}.\n * @alias PlaneGeometryUpdater\n * @constructor\n *\n * @param {Entity} entity The entity containing the geometry to be visualized.\n * @param {Scene} scene The scene where visualization is taking place.\n */\nfunction PlaneGeometryUpdater(entity, scene) {\n  GeometryUpdater.call(this, {\n    entity: entity,\n    scene: scene,\n    geometryOptions: new PlaneGeometryOptions(entity),\n    geometryPropertyName: \"plane\",\n    observedPropertyNames: [\"availability\", \"position\", \"orientation\", \"plane\"],\n  });\n\n  this._onEntityPropertyChanged(entity, \"plane\", entity.plane, undefined);\n}\n\nif (defined(Object.create)) {\n  PlaneGeometryUpdater.prototype = Object.create(GeometryUpdater.prototype);\n  PlaneGeometryUpdater.prototype.constructor = PlaneGeometryUpdater;\n}\n\n/**\n * Creates the geometry instance which represents the fill of the geometry.\n *\n * @param {JulianDate} time The time to use when retrieving initial attribute values.\n * @returns {GeometryInstance} The geometry instance representing the filled portion of the geometry.\n *\n * @exception {DeveloperError} This instance does not represent a filled geometry.\n */\nPlaneGeometryUpdater.prototype.createFillGeometryInstance = function (time) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"time\", time);\n\n  if (!this._fillEnabled) {\n    throw new DeveloperError(\n      \"This instance does not represent a filled geometry.\"\n    );\n  }\n  //>>includeEnd('debug');\n\n  var entity = this._entity;\n  var isAvailable = entity.isAvailable(time);\n\n  var attributes;\n\n  var color;\n  var show = new ShowGeometryInstanceAttribute(\n    isAvailable &&\n      entity.isShowing &&\n      this._showProperty.getValue(time) &&\n      this._fillProperty.getValue(time)\n  );\n  var distanceDisplayCondition = this._distanceDisplayConditionProperty.getValue(\n    time\n  );\n  var distanceDisplayConditionAttribute = DistanceDisplayConditionGeometryInstanceAttribute.fromDistanceDisplayCondition(\n    distanceDisplayCondition\n  );\n  if (this._materialProperty instanceof ColorMaterialProperty) {\n    var currentColor;\n    if (\n      defined(this._materialProperty.color) &&\n      (this._materialProperty.color.isConstant || isAvailable)\n    ) {\n      currentColor = this._materialProperty.color.getValue(time, scratchColor);\n    }\n    if (!defined(currentColor)) {\n      currentColor = Color.WHITE;\n    }\n    color = ColorGeometryInstanceAttribute.fromColor(currentColor);\n    attributes = {\n      show: show,\n      distanceDisplayCondition: distanceDisplayConditionAttribute,\n      color: color,\n    };\n  } else {\n    attributes = {\n      show: show,\n      distanceDisplayCondition: distanceDisplayConditionAttribute,\n    };\n  }\n\n  var planeGraphics = entity.plane;\n  var options = this._options;\n  var modelMatrix = entity.computeModelMatrix(time);\n  var plane = Property.getValueOrDefault(\n    planeGraphics.plane,\n    time,\n    options.plane\n  );\n  var dimensions = Property.getValueOrUndefined(\n    planeGraphics.dimensions,\n    time,\n    options.dimensions\n  );\n\n  options.plane = plane;\n  options.dimensions = dimensions;\n\n  modelMatrix = createPrimitiveMatrix(\n    plane,\n    dimensions,\n    modelMatrix,\n    this._scene.mapProjection.ellipsoid,\n    modelMatrix\n  );\n\n  return new GeometryInstance({\n    id: entity,\n    geometry: new PlaneGeometry(this._options),\n    modelMatrix: modelMatrix,\n    attributes: attributes,\n  });\n};\n\n/**\n * Creates the geometry instance which represents the outline of the geometry.\n *\n * @param {JulianDate} time The time to use when retrieving initial attribute values.\n * @returns {GeometryInstance} The geometry instance representing the outline portion of the geometry.\n *\n * @exception {DeveloperError} This instance does not represent an outlined geometry.\n */\nPlaneGeometryUpdater.prototype.createOutlineGeometryInstance = function (time) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"time\", time);\n\n  if (!this._outlineEnabled) {\n    throw new DeveloperError(\n      \"This instance does not represent an outlined geometry.\"\n    );\n  }\n  //>>includeEnd('debug');\n\n  var entity = this._entity;\n  var isAvailable = entity.isAvailable(time);\n  var outlineColor = Property.getValueOrDefault(\n    this._outlineColorProperty,\n    time,\n    Color.BLACK,\n    scratchColor\n  );\n  var distanceDisplayCondition = this._distanceDisplayConditionProperty.getValue(\n    time\n  );\n\n  var planeGraphics = entity.plane;\n  var options = this._options;\n  var modelMatrix = entity.computeModelMatrix(time);\n  var plane = Property.getValueOrDefault(\n    planeGraphics.plane,\n    time,\n    options.plane\n  );\n  var dimensions = Property.getValueOrUndefined(\n    planeGraphics.dimensions,\n    time,\n    options.dimensions\n  );\n\n  options.plane = plane;\n  options.dimensions = dimensions;\n\n  modelMatrix = createPrimitiveMatrix(\n    plane,\n    dimensions,\n    modelMatrix,\n    this._scene.mapProjection.ellipsoid,\n    modelMatrix\n  );\n\n  return new GeometryInstance({\n    id: entity,\n    geometry: new PlaneOutlineGeometry(),\n    modelMatrix: modelMatrix,\n    attributes: {\n      show: new ShowGeometryInstanceAttribute(\n        isAvailable &&\n          entity.isShowing &&\n          this._showProperty.getValue(time) &&\n          this._showOutlineProperty.getValue(time)\n      ),\n      color: ColorGeometryInstanceAttribute.fromColor(outlineColor),\n      distanceDisplayCondition: DistanceDisplayConditionGeometryInstanceAttribute.fromDistanceDisplayCondition(\n        distanceDisplayCondition\n      ),\n    },\n  });\n};\n\nPlaneGeometryUpdater.prototype._isHidden = function (entity, plane) {\n  return (\n    !defined(plane.plane) ||\n    !defined(plane.dimensions) ||\n    !defined(entity.position) ||\n    GeometryUpdater.prototype._isHidden.call(this, entity, plane)\n  );\n};\n\nPlaneGeometryUpdater.prototype._getIsClosed = function (options) {\n  return false;\n};\n\nPlaneGeometryUpdater.prototype._isDynamic = function (entity, plane) {\n  return (\n    !entity.position.isConstant || //\n    !Property.isConstant(entity.orientation) || //\n    !plane.plane.isConstant || //\n    !plane.dimensions.isConstant || //\n    !Property.isConstant(plane.outlineWidth)\n  );\n};\n\nPlaneGeometryUpdater.prototype._setStaticOptions = function (entity, plane) {\n  var isColorMaterial = this._materialProperty instanceof ColorMaterialProperty;\n\n  var options = this._options;\n  options.vertexFormat = isColorMaterial\n    ? PerInstanceColorAppearance.VERTEX_FORMAT\n    : MaterialAppearance.MaterialSupport.TEXTURED.vertexFormat;\n  options.plane = plane.plane.getValue(Iso8601.MINIMUM_VALUE, options.plane);\n  options.dimensions = plane.dimensions.getValue(\n    Iso8601.MINIMUM_VALUE,\n    options.dimensions\n  );\n};\n\nPlaneGeometryUpdater.DynamicGeometryUpdater = DynamicPlaneGeometryUpdater;\n\n/**\n * @private\n */\nfunction DynamicPlaneGeometryUpdater(\n  geometryUpdater,\n  primitives,\n  groundPrimitives\n) {\n  DynamicGeometryUpdater.call(\n    this,\n    geometryUpdater,\n    primitives,\n    groundPrimitives\n  );\n}\n\nif (defined(Object.create)) {\n  DynamicPlaneGeometryUpdater.prototype = Object.create(\n    DynamicGeometryUpdater.prototype\n  );\n  DynamicPlaneGeometryUpdater.prototype.constructor = DynamicPlaneGeometryUpdater;\n}\n\nDynamicPlaneGeometryUpdater.prototype._isHidden = function (\n  entity,\n  plane,\n  time\n) {\n  var options = this._options;\n  var position = Property.getValueOrUndefined(\n    entity.position,\n    time,\n    positionScratch\n  );\n  return (\n    !defined(position) ||\n    !defined(options.plane) ||\n    !defined(options.dimensions) ||\n    DynamicGeometryUpdater.prototype._isHidden.call(this, entity, plane, time)\n  );\n};\n\nDynamicPlaneGeometryUpdater.prototype._setOptions = function (\n  entity,\n  plane,\n  time\n) {\n  var options = this._options;\n  options.plane = Property.getValueOrDefault(plane.plane, time, options.plane);\n  options.dimensions = Property.getValueOrUndefined(\n    plane.dimensions,\n    time,\n    options.dimensions\n  );\n};\n\nvar scratchAxis = new Cartesian3();\nvar scratchAxis2 = new Cartesian3();\nvar scratchTranslation = new Cartesian3();\nvar scratchNormal = new Cartesian3();\nvar scratchScale = new Cartesian3();\nvar scratchQuaternion = new Quaternion();\nvar scratchMatrix3 = new Matrix3();\nfunction createPrimitiveMatrix(\n  plane,\n  dimensions,\n  transform,\n  ellipsoid,\n  result\n) {\n  var normal = plane.normal;\n  var distance = plane.distance;\n\n  var translation = Cartesian3.multiplyByScalar(\n    normal,\n    -distance,\n    scratchTranslation\n  );\n  translation = Matrix4.multiplyByPoint(transform, translation, translation);\n\n  var transformedNormal = Matrix4.multiplyByPointAsVector(\n    transform,\n    normal,\n    scratchNormal\n  );\n  Cartesian3.normalize(transformedNormal, transformedNormal);\n\n  var up = ellipsoid.geodeticSurfaceNormal(translation, scratchAxis2);\n  if (\n    CesiumMath.equalsEpsilon(\n      Math.abs(Cartesian3.dot(up, transformedNormal)),\n      1.0,\n      CesiumMath.EPSILON8\n    )\n  ) {\n    up = Cartesian3.clone(Cartesian3.UNIT_Z, up);\n    if (\n      CesiumMath.equalsEpsilon(\n        Math.abs(Cartesian3.dot(up, transformedNormal)),\n        1.0,\n        CesiumMath.EPSILON8\n      )\n    ) {\n      up = Cartesian3.clone(Cartesian3.UNIT_X, up);\n    }\n  }\n\n  var left = Cartesian3.cross(up, transformedNormal, scratchAxis);\n  up = Cartesian3.cross(transformedNormal, left, up);\n  Cartesian3.normalize(left, left);\n  Cartesian3.normalize(up, up);\n\n  var rotationMatrix = scratchMatrix3;\n  Matrix3.setColumn(rotationMatrix, 0, left, rotationMatrix);\n  Matrix3.setColumn(rotationMatrix, 1, up, rotationMatrix);\n  Matrix3.setColumn(rotationMatrix, 2, transformedNormal, rotationMatrix);\n  var rotation = Quaternion.fromRotationMatrix(\n    rotationMatrix,\n    scratchQuaternion\n  );\n\n  var scale = Cartesian2.clone(dimensions, scratchScale);\n  scale.z = 1.0;\n\n  return Matrix4.fromTranslationQuaternionRotationScale(\n    translation,\n    rotation,\n    scale,\n    result\n  );\n}\n\n/**\n * @private\n */\nPlaneGeometryUpdater.createPrimitiveMatrix = createPrimitiveMatrix;\nexport default PlaneGeometryUpdater;\n"]},"metadata":{},"sourceType":"module"}